'IF NOT COMMAND$="MARGO" THEN COLOR 3:PRINT "FICHIER programme pour THOLL ":COLOR 12:PRINT "THOLL ecrit par S‰RG‰ TSAKI.":END
ON ERROR GOTO 60000
D10:
CLS:C=1:H=300:V=150:C=0:ENR=0:MP=1:DIM W%(40,40),TA%(70,70),BR%(20,20)
DIM X1%(1000),Y1%(1000),X2%(1000),Y2%(1000),C%(1000),E%(1000),D%(1000)
DEFINT  A-Z
SCREEN 2:MP=1
LINE (0,0)-(639,171),3,BF
LINE (10,20)-(629,168),0,BF
LINE (13,22)-(627,166),3,B
LOCATE 3,68:PRINT "TSAKI SERGE"
A=-4:FOR I=1 TO 324:A=A+2:LINE (A,0)-(A,171),0:NEXT I
LOCATE 23,3:PRINT "  Fichier    Ligne    Cercle     Axe
GET (3,176)-(637,183),W%
PUT (3,1),W%,PRESET
LOCATE 23,2:PRINT "THOLL draw Technologie"
GET (3,176)-(183,183),W%
PUT (225,18),W%,PRESET
LOCATE 23,2:PRINT " <Esc> Menu        Utilisation de la sourie conseillez    "
GET (3,176)-(636,183),W%
PUT (3,176),W%,PRESET:H=300:V=100
LINE (0,174)-(639,185),1,B:A=1
LINE (100,50)-(510,100),1,B
LINE (103,53)-(507,097),1,B
LOCATE 8,20:PRINT "Aucun nom de fichier n'est en memoire "
LOCATE 9,20:PRINT "Tapez le nom du nouveau fichier "
LOCATE 11,26:PRINT "Nom -> "
LOCATE 11,33:INPUT "",NM$:IF NM$="" THEN NM$="DESSIN.THW"
LINE (100,50)-(510,100),0,BF
LINE (22,160)-(22,100),3
LINE (22,160)-(110,160),3
LINE (110,160)-(100,158),3
LINE (110,160)-(100,162),3
LINE (22,100)-(19,104),3
LINE (22,100)-(25,104),3
LOCATE 15,4:PRINT "Y"
LOCATE 20,12:PRINT "X"
CLOSE
300 OPEN NM$ FOR INPUT AS #1
FOR I=1 TO 1000:ZC=I
310 INPUT #1,X1(I),Y1(I),X2(I),Y2(I),C(I),D,E(I)

IF E(I)=1 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I)
IF E(I)=2 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),,600
IF E(I)=3 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),B
IF E(I)=4 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),BF
IF E(I)=8 THEN CIRCLE (X1(I),Y1(I)),X2(I),C(I)
NEXT I
GOTO 320
320 CLOSE:OPEN NM$ FOR OUTPUT AS #1
330 MP=1

IPUT1:

GET (H,V)-(H+8,V+8),w%
LINE (H,V)-(H+8,V+8),C:LINE (H,V+4)-(H+8,V+4),C:LINE (H,V+4)-(H,V),1:LINE (H,V)-(H+8,V+4),1
LINE (H,V)-(H+8,V+8),0,BF:
PUT (H,V),w%
LOCATE 1,60:PRINT " X >";H-10;:LOCATE 1,70:PRINT " Y >";V-25

D100:

IF MP=3 THEN LINE (H1,V1)-(H,V),C,B

	X$=INKEY$:IF X$="" THEN IPUT1

IF H1=0 AND V1=0 THEN V1=V:H1=H
IF MP=3 THEN LINE (H1,V1)-(H,V),0,B
MPTP3=MPTP3+1:IF MPTP3=15 AND MP=3 THEN MPTP3=0:GOTO 500
IF X$=CHR$(0)+CHR$(80) AND MP=3 THEN LINE (H1,V1)-(H,V),C,B:LINE (H1,V1)-(H,V),0,B:V=V+1:IF V>180 THEN V=170
IF X$=CHR$(0)+CHR$(72) AND MP=3 THEN LINE (H1,V1)-(H,V),C,B:LINE (H1,V1)-(H,V),0,B:V=V-1:IF V<25 THEN V=25
IF X$=CHR$(0)+CHR$(77) AND MP=3 THEN LINE (H1,V1)-(H,V),C,B:LINE (H1,V1)-(H,V),0,B:H=H+1:IF H>620 THEN H=610
IF X$=CHR$(0)+CHR$(75) AND MP=3 THEN LINE (H1,V1)-(H,V),C,B:LINE (H1,V1)-(H,V),0,B:H=H-1:IF H<10 THEN H=10
IF X$=CHR$(0)+CHR$(80) AND NOT MP=3 THEN V=V+1:IF V>180 THEN V=170
IF X$=CHR$(0)+CHR$(72) AND NOT MP=3 THEN V=V-1:IF V<25 THEN V=25
IF X$=CHR$(0)+CHR$(77) AND NOT MP=3 THEN H=H+1:IF H>620 THEN H=610
IF X$=CHR$(0)+CHR$(75) AND NOT MP=3 THEN H=H-1:IF H<10 THEN H=10
IF X$=CHR$(0)+CHR$(16) THEN END

IF X$="5" THEN 500
IF X$=CHR$(27) THEN D1000
IF X$=CHR$(32) AND C=3 THEN C=0:GOTO IPUT1
IF X$=CHR$(32) AND C=0 THEN C=3:GOTO IPUT1
IF X$=CHR$(13) AND ENR=0 THEN H1=H:V1=V:LINE (H,V)-(H,V),C:ENR=1:ZC=ZC+1:GOTO D100
IF X$=CHR$(13) AND ENR=1 AND MP=1 THEN LINE (H1,V1)-(H,V),C:ENR=0:X1(ZC)=H1:Y1(ZC)=V1:X2(ZC)=H:Y2(ZC)=V:C(ZC)=C:E(ZC)=MP
IF X$=CHR$(13) AND ENR=1 AND MP=2 THEN LINE (H1,V1)-(H,V),C,,600:ENR=0:X1(ZC)=H1:Y1(ZC)=V1:X2(ZC)=H:Y2(ZC)=V:C(ZC)=C:E(ZC)=MP
IF X$=CHR$(13) AND ENR=1 AND MP=3 THEN LINE (H1,V1)-(H,V),C,B:ENR=0:X1(ZC)=H1:Y1(ZC)=V1:X2(ZC)=H:Y2(ZC)=V:C(ZC)=C:E(ZC)=MP
IF X$=CHR$(13) AND ENR=1 AND MP=4 THEN LINE (H1,V1)-(H,V),C,BF:ENR=0:X1(ZC)=H1:Y1(ZC)=V1:X2(ZC)=H:Y2(ZC)=V:C(ZC)=C:E(ZC)=MP
'F X$=CHR$(13) THEN PRINT #1,X1(I),Y1(I),X2(I),Y2(I),C(I),D,E(I),MP
GOTO D100

500 SOUND 400,1
LINE (14,26)-(626,165),0,BF
LINE (22,160)-(22,100),3
LINE (22,160)-(110,160),3
LINE (110,160)-(100,158),3
LINE (110,160)-(100,162),3
LINE (22,100)-(19,104),3
LINE (22,100)-(25,104),3
LOCATE 15,4:PRINT "Y"
LOCATE 20,12:PRINT "X"

'GET (500,40)-(600,160),TA%:LINE (500,40)-(600,160),0,BF:LINE (500,40)-(600,160),1,B

FOR I=1 TO ZC
IF AX$="C" THEN GET (400,36)-(600,100),TA%:LINE (400,36)-(600,100),0,BF:LINE (400,36)-(600,100),1,B
IF AX$="C" THEN LOCATE 6,55:PRINT "Point":LOCATE 7,55:PRINT "Code Dessin ";E(I)
IF AX$="C" THEN LOCATE 9,53:PRINT "X1(";I;")=";X1(I):LOCATE 10,53:PRINT "Y1(";I;")=";Y1(I)
IF AX$="C" AND NOT E(I)=8 THEN LOCATE 11,53:PRINT "X2(";I;")=";X2(I):LOCATE 12,53:PRINT "Y2(";I;")=";Y2(I):DELAY 0.01
IF AX$="C" AND E(I)=8 THEN LOCATE 11,53:PRINT "Dia ";X2(I):LOCATE 12,53:PRINT "          ":DELAY 0.01
IF AX$="C" THEN LINE (400,36)-(600,100),0,BF:PUT (400,36),TA%

IF AX$="S" AND E(I)=8 THEN LINE (X1(I)+X2(I)+45,Y1(I))-(X1(I)-X2(I)-45,Y1(I)),3,,600: LINE (X1(I),Y1(I)+X2(I)+15)-(X1(I),Y1(I)-X2(I)-15),1,,600
IF AX$="F" THEN LINE (X1(I)+45,Y1(I))-(X1(I)-45,Y1(I)),3,,600: LINE (X1(I),Y1(I)+15)-(X1(I),Y1(I)-15),1,,600
IF E(I)=1 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I)
IF E(I)=2 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),,600
IF E(I)=3 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),B
IF E(I)=4 THEN LINE (X1(I),Y1(I))-(X2(I),Y2(I)),C(I),BF
IF E(I)=8 THEN CIRCLE (X1(I),Y1(I)),X2(I),C(I)
NEXT I

GOTO IPUT1

D1000:
GET (20,12)-(170,36),TA%:JK=0
LINE (20,12)-(170,36),0,BF:JK=0
LINE (20,12)-(170,36),1,B
K$(1)=" Fermer dessin"
K$(2)=" Quitter         "
D1050:
LINE (20,12)-(170,36),0,BF
LINE (20,12)-(170,36),1,B
FOR I=1 TO 2:LOCATE 2+I,4:PRINT K$(I):NEXT I
GET (23,16+JK)-(167,16+JK+7),BR%
PUT (23,16+JK),BR%,PRESET
D1100:
X$=INKEY$:IF X$="" THEN D1100
IF X$=CHR$(0)+"P" THEN JK=JK+8:IF JK>8 THEN JK=0
IF X$=CHR$(0)+"H" THEN JK=JK-8:IF JK<0 THEN JK=8
IF X$=CHR$(27) THEN LINE (20,12)-(170,36),0,BF:PUT (20,12),TA%:GOTO IPUT1
IF X$="6" OR X$=CHR$(0)+"M" THEN LINE (20,12)-(170,36),0,BF:PUT (20,12),TA%:GOTO D2000
IF NOT X$=CHR$(13) THEN D1050
IF JK=0 THEN FOR I=1 TO ZC:PRINT #1,X1(I),Y1(I),X2(I),Y2(I),C(I),D,E(I):NEXT I:ZC=0:CLOSE:RUN
IF JK=8 THEN FOR I=1 TO ZC:PRINT #1,X1(I),Y1(I),X2(I),Y2(I),C(I),D,E(I):NEXT I:ZC=0:CLOSE:END
GOTO D1050
D2000:
GET (120,12)-(220,52),TA%:JK=0
K$(1)="simple "
K$(2)="pointiller "
K$(3)="cadre vide "
K$(4)="cadre plein"
D2050:
LINE (120,12)-(220,52),0,BF
LINE (120,12)-(220,52),1,B
FOR I=1 TO 4:LOCATE 2+I,17:PRINT K$(I):NEXT I
GET (123,16+JK)-(217,16+JK+7),BR%
PUT (123,16+JK),BR%,PRESET
D2100:
X$=INKEY$:IF X$="" THEN D2100
IF X$=CHR$(0)+"P" THEN JK=JK+8:IF JK>(8*3) THEN JK=0
IF X$=CHR$(0)+"H" THEN JK=JK-8:IF JK<0 THEN JK=8*3
IF X$="4" OR X$=CHR$(0)+"K" THEN LINE (120,12)-(220,52),0,BF:PUT (120,12),TA%:GOTO D1000
IF X$="6" OR X$=CHR$(0)+"M" THEN LINE (120,12)-(220,52),0,BF:PUT (120,12),TA%:GOTO D3000
IF X$=CHR$(27) THEN LINE (120,12)-(220,52),0,BF:PUT (120,12),TA%:GOTO IPUT1
IF NOT X$=CHR$(13) THEN D2050
IF JK=0 THEN MP=1
IF JK=8 THEN MP=2
IF JK=16 THEN MP=3
IF JK=24 THEN MP=4
LINE (120,12)-(220,52),0,BF:PUT (120,12),TA%
GOTO 500

D3000:
GET (170,12)-(320,36),TA%:JK=0
K$(1)=" Cercle          "
K$(2)=" Elipse          "
D3050:
LINE (170,12)-(320,36),0,BF
LINE (170,12)-(320,36),1,B
FOR I=1 TO 2:LOCATE 2+I,23:PRINT K$(I):NEXT I
GET (172,16+JK)-(318,16+JK+7),BR%
PUT (172,16+JK),BR%,PRESET
D3100:
X$=INKEY$:IF X$="" THEN D3100
IF X$=CHR$(0)+"P" THEN JK=JK+8:IF JK>8 THEN JK=0
IF X$=CHR$(0)+"H" THEN JK=JK-8:IF JK<0 THEN JK=8
IF X$="4" OR X$=CHR$(0)+"K" THEN LINE (170,12)-(320,36),0,BF:PUT (170,12),TA%:GOTO D2000
IF X$="6" OR X$=CHR$(0)+"M" THEN LINE (170,12)-(320,36),0,BF:PUT (170,12),TA%:GOTO D4000
IF X$=CHR$(27) THEN LINE (170,12)-(320,36),0,BF:PUT (170,12),TA%:GOTO IPUT1
IF NOT X$=CHR$(13) THEN D3050

LINE (170,12)-(320,36),0,BF:PUT (170,12),TA%
IF JK=0 THEN 1000
IF JK=8 THEN 1100
END
D4000:
GET (240,12)-(410,52),TA%:JK=0
K$(1)=" Axe pour Cercle   "
K$(2)=" Axe total dessin  "
K$(3)=" Efface les Axes   "
K$(4)=" Coordonne Points  "
D4050:
LINE (240,12)-(410,52),0,BF
LINE (240,12)-(410,52),1,B
FOR I=1 TO 4:LOCATE 2+I,32:PRINT K$(I):NEXT I
K=24
GET (242,16+JK)-(408,16+JK+7),BR%
PUT (242,16+JK),BR%,PRESET
D4100:
X$=INKEY$:IF X$="" THEN D4100
IF X$=CHR$(0)+"P" THEN JK=JK+8:IF JK>24 THEN JK=0
IF X$=CHR$(0)+"H" THEN JK=JK-8:IF JK<0 THEN JK=24
IF X$="4" OR X$=CHR$(0)+"K" THEN LINE (240,12)-(410,52),0,BF:PUT (240,12),TA%:GOTO D3000
IF X$=CHR$(27) THEN LINE (240,12)-(410,52),0,BF:PUT (240,12),TA%:GOTO IPUT1
IF NOT X$=CHR$(13) THEN D4050
LINE (240,12)-(410,52),0,BF:PUT (240,12),TA%
IF JK=0 THEN AX$="S":GOTO 500
IF JK=8 THEN AX$="F":GOTO 500
IF JK=16 THEN AX$="":GOTO 500
IF JK=24 THEN AX$="C":GOTO 500
END

1000 GET (H-D-1,V-D-1+(D/2))-(H+D+1,V+D+1-(D/2)),TA%
CIRCLE (H,V),D,C
LINE (H-D,V)-(H+D,V),1,,800
LINE (H,V-D-1+(D/2))-(H,V+D+1-(D/2)),1,,800
CIRCLE (H,V),D,C
1002 X$=INKEY$:IF X$="" THEN 1002
LINE (H-D-1,V-D-1+(D/2))-(H+D+1,V+D+1-(D/2)),0,BF
PUT (H-D-1,V-D-1+(D/2)),TA%
IF X$="+" OR X$=CHR$(0)+"K" THEN D=D+1:IF D>50 THEN D=50
IF X$="-" OR X$=CHR$(0)+"M" THEN D=D-1:IF D<1 THEN D=1
IF X$=CHR$(27) THEN IPUT1
IF X$=CHR$(13) THEN ZC=ZC+1:E(ZC)=8:X1(ZC)=H:Y1(ZC)=V:X2(ZC)=D:C(ZC)=C:CIRCLE (H,V),D,C:GOTO 1000
GOTO 1000
END
1100
END
60000 IF ERL=300 THEN CLOSE :RESUME 320
IF ERL=310 THEN CLOSE:RESUME 320
IF ERL=330 THEN CLOSE:END