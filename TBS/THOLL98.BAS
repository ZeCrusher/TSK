$STACK 32000
$DYNAMIC
ON ERROR GOTO 60000
OPTION BASE 0
RZ$=CHR$(0):E13$=CHR$(13):E27$=CHR$(27):PG=0
DIM VXX$(30)
FOR I=1 TO 2:FOR U=1 TO 8:VXX$(I)=VXX$(I)+CHR$(SCREEN(I,U)):NEXT U:NEXT I
OM0=0:OM8=8:PG=1
IF DDBK=0 THEN DDBK=1
IF FDBK=0 THEN FDBK=1
2 SCEN=0:REPA=0:STG$=STRING$(80,254):S=&HB800:S=S+65535:DEF SEG=S
DEFINT B,C,D,E,F,G,H,J,I,L,P,Q,R,S,T,U,V,Y,Z
CLT=0:ED1=219:ED0=223:ED2=219:ED6=221:ED7=222:ED4=219:ED3=219:ED10=220:IC18=8:IC2=222:IC78=8:IC220=220:IC223=223:IC221=221:IC38=8:IC98=8
K800=1000:RFT=1
KEY 1,"ECHO ":KEY 2,"GOTO ":KEY 3,"FOR ":KEY 4,"IF ":KEY 5,"PAUSE ":KEY 6,"REM ":KEY 7,"SHIFT ":KEY 8,CHR$(34)+"%1"+CHR$(34):KEY 9,"CLS ":KEY 10,"EXIST "
DIM K$(20):E27$=CHR$(27):RZ$=CHR$(0):E13$=CHR$(13):PG=0
C$=COMMAND$
IF C$="/M" OR C$="/m" OR C$="MEM" OR C$="mem" OR  C$="/MEM" OR  C$="/mem" THEN COLOR 14,1:PRINT "T-S THOLL":COLOR 3,0:PRINT " Memoire Restante ";:COLOR 12:PRINT USING " ######.## Ko ";(FRE(-1)/1024):SHELL:C$=""
IF C$="/V" OR C$="/v" OR C$="/virus" OR C$="/VIRUS" THEN 400
5 IF NOT C$="" THEN GOSUB 40:GOTO 40000
10 IF K800<40 THEN K800=40
DIM CLR(35)
20 WIDTH 80:COLOR A7,A0
CLS:SCREEN SCEN
30 GOSUB 35
GOTO 45
35 CLOSE:OPEN "COULEUR.THL" FOR INPUT AS #1:LINE INPUT #1,X$:GOSUB 4113:FOR I=0 TO 31:INPUT #1,CLR(I):NEXT I:INPUT #1,OM0:INPUT #1,OM8:GOSUB 36:RETURN
36 A0=CLR(0):A1=CLR(1):A2=CLR(2):A3=CLR(3):A4=CLR(4):A5=CLR(5):A6=CLR(6):A7=CLR(7):A8=CLR(8):A9=CLR(9):A10=CLR(10):A11=CLR(11):A12=CLR(12):A13=CLR(13):A14=CLR(14):A15=CLR(15):A16=CLR(16):A17=CLR(17)
A18=CLR(18):A19=CLR(19):A20=CLR(20):A21=CLR(21):A22=CLR(22):A23=CLR(23):A24=CLR(24):A25=CLR(25):A26=CLR(26):A27=CLR(27):A28=CLR(28):A29=CLR(29):A30=CLR(30):A31=CLR(31)
CLOSE
RETURN
END
$SEGMENT
40 A0=0:A1=1:A2=2:A3=3:A4=4:A5=5:A6=6:A7=7:A8=8:A9=9:A10=10:A11=11:A12=12:A13=13:A14=14:A15=15:A16=16:A17=17:A18=18:A19=19:A20=20:A21=21:A22=22
A23=23:A24=24:A25=25:A26=26:A27=27:A28=28:A29=29:A30=30:A31=31:CLT=0:RETURN
45 CLOSE:OPEN "THCONFIG." FOR INPUT AS #2:INPUT #2,XX:INPUT #2,YY:INPUT #2,CLT
50 color 7,A0:CLS:CLOSE
51 WIDTH 80:SCREEN SCEN:GOTO 300
300 COLOR XX,0:LOCATE 1,1:FOR I=1 TO 24:PRINT STRING$(80,177);:NEXT I
IF XX=0 THEN XX=3
305 COLOR A8,XX:LOCATE 2,2:PRINT CHR$(219)+STRING$(76,"ß")+CHR$(219)
307 FOR I=1 TO 17:LOCATE 2+I,2:PRINT CHR$(221)+SPACE$(76)+CHR$(222):NEXT I
308 LOCATE 19,2:PRINT CHR$(219)+STRING$(76,220)+CHR$(219)
310 COLOR A1,3:LOCATE 6,6:PRINT SPACE$(11):LOCATE 5,5:PRINT STRING$(27,219):LOCATE 6,22:PRINT SPACE$(11)
312 FOR I=1 TO 9:LOCATE 5+I,16:PRINT STRING$(6,219);:PRINT " ":NEXT I
LOCATE 15,17:PRINT "      "
314 COLOR YY,3:FOR I=1 TO 8:LOCATE 4+I,32:PRINT "Û";:LOCATE 5+I,33:PRINT " ":NEXT I
LOCATE 9,32:PRINT STRING$(6,219)
FOR I=1 TO 9:LOCATE 4+I,38:PRINT "Û";:LOCATE 5+I,39:PRINT " ":NEXT I:LOCATE 10,33:PRINT "     "
FOR I=1 TO 7:LOCATE 4+I,42:PRINT "Û";:LOCATE 5+I,43:PRINT " ":NEXT I:LOCATE 5,42:PRINT STRING$(7,219):LOCATE 6,43:PRINT "      "
FOR I=1 TO 7:LOCATE 4+I,49:PRINT "Û";:LOCATE 5+I,50:PRINT " ":NEXT I:LOCATE 11,42:PRINT STRING$(7,219):LOCATE 12,43:PRINT "       "
FOR I=1 TO 8:LOCATE 4+I,54:PRINT "Û";:LOCATE 5+I,55:PRINT " ":NEXT I:LOCATE 11,54:PRINT STRING$(7,219):LOCATE 12,55:PRINT "       "
FOR I=1 TO 9:LOCATE 4+I,63:PRINT "Û";:LOCATE 5+I,64:PRINT " ":NEXT I:LOCATE 13,63:PRINT STRING$(9,219):LOCATE 14,64:PRINT "         "
COLOR A0,YY:CD$=" TS     Programme  THOLL ver 1.00                            par TSAKI-SERGE [1991-1992]                Edition de Fichier Texte sequentiel BATCH                               TSAKI. SäRGä [ M-G ] "
B=LEN(CD$):Z=1:A=60
380 A=A+Z:IF A=B THEN Z=-1
IF A=60 THEN Z=1
X1$=LEFT$(CD$,A):X2$=RIGHT$(X1$,60):DELAY 0.05
COLOR A12,A0:LOCATE 23,10,0:PRINT "<";:COLOR A3:PRINT X2$;:COLOR A12:PRINT ">"
390 IF INKEY$="" THEN 380
GOTO 10000
400 $INCLUDE "INC.BAS"
GOTO 10
500 COLOR A16,A7:LOCATE 1,8:PRINT "Esc":SYST$="NON":IF KN=0 THEN KN=1

$INCLUDE "MENUKN01"

510 X$=INKEY$:IF X$="" THEN 510
X=0:A=0:Y=0
520 IF ASC(RIGHT$(X$,1))=75 OR X$="4" THEN KN=KN-1:IF KN=0 THEN KN=7
530 IF ASC(RIGHT$(X$,1))=77 OR X$="6" THEN KN=KN+1:IF KN=8 THEN KN=1
    IF X$="N" THEN KN=1:X$=E13$
    IF X$="F" THEN KN=2:X$=E13$
    IF X$="T" THEN KN=3:X$=E13$
    IF X$="O" THEN KN=4:X$=E13$
    IF X$="E" THEN KN=5:X$=E13$
    IF X$="I" THEN KN=6:X$=E13$
    IF X$="C" THEN KN=7:X$=E13$
531 LOCATE 1,12:GOSUB 10022
532 IF X$=E27$ THEN COLOR A10,A0:LOCATE 1,8,0:PRINT "Esc":GOTO 10120
540 COLOR A15,A4:IF X$=E13$ OR X$="2" OR X$=RZ$+"P" THEN COLOR A10,A0:LOCATE 1,8:PRINT "Esc":GOTO 610
IF KN=0 THEN KN=1
IF KN=1 THEN LOCATE 1,12:PRINT " Nom F. "
542 IF KN=2 THEN LOCATE 1,20:PRINT " Fichier "
543 IF KN=3 THEN LOCATE 1,29:PRINT " Texte "
544 IF KN=4 THEN LOCATE 1,36:PRINT " Options "
546 IF KN=5 THEN LOCATE 1,45:PRINT " Execut "
547 IF KN=6 THEN LOCATE 1,53:PRINT " Imprime "
548 IF KN=7 THEN LOCATE 1,62:PRINT " Copier "
600 GOTO 500
610 JK=1:IF KN=1 THEN 6100
612 IF KN=2 THEN 1000
613 IF KN=3 THEN 3000
614 IF KN=4 THEN 8200
615 IF KN=5 THEN 5000
616 IF KN=6 THEN 800
617 IF KN=7 THEN 6600
620 IF KN=0 THEN 10000
END
800 A=6:B=44:X1=30:X3=3:COLOR A8,A3:GOSUB 6000:JK=1
805 AI$="Imprime le texte du debut jusqu'au curseur":GOSUB 2100
810 '
820 K$(1)=" Imprime EntiŠrement Le Texte "
830 K$(2)=" Imprime une partie du texte  "
    K$(3)=" Imprime le block definie     "
883 COLOR CLT,A3:FOR I=1 TO 3:LOCATE 6+I,45:PRINT K$(I):NEXT I
885 COLOR A15,A4:LOCATE JK+6,45:PRINT K$(JK)
890 X$=INKEY$:IF X$="" THEN 890
900 IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=3
910 IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=4 THEN JK=1
IF X$="4" OR X$=RZ$+"K" THEN GOSUB 20011:KN=5:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN GOSUB 20011:KN=7:GOTO 610
920 IF X$=E27$ THEN 20010
922 IF X$=E13$ THEN 934
IF JK=1 THEN AI$="Imprime le texte du debut jusqu'au curseur":GOSUB 2100
IF JK=2 THEN AI$="Imprime la partie du texte difinie dans les deux fenetres d'imprime":GOSUB 2100
IF JK=3 THEN AI$="Imprime la partie definie dans le menu COPIER ":GOSUB 2100
930 GOTO 883
934 IF JK=1 THEN GOSUB 1120:COLOR A8,A7:A=13:B=40:X1=27:X3=1:GOSUB 6010:COLOR CLT,A7:FOR I=1 TO LIG:LOCATE 14,42:Print "Imprime Ligne ";I:LPRINT WK$(I,PG):NEXT I:GOSUB 49000:GOSUB 20011:GOTO 610
938 IF JK=2 THEN A=7:B=10:X1=22:X3=1:GOSUB 6010:GOTO JK2A
940 IF JK=2 THEN A=12:B=13:X1=22:X3=1:GOSUB 6010:GOTO JK2B
942 IF JK=2 THEN GOSUB 1120:FOR I=DEB TO FIN:LPRINT WK$(I,PG):NEXT I:LPRINT CHR$(7):GOSUB 49000:LPRINT CHR$(7):GOSUB 20011:GOTO 610
    IF JK=3 THEN GOSUB 1120:FOR I=DDBK TO FDBK:LPRINT (WK$(I,PG)):NEXT I:LPRINT CHR$(7):GOSUB 49000:GOSUB 20011:GOTO 610
END
JK2A:
VA$="Debut Ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 943 ELSE 20011:GOTO 610
943 DEB=VAL(N$):IF DEB>K800 OR DEB<0 THEN GOSUB 20011:GOTO 610
GOTO 940
JK2B:
VA$="Fin ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 944 ELSE 20011:GOTO 610
944 FIN=VAL(N$):IF FIN>K800 OR FIN<0 THEN GOSUB 20011:GOTO 610
GOTO 942
$SEGMENT
1000 A=4:B=5:X1=20:X3=11:GOSUB 6000:JK=1:A=2
AI$="Permet de sauvegarder votre travail sur le disque ":GOSUB 2100
1003 CLOSE
1008 K$(1)=" Enregistre         "
K$(2)=" Enregistre Sous ..."
K$(3)=" Apeller Fichier    "
K$(4)=" Fusionner Fichier  "
K$(5)=" Effacement fichier "
K$(6)=" Renommer Fichier   "
K$(7)=" Chargement rapide  "
K$(8)=" Utilitaire MS-DOS  "
K$(9)=" V‚rification virus "
K$(10)=" Utilitaire Fichier "
K$(11)=" Quitte THOLL       "
1020 COLOR CLT,A3:FOR I=0 TO 11:LOCATE 4+I,6,0:PRINT K$(I):NEXT I
1022 COLOR A15,A4:LOCATE 4+JK,6:PRINT K$(JK)
1025 X$=INKEY$:IF X$="" THEN 1025
1030 IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=11
1034 IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=12 THEN JK=1

$INCLUDE "MENUKN02"


if ASC(RIGHT$(X$,1))=80 OR ASC(RIGHT$(X$,1))=72 THEN 1020
IF X$="4" OR X$=RZ$+"K" THEN KN=1:GOSUB 20011:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN KN=3:GOSUB 20011:GOTO 610
1036 IF X$=E27$ THEN 20010
1040 IF X$=E13$ THEN 1055
1050 GOTO 1020
1055 RAPIDE$="":CLOSE
IF JK=1 THEN IF NOM$(PG)="" THEN 1100 ELSE GOSUB 1120:GOTO 1199
IF JK=2 THEN 1100
IF JK=3 THEN 1300
IF JK=4 THEN 1400
IF JK=5 THEN 1500
IF JK=6 THEN 1064
IF JK=11 THEN 8000
1057 IF JK=8 THEN COLOR A7,A0:CLS:COLOR A3,A0:PRINT "THOLL par SäRGä-TSAKI.":PRINT "Pour un retour … THOLL tapez ";:COLOR A12:PRINT "* EXIT *":PRINT:PRINT:COLOR A3:PRINT "Tapez sur une touche ...":GOSUB 49000:SHELL
IF JK=8 THEN COLOR A15,A4:LOCATE 1,1:PRINT SPACE$(80):LOCATE 1,1:PRINT " THOLL system DOS   [1990-1992]                              Par SERGE TSAKI. ":GOSUB 49000:GOTO 10001
IF JK=9 THEN 1066
IF JK=10 THEN DISK
IF JK=7 THEN RAPIDE$="OUI":GOTO 1300
END
1064 A=6:B=3:X1=65:X3=1:GOSUB 6010
VA$="Nom Fichier source >":GOSUB 2000
IF PASSE$="OUI" THEN B1064 ELSE 20011:GOTO 610
B1064:
S$=N$:IF S$="" THEN GOSUB 20011:GOTO 610
A=11:B=3:X1=65:X3=1:GOSUB 6010
VA$="Nouveau Nom object > ":GOSUB 2000
IF PASSE$="OUI" THEN B1065 ELSE 20011:GOTO 610
B1065:
O$=N$:IF O$="" THEN GOSUB 20011:GOTO 610
GOSUB 1120
1065 NAME S$ AS O$
GOSUB 20010:GOTO 610
1066 A=11:B=3:X1=65:X3=1:GOSUB 6010
VA$="Lecteur >":GOSUB 2000
IF PASSE$="OUI" THEN 1068 ELSE 20011:GOTO 610
1068 L$=N$:IF L$="" THEN GOSUB 20011:GOTO 610
GOSUB 1120:GOTO 400
1070 OPEN NOM$(PG) FOR INPUT AS #1
GOSUB 20011:A=10:B=35:X1=9:X3=2:GOSUB 6000:O=0:KO=0:OK=0:K=0
FOR I=1 TO K800
1072 LINE INPUT #1,WK$(I,PG):B=LEN(WK$(I,PG)):K=K+B:KO=K/1024:O=FRE(0):OK=O/1024
COLOR A0,A3:LOCATE 11,37:PRINT USING "##.# Ko";KO
IF O<4096 THEN COLOR 28,A3
IF O<1024 THEN 1073
LOCATE 12,37:PRINT USING "##.# Ko";OK
NEXT I
1073 CLOSE
GOTO 10001
1100 A=6:B=3:X1=65:X3=1:GOSUB 6010
1105 '
1107 '
1110 VA$="Sauver > ":GOSUB 2000
IF PASSE$="OUI" THEN 1112 ELSE 20011:GOTO 610
1112 NM$=N$:IF NM$="" THEN GOSUB 20011:GOTO 610
IF INSTR(NM$,".")=0 THEN NM$=NM$+".Bat"
NOM$(PG)=NM$
1115 GOSUB 1120:GOTO 1199
1120 '
1121 A=12:B=12:X1=20:X3=5:GOSUB 6000
LOCATE A+1,B+2:COLOR CLT:PRINT "Tapez <Entrer>   "
LOCATE A+2,B+2:PRINT "une Fois pres .."
1135 LOCATE A+4,B+1:PRINT "   Ou Tapez <Esc>  "
1140 '
1150 X$=INKEY$:IF X$="" THEN 1150
IF X$=E27$ AND AXXX$="OUI" THEN AXXX$="":GOTO 10001
IF X$=E27$ THEN AXXX$="":GOTO 20010
IF X$=E13$ THEN RETURN
GOTO 1121
1199 GOSUB 6530
1200 CLOSE:OPEN NOM$(PG) FOR OUTPUT AS #1
LOCATE 22,1:COLOR A7,A0:PRINT SPACE$(80):COLOR A8,A3
GOSUB 20011
A=14:B=3:X1=60:X3=2:GOSUB 6000:COLOR CLT,A3
K=0:FOR I=RFT TO LIG
1210 PRINT #1,WK$(I,PG):B=LEN(WK$(I,PG)):K=K+B:KO=K/1024:K=INT(K)
1211 LOCATE 15,4:PRINT "Caractere Ecrit -->";:COLOR A14:PRINT USING "#######";K
1212 COLOR CLT,A3:LOCATE 15,46:PRINT "Ligne ";I:LOCATE 16,10:PRINT USING "##.## Ko ecrit sur le disque ";KO
NEXT I
1220 CLOSE:GOTO 10001
1300 A=7:B=3:X1=65:X3=1:GOSUB 6000
1305 OBLIGER$="OUI"
1310 COLOR CTL,A3:LOCATE 8,5:PRINT "Chargement >";NOM$(PG)
1311 X$=INKEY$:IF X$="" THEN 1311
IF X$=E13$ THEN 1315

A=7:B=3:X1=65:X3=1:GOSUB 6010
VA$="Chargement >":GOSUB 2000
IF PASSE$="OUI" THEN 1314 ELSE GOSUB 20011:GOTO 610

1314 IF N$="" THEN GOSUB 20011:GOTO 610
IF INSTR(N$,".")=0 THEN N$=N$+".Bat"
NOM$(PG)=N$
1315 GOSUB 1120
1320 FOR I=1 TO K800:WK$(I,PG)="":NEXT I
IF RAPIDE$="OUI" THEN 1070
GOSUB 20011
1321 A=8:B=20:X1=50:X3=10:GOSUB 6000
LOCATE 9,22:COLOR CLT:PRINT "Nombre d'Octect(s)":E25=25:TOUR=0:TOUR2=0
LOCATE 10,22:PRINT "Nombre de Caractere(s) Totale ":N$=""
LOCATE 11,22:PRINT "Nombre de Ligne(s)            "
LOCATE 12,22:PRINT "Caractere(s) dans la ligne  "
LOCATE 13,22:PRINT "Memoire restante ":CLOSE
1330 CLOSE:COLOR CLT,A3:OPEN NOM$(PG) FOR INPUT AS #2:X=LOF(2)
LOCATE 9,60:PRINT X
1340 FOR I=1 TO K800
1345 LINE INPUT #2,WK$(I,PG)
BH=LEN(WK$(I,PG)):AA=BH+AA
LOCATE 10,60:PRINT AA
LOCATE 11,60:PRINT I
LOCATE 12,60:PRINT BH
LOCATE 13,60:PRINT FRE(0)
TOUR=TOUR+1:IF TOUR=E25 THEN N$=N$+"þ":LOCATE 14,22:PRINT "Matrice ";N$:TOUR=0:TOUR2=TOUR2+1:IF TOUR2=10 THEN E25=70
LOCATE 15,B+2:PRINT "Positionnement  ->";LOC(2)
LOCATE 16,B+2:PRINT "Nom > ";NOM$(PG):KO#=AA/1024
LOCATE 17,B+2:PRINT "Nombre de Ko "
LOCATE 17,57:PRINT USING "###.### Ko";KO#
LOCATE 18,B+2:PRINT "Memoire RAM restante en Ko
LOCATE 18,57:PRINT USING "####.## Ko ";(FRE(-1)/1024)
1350 NEXT I
1360 CLOSE:GOSUB 20011:GOTO 610
1400 A=7:B=3:X1=65:X3=1:GOSUB 6010:JK=1:COLOR CLT,A7
VA$="Fusion >":GOSUB 2000
IF PASSE$="OUI" THEN 1413 ELSE GOSUB 20011:GOTO 610
1413 KNOM$=N$
1414 IF KNOM$="" THEN GOSUB 20011:GOTO 610
IF INSTR(KNOM$,".")=0 THEN KNOM$=KNOM$+".Bat":
1415 GOSUB 1120:A=13:B=20:X3=6:X1=50:GOSUB 6000:COLOR CLT,A3
LOCATE 14,22:PRINT "Nombres d'Octect(s) dans Fusion":AI$="Charge et Analise ":GOSUB 2100
LOCATE 15,22:PRINT "Nombres de Caractere(s) Totale"
LOCATE 16,22:PRINT "Nombres de Ligne(s)           "
LOCATE 17,22:PRINT "Caractere(s) dans la ligne  "
LOCATE 18,22:PRINT "M‚moire r‚stante            ":I=0:A=0
LOCATE 19,22:PRINT "M‚moire RAM                 "
1430 CLOSE:COLOR CLT,A3:OPEN KNOM$ FOR INPUT AS #2:X=LOF(2)
LOCATE 14,60:PRINT X
1440 A=0:FOR I=LIG TO K800
1445 LINE INPUT #2,WK$(I,PG):BH=LEN(WK$(I,PG)):AA=BH+AA
LOCATE 15,60:PRINT AA:LOCATE 16,60:PRINT I:LOCATE 17,60:PRINT BH
COLOR A12,A3:LOCATE 18,60:PRINT FRE(0):LOCATE 19,60:PRINT FRE(-1)
COLOR CLT,A3:NEXT I
1460 GOSUB 20011:GOTO 610

1500 A=10:B=5:X1=65:X3=1:GOSUB 6010:COLOR CTL,A7
VA$="Effacement >":GOSUB 2000
IF PASSE$="OUI" THEN 1515 ELSE GOSUB 20011:GOTO 610
1515 EFFMG$=N$:IF EFFMG$="" THEN GOSUB 20011:GOTO 610
GOSUB 1120
1530 KILL EFFMG$
1531 GOSUB 20010:GOTO 610
2000 N$="":TR=0:GOSUB 2014:PASSE$="NON"
2012 X$=INPUT$(1):TR=TR+1
IF X$=CHR$(8) OR X$=RZ$+"K" THEN BB=LEN(N$):N$=LEFT$(N$,(BB-1)):GOSUB 2014:GOTO 2012
IF X$=E27$ THEN GOSUB 20011:OBLIGER$="":GOTO 610
IF X$=E13$ THEN PASSE$="OUI":OBLIGER$="":RETURN
IF OBLIGER$="OUI" THEN X1=X1-4:OBLIGER$=""
KREL=LEN(VA$):KERNEL=KREL+1
2013 N$=N$+X$:IF TR>(X1-KERNEL) THEN N$=LEFT$(N$,(X1-KERNEL)):TR=X1-KERNEL
GOSUB 2014:GOTO 2012
2014 COLOR A1,A7:LOCATE A+1,B+1:PRINT SPACE$(X1):COLOR A1:LOCATE A+1,B+2:PRINT VA$+"";:COLOR CLT:PRINT N$
RETURN
$SEGMENT
'
2100 COLOR A1,A1:LOCATE 23,1:PRINT SPACE$(80);
LOCATE 24,1:COLOR CTL,A3:PRINT SPACE$(80);
LOCATE 24,3:PRINT AI$;
RETURN
'
3000 A=4:B=22:X3=14:X1=19:GOSUB 6000:JK=1
AI$="Recherche un mot ou caractere ASCII dans le texte et affiche les lignes":GOSUB 2100
3005 K$(1)=" Recherche un Mot  "
K$(2)=" Remplacer un Mot  "
K$(3)=" D‚finition Barre  "
K$(4)=" Recherche Exter.  "
K$(5)=" Emplacement PAGE  "
K$(6)=" Tableau Ascii 1 Û "
K$(7)=" Tableau Ascii 2 É "
K$(8)=" Tableau Ascii 3 Ú "
K$(9)=" Tableau Ascii 4 Ö "
K$(10)=" Tableau Ascii 5 Õ "
k$(11)=" Tableau Ascii 6 * "
K$(12)=" Tableau Ascii 7 ÷ "
K$(13)=" Tableau Ascii 8 þ "
k$(14)=" Option du Texte   "
3020 COLOR CLT,A3:FOR I=0 TO 14:LOCATE 4+I,23:PRINT K$(I):NEXT I
3022 COLOR A15,A4:LOCATE 4+JK,23:PRINT K$(JK)
3025 X$=INKEY$:IF X$="" THEN 3025
3030 IF X$=RZ$+"H" OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=14
3034 IF X$=RZ$+"P" OR X$="2" THEN JK=JK+1:IF JK=15 THEN JK=1
3036 IF X$=E27$ THEN 20010
3040 IF X$=E13$ THEN 3060
$INCLUDE "MENUKN03"
if X$="4" OR X$=RZ$+"K" THEN GOSUB 20011:KN=2:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN GOSUB 20011:KN=4:GOTO 610
3050 GOTO 3020
3060 IF JK=1 THEN 3100
IF JK=14 THEN 3070
IF JK=2 THEN 17000
IF JK=3 THEN 4110
3064 IF JK=4 THEN BL$=LVG$+"RHEXT MARGO":SHELL BL$:GOTO 10001
IF JK=5 THEN COLOR A8,3:X3=2:X1=65:A=18:B=10:GOSUB 6000:COLOR A0:LOCATE 19,13:PRINT "Attention les lignes 50/100....700/750/800 seront Effacer":LOCATE 20,13:PRINT "a cause du Marquage de Page [ <Esc> pour NON ]":GOTO 65180
IF JK=11 THEN ED1=42:ED0=42:ED2=42:ED6=42:ED7=42:ED4=42:ED3=42:ED10=42:GOTO 20010
IF JK=12 THEN ED1=247:ED0=247:ED2=247:ED6=247:ED7=247:ED4=247:ED3=247:ED10=247:GOTO 20010
IF JK=6 THEN ED1=219:ED0=223:ED2=219:ED6=221:ED7=222:ED4=219:ED3=219:ED10=220:GOTO 20010
IF JK=7 THEN ED1=201:ED0=205:ED2=187:ED6=186:ED7=186:ED4=200:ED3=188:ED10=205:GOTO 20010
IF JK=8 THEN ED1=218:ED0=196:ED2=191:ED6=179:ED7=179:ED4=192:ED3=217:ED10=196:GOTO 20010
IF JK=9 THEN ED1=214:ED0=196:ED2=183:ED6=186:ED7=186:ED4=211:ED3=189:ED10=196:GOTO 20010
IF JK=10 THEN ED1=213:ED0=205:ED2=184:ED6=179:ED7=179:ED4=212:ED3=190:ED10=205:GOTO 20010
IF JK=13 THEN ED1=254:ED0=254:ED2=254:ED6=254:ED7=254:ED4=254:ED3=254:ED10=254:GOTO 20010

3070 A=7:B=11:X1=33:X3=6:GOSUB 6000:JK=1
AI$="Permet de fixer un chemin de recherche autre que PATH ":GOSUB 2100
K$(1)=" Chemin de Recherche de FICHIER "
K$(2)=" Explication d'une Commande BAT "
K$(3)=" Centrer le texte s‚lŠctionner  "
K$(4)=" Centrer la ligne               "
K$(5)=" Texte s‚lŠctionner … Gauche    "
K$(6)=" ligne … gauche                 "
3072 COLOR CLT,A3:FOR I=1 TO 6:LOCATE 7+I,12:PRINT K$(I):NEXT I
IF DDBK=FDBK THEN COLOR A8,A3:LOCATE 7+3,12:PRINT K$(3)
IF DDBK=FDBK THEN COLOR A8,A3:LOCATE 7+5,12:PRINT K$(5)
COLOR A15,A4:LOCATE 7+JK,12:PRINT K$(JK)
3075 X$=INKEY$:IF X$="" THEN 3075
IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=6
IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=7 THEN JK=1
IF X$=E27$ THEN GOSUB 20011:GOTO 610

$INCLUDE "MENUKN04"

IF NOT X$=E13$ THEN 3072
IF JK=1 THEN GOSUB 20011:GOTO 3200
IF JK=2 THEN 3080
IF JK=3 THEN 3076
IF JK=4 THEN DDBK=LIG:FDBK=LIG:GOTO 3076
IF JK=5 THEN 3077
IF JK=6 THEN DDBK=LIG:FDBK=LIG:GOTO 3077
GOTO 3070
3076 GOSUB 20011
FOR I=DDBK TO FDBK:A=LEN(WK$(I,PG))
FOR M=1 TO A
X$=LEFT$(WK$(I,PG),1):IF X$=" " THEN WK$(I,PG)=RIGHT$(WK$(I,PG),A-1):A=A-1
IF NOT X$=" " THEN MARGO0
NEXT M
MARGO0:
X=0:X$="":B=0
FOR R=DDBK TO FDBK
B=LEN(WK$(I,PG)):X=B+1
FOR VANE=1 TO B
X=X-1:X$=RIGHT$(WK$(I,PG),1)
IF X$=" "  THEN WK$(I,PG)=LEFT$(WK$(I,PG),X)
IF NOT X$=" " THEN MARGO1
NEXT VANE
NEXT R
MARGO1:
IF A<80 THEN B=80-A:B=INT(B/2):WK$(I,PG)=SPACE$(B)+WK$(I,PG)
NEXT I
GOSUB 20011
GOTO 3070
3077 FOR I=DDBK TO FDBK:A=LEN(WK$(I,PG))
FOR M=1 TO A:X$=LEFT$(WK$(I,PG),1)
IF X$=" " THEN WK$(I,PG)=RIGHT$(WK$(I,PG),A-1):A=A-1
IF NOT X$=" " THEN MARGO3
NEXT M
MARGO3:
NEXT I
GOTO 3070

$SEGMENT
3080 A=6:B=49:X3=9:X1=9:GOSUB 6000
JK=1:AI$="Aide sur les fonctions de base d'un fichier BATCH":GOSUB 2100
K$(1)=" ECHO    "
K$(2)=" GOTO    "
K$(3)=" FOR     "
K$(4)=" IF      "
K$(5)=" PAUSE   "
K$(6)=" REM     "
K$(7)=" SHIFT   "
K$(8)=" "+CHR$(34)+"%1"+CHR$(34)+"    "
K$(9)=" CLS     "
3081 COLOR CLT,A3
FOR I=1 TO 9:LOCATE 6+I,50:PRINT K$(I):NEXT I
COLOR A15,A4:LOCATE 6+JK,50:PRINT K$(JK)
3082 X$=INKEY$:IF X$="" THEN 3082
IF X$=RZ$+"P" OR X$="2" THEN JK=JK+1:IF JK=10 THEN JK=1
IF X$=RZ$+"H" OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=9
IF X$=E27$ THEN 10001
IF NOT X$=E13$ THEN 3081
3085 IF JK=1 THEN BL$=LVG$+"EC70.THL":BLOAD BL$
3086 IF JK=2 THEN BL$=LVG$+"GO279.THL":BLOAD BL$
3087 IF JK=3 THEN BL$=LVG$+"FO277.THL":BLOAD BL$
3088 IF JK=4 THEN BL$=LVG$+"IF281.THL":BLOAD BL$
3089 IF JK=5 THEN BL$=LVG$+"PA285.THL":BLOAD BL$
3090 IF JK=6 THEN BL$=LVG$+"RE286.THL":BLOAD BL$
3091 IF JK=7 THEN BL$=LVG$+"SH287.THL":BLOAD BL$
3092 IF JK=8 THEN BL$=LVG$+"P1289.THL":BLOAD BL$
3093 IF JK=9 THEN BL$=LVG$+"CL093.THL":BLOAD BL$
GOSUB 49000:GOTO 3080

3100 A=7:B=13:X1=50:X3=1:GOSUB 6010
3110 VA$="Mot … Chercher > ":GOSUB 2000
IF PASSE$="OUI" THEN 3112 ELSE 20011:GOTO 610
3112 MOT$=N$:IF MOT$="" THEN GOSUB 20011:GOTO 610
color A6,A0:FOR I=1 TO 19:LOCATE 3+I,1:PRINT SPACE$(80):NEXT I
3125 LOCATE 4,1:PRINT "Recherche de ";:COLOR A3,A0:PRINT MOT$
I=1:COLOR A7,A0:LOCATE 5,3:PRINT "Ligne nø ";I;"  "
GOTO 65100
3200 A=16:B=5:X3=1:X1=65:GOSUB 6000
COLOR CLT,A3:LOCATE 17,7:PRINT "Path = ";LVG$
3210 X$=INKEY$:IF X$="" THEN 3210
IF X$=E27$ THEN 20010
IF NOT X$=E13$ THEN 3210
A=16:B=5:X3=1:X1=65:GOSUB 6010
VA$="Path > ":GOSUB 2000
IF PASSE$="OUI" THEN 3998 ELSE 20011:GOTO 610
3998 LVG$=N$:GOTO 10001
4000 GOSUB 20011:GOTO 610
4110 A=6:B=30:X3=10:X1=47:GOSUB 6000
4111 COLOR CLT
A$=LEFT$(STG$,25)
LOCATE 7,32:PRINT " Barre en Cour ->";:COLOR A12:PRINT A$:COLOR CLT
LOCATE 9,33:PRINT "( 1 ) 123456789012345678901234567890123456"
LOCATE 10,33:PRINT "( 2 ) ÞÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍØÍÍÍÍ"
LOCATE 11,33:PRINT "( 3 ) ";STRING$(37,254)
LOCATE 12,33:PRINT "( 4 ) ÃÄÄÄÂÄÄÄÄÂÄÄÄÂÄÄÄÄÂÄÄÄÂÄÄÄÄÂÄÄÄÄ"
FOR I=0 TO 2:LOCATE 13+I,33:PRINT "(   ";I+5;") Encadrement Menus nø ";I+1:NEXT I
LOCATE 13,35:PRINT CHR$(8):LOCATE 14,35:PRINT CHR$(218):LOCATE 15,35:PRINT CHR$(201)
4112 X$=INKEY$:IF X$="" THEN 4112
IF X$="1" THEN STG$="12345678901234567890123456789012345678901234567890123456789012345678901234567890"
IF X$="2" THEN STG$="ÞÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÝ"
IF X$="3" THEN STG$=STRING$(80,254)
IF X$="4" THEN STG$="ÃÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄ´"
IF X$=E27$ OR X$=E13$ THEN GOSUB 20011:GOTO 610
GOSUB 4113:GOTO 4111
4113 IF X$="5" THEN IC18=8  :IC221=221:IC78=8  :IC223=223:IC98=8  :IC2=222:IC38=8:IC220=220
IF X$="6" THEN IC18=192:IC221=179:IC78=218:IC223=196:IC98=191:IC2=179:IC38=217:IC220=196
IF X$="7" THEN IC18=200:IC221=186:IC78=201:IC223=205:IC98=187:IC2=186:IC38=188:IC220=205
RETURN

5000 A=4:B=47:X3=11:X1=19:GOSUB 6000
AI$="Lance le programme qui se trouve dans l'Editeur avec MS-DOS":GOSUB 2100
K$(1)=" Ex‚cutions MS-DOS "
K$(2)=" Parametres Prog.  "
K$(3)=" Sauvegarde        "
K$(4)=" Verif Etiquette   "

5020 COLOR CLT,A3:FOR I=1 TO 4:LOCATE 4+I,48:PRINT K$(I):NEXT I
COLOR A15,A4:LOCATE 4+JK,48:PRINT K$(JK):COLOR A3,A9
IF BAT$="" THEN BAT$="ON"
LOCATE 7,62:PRINT BAT$:COLOR A8,A3:LOCATE 10,48:PRINT STRING$(19,247)
5024 COLOR CLT,A3:LOCATE 12,49:PRINT "Date >";:COLOR A12:PRINT DATE$
COLOR CLT:LOCATE 14,49:PRINT "Heure >";:COLOR A12:PRINT TIME$
5025 X$=INKEY$:IF X$="" THEN 5024
IF X$="4" OR X$=RZ$+"K" THEN KN=4:GOSUB 20011:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN KN=6:GOSUB 20011:GOTO 610
IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=3
IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=4 THEN JK=1
IF X$=E27$ THEN 20010
$INCLUDE "MENUKN05"

IF NOT X$=E13$ THEN 5020
IF JK=2 THEN X1=60:X3=1:A=15:B=5:GOSUB 6010:COLOR A14,A1:LOCATE 15,9:PRINT " Parametres de la ligne de commande ":GOTO EXE
IF JK=3 AND BAT$="OFF" THEN BAT$="ON":GOTO 5020
IF JK=3 AND BAT$="ON" THEN BAT$="OFF":GOTO 5020
IF JK=4 THEN A=A
IF JK=1 THEN 5100
5050 GOTO 5020
5052 GOTO 5100
$SEGMENT
EXE:
VA$=" >":GOSUB 2000
IF PASSE$="OUI" THEN 5080 ELSE 20011:GOTO 610
5080 P$=N$:IF P$="" THEN GOSUB 20011:GOTO 610 ELSE PA$=P$:GOSUB 20011:GOTO 610
GOSUB 20011:GOTO 5000
5100 COLOR 7,0:CLS:FOR I=1 TO 22:LOCATE I,1:PRINT VXX$(I):NEXT I
KOB=0:FOR I=DDBK TO FDBK:KOB=KOB+LEN(WK$(I,PG)):NEXT I
A=10:B=10:X1=60:X3=6:GOSUB 6000
COLOR A12,A4:LOCATE 10,20:PRINT " THOLL "
COLOR CLT,A3:LOCATE 11,14:PRINT "Nom du Programme    >";:COLOR A0,A7:PRINT NOM$(PG)
COLOR CLT,A3:LOCATE 12,14:PRINT "Parametres en cour  >";:COLOR A0,A7:PRINT PA$
COLOR CLT,A3:LOCATE 13,14:PRINT "Place en Oct sur le disque    >";:COLOR A0,A7:PRINT USING " ###### Oct ";KOB
COLOR CLT,A3:LOCATE 14,14:PRINT "Place restante en Memoire RAM >";:COLOR A0,A7:PRINT USING " ###.### Ko ";((FRE(-1)/1024))
COLOR CLT,A3:LOCATE 15,14:PRINT "Execution de la ligne ";:COLOR A12,A3:PRINT DDBK;:COLOR CLT,A3:PRINT " jusqu'… la ligne ";:COLOR A12,A3:PRINT FDBK
COLOR CLT,A3:LOCATE 16,14:PRINT "Mode SAVE sur >";:COLOR A0,A7:PRINT BAT$
GOSUB 49000:AXXX$="OUI"
GOSUB 1120
COLOR 7,0:CLS
5120 IF BAT$="ON" AND NOT NOM$(PG)="" THEN OPEN NOM$(PG) FOR OUTPUT AS #2:FOR I=DDBK TO FDBK:PRINT #2,WK$(I,PG):NEXT I:CLOSE
5130 SH$=NOM$(PG)+" "+PA$:CLS
5140 SHELL SH$:GOSUB 49000
LOCATE 20,2:PRINT "Tapez sur une touche pour revenir … THOLL ":GOSUB 49000
5150 GOTO 10001

6000 COLOR A8,A3:LOCATE A,B:PRINT CHR$(IC78)+STRING$(X1,IC223)+CHR$(IC98)
FOR I=1 TO X3:LOCATE A+I,B:PRINT CHR$(IC221)+SPACE$(X1)+CHR$(IC2)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR A8,A3:NEXT I
LOCATE A+I,B:PRINT CHR$(IC18)+STRING$(X1,IC220)+CHR$(IC38)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SUPER=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SUPER:PRINT CHR$(SCREEN(A+1+I,B+1+SUPER)):NEXT SUPER
COLOR CLT,A3
RETURN
6010 COLOR A8,A7:LOCATE A,B:PRINT CHR$(IC78)+STRING$(X1,IC223)+CHR$(IC98)
FOR I=1 TO X3:LOCATE A+I,B:PRINT CHR$(IC221)+SPACE$(X1)+CHR$(IC2)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR A8,A7:NEXT I
LOCATE A+I,B:PRINT CHR$(IC18)+STRING$(X1,IC220)+CHR$(IC38)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SUPER=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SUPER:PRINT CHR$(SCREEN(A+1+I,B+1+SUPER)):NEXT SUPER
COLOR CLT,A7
RETURN

6020 COLOR A8,A3:LOCATE A,B:PRINT "Ú"+STRING$(X1,"Ä")+"¿":FOR I=1 TO X3:LOCATE A+I,B:PRINT "³"+SPACE$(X1)+"³":NEXT I:LOCATE A+I,B:PRINT "À"+STRING$(X1,"Ä")+"Ù":RETURN
6030 COLOR A3,A0:LOCATE A,B:PRINT "É"+STRING$(X1,"Í")+"»":FOR I=1 TO X3:LOCATE A+I,B:PRINT "º"+SPACE$(X1)+"º":NEXT I:LOCATE A+I,B:PRINT "È"+STRING$(X1,"Í")+"¼":RETURN
6040 COLOR A8,A7:LOCATE A,B:PRINT "É"+STRING$(X1,"Í")+"»":FOR I=1 TO X3:LOCATE A+I,B:PRINT "º"+SPACE$(X1)+"º":NEXT I:LOCATE A+I,B:PRINT "È"+STRING$(X1,"Í")+"¼":RETURN

6100 COLOR A8,A3:X1=30:X3=6:A=5:B=6:GOSUB 6000:
AI$="Change le nom du programme en cour sans l'‚ffacer":GOSUB 2100
K$(1)=" Changement du Nom du fichier "
K$(2)=" Nouveau Fichier en Cour      "
K$(3)=" Modifier les couleurs        "
K$(4)=" 0>"+NOM$(0)+SPACE$(29):K$(4)=LEFT$(K$(4),28)
K$(5)=" 1>"+NOM$(1)+SPACE$(29):K$(5)=LEFT$(K$(5),28)
K$(6)=" 2>"+NOM$(2)+SPACE$(29):K$(6)=LEFT$(K$(6),28)
6111 FOR I=1 TO 6:COLOR CLT,A3:LOCATE 5+I%,7:PRINT K$(I):NEXT I
COLOR A15,A4:LOCATE 5+JK,7:PRINT K$(JK)
6120 X$=INKEY$:IF X$="" THEN 6120
IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=6
IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=7 THEN JK=1
IF X$=E27$ THEN 20010
IF X$="6" OR X$=RZ$+"M" THEN KN=2:COLOR A7,A0:GOSUB 20011:GOTO 610
IF X$="4" OR X$=RZ$+"K" THEN GOSUB 20011:GOTO 6600
IF JK=1 THEN AI$="Change le nom du programme en cour sans l'‚ffacer":GOSUB 2100
IF JK=2 THEN AI$="Efface le programme en cours de la memoire de l'‚diteur":GOSUB 2100
IF JK=3 THEN AI$="Affiche la table des couleurs en cours / Modification ":GOSUB 2100
IF JK=4 THEN AI$="Nom du programme placer dans la celule  0":GOSUB 2100
IF JK=5 THEN AI$="Nom du programme placer dans la celule  1":GOSUB 2100
IF JK=6 THEN AI$="Nom du programme placer dans la celule  2":GOSUB 2100

IF NOT X$=E13$ THEN 6111
IF JK=1 THEN 6130
IF JK=2 THEN 6200
IF JK=3 THEN 6300
IF JK=4 THEN PG=0:GOTO 6100
IF JK=5 THEN PG=1:GOTO 6100
IF JK=6 THEN PG=2:GOTO 6100
GOTO 6111

6130 A=12:B=9:X1=50:X2=1:X3=1:GOSUB 6010
GOSUB 6134:TR=0:N$=""
6132 X$=INPUT$(1):TR=TR+1
IF X$=CHR$(8) OR X$=RZ$+"K" THEN B=LEN(N$):N$=LEFT$(N$,(B-1)):GOSUB 6134:GOTO 6132
IF X$=E27$ THEN GOSUB 20011:GOTO 610
IF X$=E13$ THEN 6135
6133 N$=N$+X$:IF TR>40 THEN N$=LEFT$(N$,40):TR=40
GOSUB 6134:GOTO 6132
6134 LOCATE 13,10:PRINT SPACE$(50):COLOR CLT,A7:LOCATE 13,10:PRINT "Nom >";:COLOR A1:PRINT N$:RETURN
6135 TH$=N$:IF TH$="" THEN GOSUB 20011:GOTO 610 ELSE NOM$(PG)=TH$:GOSUB 20011:GOTO 610
6200 A=11:B=9:X1=51:X2=1:X3=2:GOSUB 6000:COLOR CLT
LOCATE 12,11:PRINT "MEMOIRE effacer O/N     Memoire restante ";FRE(0):OCT=FRE(-1)/1024
LOCATE 13,11:PRINT USING "Memoire RAM Disponible ####.## Ko";OCT
6215 X$=INKEY$:IF X$="" THEN 6215
IF X$="n" OR X$="N" OR X$=E27$ THEN GOSUB 20011:GOTO 610
IF X$="O" THEN COLOR A8,A3:GOSUB 6000:COLOR A0:LOCATE 12,11:COLOR A1:PRINT "  INITIALISATION        Memoire restante ":LOCATE 12,54:PRINT FRE(0):FOR I=1 TO K800:WK$(I,PG)="":NEXT I:NOM$(PG)="":GOSUB 20011:GOTO 610
GOTO 6215

6300 '
 A=4:B=40:X3=16:X1=36:GOSUB 6000
$INCLUDE "COLOR.BAS"
GOTO 6300

$SEGMENT
6530 OPEN NOM$(PG) FOR INPUT AS #1:CLOSE
COLOR A8,A7:A=7:B=10:X1=60:X3=1:GOSUB 6000
LOCATE 8,12:PRINT " Ce fichier ‚xiste dŠja , Voulez-vous le remplacer ? [";:COLOR A12:PRINT "O";:COLOR A14:PRINT "/";:COLOR A12:PRINT "N";:COLOR CLT:PRINT " ]"
6532 X$=INKEY$:IF X$="" THEN 6532
IF X$="O" or X$="o" THEN RETURN
IF X$="n" OR X$="N" THEN GOSUB 20011:GOTO 610
GOTO 6532
6600 A=6:B=45:X1=24:X3=3:GOSUB 6000:JK=1
AI$="Emplacement de Debut de block dans l'‚diteur":GOSUB 2100
K$(1)=" S‚l‚ction debut        "
K$(2)=" S‚l‚ction Fin          "
K$(3)=" Copie le Block definie "
6605 COLOR CLT,A3
FOR I=1 TO 3:LOCATE 6+i,46:PRINT K$(I):NEXT I
COLOR A15,A4:LOCATE 6+JK,46:PRINT K$(JK):COLOR CLT,A7:LOCATE 7,65:PRINT DDBK:LOCATE 8,65:PRINT FDBK
6610 X$=INKEY$:IF X$="" THEN 6610
IF X$=RZ$+"H" OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=3
IF X$=RZ$+"P" OR X$="2" THEN JK=JK+1:IF JK=4 THEN JK=1
IF X$="4" OR X$=RZ$+"K" THEN GOSUB 20011:KN=7:GOTO 800
IF X$="6" OR X$=RZ$+"M" THEN GOSUB 20011:KN=1:GOTO 610
IF X$=E27$ THEN 20010
IF JK=1 THEN AI$="Emplacement de Debut de block dans l'‚diteur":GOSUB 2100
IF JK=2 THEN AI$="Emplacement de Fin de block dans l'‚diteur":GOSUB 2100
IF JK=3 THEN AI$="Copie le block d‚limiter a l'emplacement actuelle du curseur ":GOSUB 2100

IF NOT X$=E13$ THEN 6605
IF JK=1 THEN DDBK=LIG
IF JK=2 THEN FDBK=LIG
IF JK=3 THEN A=-1:FOR I=DDBK TO FDBK:A=A+1:WK$(LIG+A,PG)=WK$(I,PG):NEXT I:GOSUB 20011:GOTO 610
'IF JK=4 THEN COMPRES$="OUI":GOTO 6680
'IF JK=5 THEN COMPRES$="NON":GOTO 6680
GOTO 6605

$SEGMENT

7555 IF INKEY$="" THEN 7555
7666 SCREEN SCEN,0,0:GOTO 10120
8000 A=14:B=10:X1=28:X3=2:GOSUB 6000
8001 COLOR CLT,A3:LOCATE 15,15:PRINT "Quitter THOLL [O/N] "
LOCATE 16,15:PRINT "Initialiser   [ ";:COLOR A12,A3:PRINT "I";:COLOR CLT,A3:PRINT " ]"
8010 X$=INKEY$:IF X$="" THEN 8010
8020 IF X$="O" THEN CLS:END
8023 IF X$="I" THEN SH$=LVG$+"THL":SHELL SH$:GOTO 20010
8030 IF X$="" OR X$="N" OR X$=E27$ THEN 20010
8040 '
FOR M=1 TO 300 STEP 10:SOUND 150+M,.1:SOUND 1600,.1:LOCATE 15,15:COLOR A4,A3:PRINT "Pas la Bonne Touche":NEXT M
GOTO 8000
8101 FOR I=0 TO 18:LOCATE 4+I,1:PRINT SPACE$(80):NEXT I
RETURN

8100 '
8200 A=4:B=35:X1=24:X3=12:GOSUB 6000:JK=1:A=2:CLOSE
AI$="Menu Option en cours ":GOSUB 2100
K$(1)=" Atteindre la ligne xxx "
K$(2)=" Aide Mots Clefs        "
K$(3)=" S‚l‚ction du l‚cteur   "
K$(4)=" Code Ascii Clavier     "
K$(5)=" Table des Codes Ascii  "
K$(6)=" M‚moire restante RAM   "
K$(7)=" S‚l‚ction Fiche        "
K$(8)=" Fiche en cour          "
K$(9)=" Nom du Fichier en cour "
K$(10)=" R‚duction ‚space droit "
K$(11)=" Voir Page int‚grale    "
K$(12)=" Quitter / Initialiser  "
8220 COLOR CLT,A3
FOR I=1 TO 12:LOCATE 4+I,36,0:PRINT K$(I):NEXT I
8222 COLOR A15,A4:LOCATE 4+JK,36:PRINT K$(JK)
8225 X$=INKEY$:IF X$="" THEN 8225
IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=12
IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=13 THEN JK=1
IF X$="4" OR X$=RZ$+"K" THEN KN=3:GOSUB 20011:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN KN=5:GOSUB 20011:GOTO 610
IF X$=E27$ THEN 20010
IF NOT X$=E13$ THEN 8220
IF JK=1 THEN 8410
IF JK=2 THEN 8420
IF JK=3 THEN 10001
IF JK=4 THEN GOSUB 20011:A=8:B=17:X1=40:X3=7:COLOR A8,A3:GOSUB 6000:GOTO 8500
IF JK=5 THEN 8170
IF JK=6 THEN A=10:B=10:X1=55:X3=4:GOSUB 6000:COLOR CLT,A3:LOCATE 11,13:PRINT "Memoire en octect pour THOLL ->";FRE(0)
IF JK=6 THEN MX=FRE(0):COLOR CLT,A3:KA=INT((MX*100)/49500):LOCATE 12,13:KB=100-KA:PRINT "Reste ";KA;" % , Utiliser ";KB;" % de Memoire"
IF JK=6 THEN MA=MX/1024:LOCATE 13,13:COLOR A12,A3:PRINT USING " Valeur Equivalente         ###.### Ko";MA
IF JK=6 THEN MX=FRE(-1):MA=MX/1024:LOCATE 14,13:COLOR A12,A3:PRINT USING " Memoire Restante [RAM]     ###.### Ko";MA:GOSUB 49000:GOTO 20010
IF JK=7 THEN 20004
IF JK=8 THEN A=10:B=10:X1=23:X3=1:GOSUB 6010:LOCATE 11,12:PRINT " Niveau en cour > ";PG:GOSUB 49000:GOTO 20010
IF JK=9 THEN A=10:B=10:X1=60:X3=3:GOSUB 6000:FOR I=0 TO 2:COLOR CLT,A3:LOCATE 11+I,13:PRINT "Nom en cour > ";:COLOR A1:PRINT NOM$(I):NEXT I:GOSUB 49000:GOTO 20010
IF JK=10 THEN GOSUB 20011:COLOR A15,A4:LOCATE 6,6:PRINT "** Patientez Reduction de texte **":GOSUB 9800:GOTO 10001
8223 IF JK=11 THEN COLOR 7,0:CLS:FOR I=1 TO 22:LOCATE I,1:PRINT VXX$(I):NEXT I:GOSUB 49000:GOTO 10001
IF JK=12 THEN 8000
GOTO 8200
$SEGMENT
8410 A=10:B=10:X1=13:X3=1:GOSUB 6010
VA$="Ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 8415 ELSE GOSUB 20011:GOTO 610
8415 L=VAL(N$):IF L<(K800-20) AND L<K800 AND L>0 THEN LIG=L:SOUND 500,1:V=1:H=1
GOSUB 20011:GOTO 610
8420 GOSUB 20011:A=5:B=5:X1=70:X3=15:GOSUB 6000
$INCLUDE "PROG.BAS"
END
8170 COLOR A7,A0:GOSUB 8101:A=0:B=4:COLOR A7
8180 COLOR A3,A0:LOCATE 4,1:PRINT "Ú"+SPACE$(78)+"¿"
FOR I=1 TO 17:LOCATE 4+I,1:PRINT "³"+SPACE$(78)+"³":NEXT I
LOCATE 4+I,1:PRINT "À"+SPACE$(78)+"Ù"
FOR I=32 TO 255
A=A+1
IF I>64 AND I<91 THEN COLOR A2 ELSE COLOR A7
IF I>47 AND I<58 THEN COLOR A12 ELSE COLOR A7
LOCATE A+4,B:PRINT CHR$(I);:COLOR A1:PRINT "";I
IF A=18 THEN A=-1:B=B+6
NEXT I
8400 GOSUB 49000:GOSUB 20011:GOTO 610

8500 COLOR A1:LOCATE 9,18:PRINT " Code Touche "
COLOR CLT:LOCATE 10,20:Print " Taper sur la Touche desirer pour "
LOCATE 11,20:PRINT " connaitre son Code Ascii "
8510 X$=INKEY$:IF X$="" THEN 8510
IF X$=CHR$(12) THEN X$="Clear":GOTO 8500
COLOR A0,A3:LOCATE 12,20:PRINT "Code Normal CHR$( ";ASC(X$);" ) "
LOCATE 13,20:X=ASC(RIGHT$(X$,1)):PRINT "Pour ALT + Touche -> ";X;"  "
LOCATE 14,20:PRINT "Alt -> RZ$+CHR$(";X;") "
LOCATE 15,20:PRINT "Repr‚sentation ";X$;" "
IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 8500
$SEGMENT
9000 '
9010 A=6:B=30:X1=40:X3=8:GOSUB 6000
9020 COLOR 15,4:LOCATE 6,35:PRINT " ERREUR "
9030 KJ=2
9040 COLOR A4,A3:LOCATE 7,32:PRINT "Le Fichier n'a pas ete ouvert en"
LOCATE 8,32:PRINT "lecture [";:COLOR A1:PRINT LEFT$(NOM$(PG),20);:COLOR A4:PRINT "]"
9045 FOR I=0 TO 4:LOCATE 9+I,31:PRINT SPACE$(36):NEXT I
9050 LOCATE 10,40:PRINT "(R)ecommencer l'appel "
LOCATE 12,40:PRINT "(A)nnuler l'appel "
IF KJ=1 THEN COLOR A8,A3:LOCATE 9,35:PRINT "Ú"+STRING$(29,"Ä")+"¿":LOCATE 10,35:PRINT "³":LOCATE 10,65:PRINT "³":LOCATE 11,35:PRINT "À"+STRING$(29,"Ä")+"Ù"
IF KJ=2 THEN COLOR A8,A3:LOCATE 11,35:PRINT "Ú"+STRING$(29,"Ä")+"¿":LOCATE 12,35:PRINT "³":LOCATE 12,65:PRINT "³":LOCATE 13,35:PRINT "À"+STRING$(29,"Ä")+"Ù"
9072 X$=INKEY$:IF X$="" THEN 9072
9080 IF X$="r" OR X$="R" OR X$=RZ$+"H" THEN KJ=1
9085 IF X$="A" OR X$="a" OR X$=RZ$+"P" THEN KJ=2
9090 IF X$=E13$ AND KJ=2 THEN GOSUB 20011:GOTO 610
9093 IF X$=E13$ AND KJ=1 THEN 1315
9100 GOTO 9040
9200 SOUND 260,1:X=10:Y=10
X2=H:Y2=V:IMPARABLEX=H:IMPARABLEY=V:EO=LIG:SYST$="OUI"
B=LEN(WK$(LIG,PG)):FFX=80-B:B=B+FFX:WK$(LIG,PG)=WK$(LIG,PG)+SPACE$(FFX)
B=LEN(WK$(EO,PG)):DJ$=LEFT$(WK$(EO,PG),X2-1):T=B-X2:DK$=RIGHT$(WK$(EO,PG),T)
WK$(EO,PG)=DJ$+CHR$(ED1)+DK$:NN=LEN(DJ$):GOSUB 20011
9210 GOTO 10120
9500 IF NOT SYST$="OUI" THEN LOCATE 22,4:PRINT SPACE$(79):LOCATE 22,4:PRINT "Vous n'avez pas debutŠ le tableau (Debut avec Alt C) ":GOSUB 49000:LOCATE 22,1:PRINT SPACE$(80):GOTO 20010
X4=H:Y4=V:EO4=LIG:X24=H:X2=IMPARABLEX:Y2=IMPARABLEY:AI$=" Creation du cadre . Veuillez patientez ":GOSUB 2100
B=LEN(WK$(EO4,PG)):FFX=80-B:B=B+FFX:WK$(LIG,PG)=WK$(LIG,PG)+SPACE$(FFX)
L$=LEFT$(WK$(EO,PG),X2-1):X4=80-X4:RIG$=RIGHT$(WK$(EO,PG),X4):B=LEN(WK$(EO,PG))
C=80-X4-X2-1:WK$(EO,PG)=L$+CHR$(ED1)+STRING$(C,ED0)+CHR$(ED2)+RIG$:RIG$=RIGHT$(WK$(EO4,PG),X4):L$=LEFT$(WK$(EO4,PG),X2-1):B=LEN(WK$(EO4,PG)):C=80-X4-X2-1
iF C<0 THEN C=C+1:WK$(EO4,PG)=L$+CHR$(ED4)+STRING$(C,ED10)+CHR$(ED10)+RIG$
IF C>0 THEN WK$(EO4,PG)=L$+CHR$(ED4)+STRING$(C,ED10)+CHR$(ED3)+RIG$
FOR I=EO+1 TO EO4-1:B=LEN(WK$(I,PG)):FFX=80-B:B=B+FFX:WK$(I,PG)=WK$(I,PG)+SPACE$(FFX)
GT$=LEFT$(WK$(I,PG),X2-1):T=B-X2:GK$=RIGHT$(WK$(I,PG),T):WK$(I,PG)=GT$+CHR$(ED6)+GK$:NEXT I
9610 FOR I=EO+1 TO EO4-1:B=LEN(WK$(I,PG)):FFX=80-B:B=B+FFX:WK$(I,PG)=WK$(I,PG)+SPACE$(FFX)
GT$=LEFT$(WK$(I,PG),X24-1):T=B-X24:GK$=RIGHT$(WK$(I,PG),T):WK$(I,PG)=GT$+CHR$(ED7)+GK$
NEXT I:GOSUB 9800:SYST$="NON":GOSUB 20011:GOTO 610
9800 X=0:X$="":B=0:LOCATE 4,1
FOR I=1 TO LIG:B=LEN(WK$(I,PG)):X=B+1
FOR VANE=1 TO B:X=X-1:X$=RIGHT$(WK$(I,PG),1)
IF X$=" "  THEN WK$(I,PG)=LEFT$(WK$(I,PG),X)
IF NOT X$=" " THEN SORVITE2
NEXT VANE
SORVITE2:
NEXT I:RETURN

10000 COLOR A7,A0,A0:CLS:SCREEN SCEN,0,0:DIM WK$(K800,2),DX$(2000),PCTOOLS%(2000),VAX$(25),RP$(30),VXX$(25)
10001 COLOR A7,A0,A0:CLS:H=1:V=1:A$="":RFT=1
WIDTH 80:CLOSE:IF LIG>K800-20 THEN LIG=LIG-20
IF LIG<10 THEN LIG=1
10002 '
$INCLUDE "LINEDUBA.BAS"

10010 COLOR A8,A0:LOCATE 1,1
FOR I=1 TO 2:PRINT STRING$(80,"Û");:NEXT I
SOUND 1600,.2
10020 COLOR A10,A0:LOCATE 1,1:PRINT "Shift";:COLOR A6:PRINT "/";:COLOR A2:PRINT " Esc ";:GOSUB 10022
COLOR A3,A0:PRINT " Alt  ";:COLOR A9:PRINT "Q";:COLOR A1:PRINT " Fin":COLOR A7,A0
COLOR A11,A0:LOCATE 2,14,0:PRINT " Line ";:COLOR A9:PRINT LIG;:COLOR A8,A0:PRINT "ÛÛÛÛ"
COLOR A11,A0:LOCATE 2,28:PRINT " Col ";:COLOR A9:PRINT H:COLOR A3,A0:LOCATE 2,67:PRINT "Pos ";:COLOR A12,A0:PRINT POK$
COLOR A8,A0:LOCATE 2,1:PRINT "Modif":LOCATE 3,1:PRINT STG$:COLOR A0,A3:LOCATE 3,2:PRINT "PgUp":LOCATE 3,7:PRINT "PgDn"
LOCATE 3,H:COLOR A4,A0:PRINT CHR$(25)
KEY 1,"ECHO ":KEY 2,"GOTO ":KEY 3,"FOR ":KEY 4,"IF ":KEY 5,"PAUSE ":KEY 6,"REM ":KEY 7,"SHIFT ":KEY 8,CHR$(34)+"%1"+CHR$(34):KEY 9,"CLS ":KEY 10,"EXIST ":GOSUB 20011
IF TYN$="ON2" THEN GU2
A=10:B=18:X1=40:X3=6:GOSUB 6000:LOCATE 11,24:COLOR CLT:PRINT "THOLL ver 1.00 [ 1990 - 1993 ]":LOCATE 13,34:PRINT "Ecrit par":COLOR CLT,A3:LOCATE 15,26:PRINT "<ð SERGä TSAKIROPOULOS ð>":GOSUB 49000:GOSUB 20011

$SEGMENT
AI$="S‚lection du Lecteur de travail / Souris possible ou fleches":GOSUB 2100

$INCLUDE "GUIDE"
IF L$="" THEN GU2
FL$=L$+"SXSXS.XSX"
10021 CLOSE:OPEN FL$ FOR INPUT AS #1:CLOSE
GUIDER:
SHELL L$
GU2:
GOSUB 20011:GOTO 10040
10022 COLOR A14,A0:PRINT " N";:COLOR A12,A0:PRINT "om F. ";:COLOR A14,A0:PRINT " F";:COLOR A12,A0:PRINT "ichier ";:COLOR A14,A0:PRINT " T";:COLOR A12,A0:PRINT "exte ";
COLOR A14,A0:PRINT " O";:COLOR A12,A0:PRINT "ptions ";:COLOR A14,A0:PRINT " E";:COLOR A12,A0:PRINT "xecut ";:COLOR A14,A0:PRINT " I";:COLOR A12,A0:PRINT "mprime ";:COLOR A14,A0:PRINT " C";:COLOR A12,A0:PRINT "opier ";:RETURN
10040 '
10041 GOSUB 20011:AI$="Installation en cours ....":GOSUB 2100

10042 '
10043 COLOR A14,A0
10044 IF POK$="" THEN POK$="NON"
10046 COLOR A3,A0:LOCATE 2,67:PRINT "Pos ";:COLOR A12,A0:PRINT POK$:COLOR A8,A0:LOCATE 2,1:PRINT "Modif"
10050 GOSUB 10060:GOTO 10100
10060 COLOR A11,A0:LOCATE 2,14,0:PRINT " Line ";:COLOR A9:PRINT LIG;:COLOR A8,A0:PRINT "ÛÛÛÛ"
10061 COLOR A11,A0:LOCATE 2,28:PRINT " Col ";:COLOR A9:PRINT H
LOCATE 3,1:PRINT STG$:COLOR A0,A3:LOCATE 3,2:PRINT "PgUp":LOCATE 3,7:PRINT "PgDn":LOCATE 3,H:COLOR A4,A0:PRINT CHR$(25)
10066 RETURN
10100 AI$=" Esc-Menu / Alt-C Debut,Alt-K Fin du cadre  ":GOSUB 2100
LOCATE 3,1,0:COLOR A9,A0:PRINT STG$
IF TYN$="ON2" THEN TYN$="":GOTO 1321
IF TYN$="ON" THEN TYN$="":NOM$(PG)=HO2$:GOTO 1321
10110 GOSUB 10060
10120 LOCATE V+3,H,1,0,7

 '**********
10200 X$=INKEY$:IF X$="" THEN 10120
 '**********
AI$=" Esc-Menu / Alt-C Debut,Alt-K Fin du cadre  ":GOSUB 2100

10248 IF X$=E13$ AND NOT POK$="OUI" THEN SOUND 1600,1:X$=RZ$+"P":H=1
10205 IF X$=RZ$+"H" AND V=1 AND H<6 AND H>1 THEN X$="I"
IF X$=RZ$+"H" AND V=1 AND H<11 AND H>6 THEN X$=RZ$+"Q"
10210 IF X$=RZ$+"K" THEN H=H-1:IF H=0 THEN H=1:GOTO 10110 ELSE 10110
10220 IF X$=RZ$+"H" THEN V=V-1:LIG=LIG-1:IF V=0 THEN V=1:IF LIG=0 THEN LIG=1
10230 IF X$=RZ$+"P" THEN V=V+1:LIG=LIG+1:IF V=20 THEN V=19:IF LIG=K800+1 THEN LIG=K800
IF X$=RZ$+"M" THEN H=H+1:IF H=81 THEN H=80:GOTO 10110
IF LCP$="ON" THEN GOSUB 20015
10231 IF X$=RZ$+"P" THEN 20000
IF X$=RZ$+"H" THEN 20000
10234 IF X$=RZ$+"G" THEN V=1:H=1:LIG=1:GOSUB 20011
IF X$=RZ$+"O" THEN V=1:H=1:LIG=K800-20:GOSUB 20011
10242 IF X$=RZ$+"Q" AND NOT LIG>(K800-30) AND V<18 THEN LIG=LIG+18:GOSUB 20011
IF X$=RZ$+CHR$(16) THEN 8000
10246 IF LIG>22 AND ASC(RIGHT$(X$,1))=73 AND LIG>22 AND NOT LIG<22 THEN LIG=LIG-18:GOTO 20120
IF X$=RZ$+"H" OR X$=RZ$+"P" OR X$=RZ$+"M" OR X$=RZ$+"K" THEN GOSUB 10060:GOTO 10120
IF X$=E27$ AND NOT POK$="OUI" THEN X$="":GOTO 540
IF X$=CHR$(9) AND POK$="NON" THEN POK$="OUI":IF POK$="NON" THEN COLOR A8,A0:LOCATE 2,1:PRINT "Modif":GOTO 10046
IF X$=CHR$(9) AND POK$="OUI" THEN POK$="NON":IF POK$="OUI" THEN COLOR A20,A4:LOCATE 2,1:PRINT "Modif":GOTO 10046
IF X$=RZ$+CHR$(19) THEN 5052
IF X$=RZ$+CHR$(23) AND NOT POK$="OUI" THEN COLOR A8,A7:LOCATE 4,4:PRINT "** Patientez Insertion **":ZA=K800:FOR Z=LIG+1 TO K800:ZA=ZA-1:WK$(ZA,PG)=WK$(ZA-1,PG):NEXT Z:WK$(LIG,PG)="":GOTO 20010
IF X$=RZ$+" " AND NOT POK$="OUI" THEN COLOR A15,A4:LOCATE 4,4:PRINT "** Patientez Delete **":FOR Z=LIG TO K800-1:WK$(Z,PG)=WK$(Z+1,PG):NEXT Z:WK$(K800,PG)="":GOTO 20010
IF X$=RZ$+"." THEN 9200
IF X$=RZ$+"%" AND SYST$="OUI" THEN 9500
IF X$=RZ$+"T" THEN KN=1:GOTO 610
IF X$=RZ$+"U" THEN 1000
IF X$=RZ$+"V" THEN 3000
IF X$=RZ$+"W" THEN 8100
IF X$=RZ$+"X" THEN 5000
IF X$=RZ$+"Y" THEN 800
IF X$=RZ$+"Z" THEN 6600
IF X$=RZ$+CHR$(38) THEN SOUND 600,.1:LCP$="OFF":GOTO 20010
IF X$=RZ$+CHR$(24) THEN SOUND 1600,.1:LCP$="ON":GOSUB 20015:GOTO 20010
IF X$=RZ$+CHR$(18) THEN GOSUB 65020:GOTO 20010
IF X$=CHR$(14) THEN LPRINT CHR$(7):LPRINT "** THOLL 1.00 - TSAKI **":LPRINT "Nom --> ";NOM$(PG):LPRINT "Date -> ";DATE$;" : Time -> ";TIME$:LPRINT E13$:FOR I=1 TO 5:LPRINT CHR$(7):NEXT I
IF X$=RZ$+CHR$(17) THEN A=10:B=10:X1=60:X3=2:GOSUB 6000:LOCATE 11,13:PRINT "Caractere total du TEXTE ":X=0:FOR I=1 TO LIG:B=LEN(WK$(I,PG)):LOCATE 11,38:X=X+B:PRINT "ligne ";I;" Total=";X:NEXT I
IF X$=RZ$+CHR$(17) THEN COLOR A1:MA=X/1024:LOCATE 12,13:PRINT USING " Valeur Equivalente = ###.### Ko ";MA:GOSUB 49000:GOTO 20010
IF X$=CHR$(17) THEN W$=WK$(LIG,PG):SOUND 500,1:GOTO 10299
IF X$=CHR$(12) THEN WK$(LIG,PG)=W$:SOUND 600,1:GOTO 10299
BB=LEN(WK$(LIG,PG)):LOCATE 10,1
H1=-2:H2=1
IF X$=CHR$(8) AND H>BB AND BB=0 THEN 10299
IF X$=CHR$(8) AND H>BB THEN H=BB:WK$(LIG,PG)=WK$(LIG,PG)+"   "
IF X$=CHR$(8) AND H>1 AND BB>H THEN WW$=LEFT$(WK$(LIG,PG),H+H1):XX$=RIGHT$(WK$(LIG,PG),BB-H+H2):WK$(LIG,PG)=WW$+XX$:COLOR A15,A1:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):H=H-1:GOTO 10299
IF X$=CHR$(8) AND H=1 AND LEN(WK$(LIG,PG))>H THEN 10299
IF X$=CHR$(8) THEN 10299
10269 IF X$=CHR$(0)+CHR$(82) AND BB<H THEN 10299
10270 IF X$=CHR$(0)+CHR$(82) AND H>1 AND BB>H THEN WW$=LEFT$(WK$(LIG,PG),H):XX$=RIGHT$(WK$(LIG,PG),BB-H):WK$(LIG,PG)=WW$+" "+XX$:COLOR A15,A1:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):GOTO 10299
10271 IF X$=CHR$(0)+CHR$(82) AND H=1 THEN WK$(LIG,PG)=" "+WK$(LIG,PG):SOUND 1600,.1:GOTO 10299
10280 IF X$=CHR$(0)+CHR$(82) THEN 10299
'IF X$=RZ$+CHR$(83) THEN  A=A  'DELETE
10298 '***************************************************************
C=LEN(X$):IF C=2 THEN 10299
IF POK$="OUI" THEN 10299
B=LEN(WK$(LIG,PG)):IF B<H THEN WK$(LIG,PG)=WK$(LIG,PG)+SPACE$(H-B)
MID$(WK$(LIG,PG),H)=X$:IF H<80 THEN H=H+1
COLOR A15,A1:LOCATE V+3,1,1,0,7:PRINT SPACE$(80):LOCATE V+3,1,1,0,7:PRINT LEFT$(WK$(LIG,PG),80)
10299 '***************************************************************
GOSUB 10060
10300 GOTO 10120
$SEGMENT
17000 A=7:B=9:X1=67:X3=1:GOSUB 6000:KL=1
17020 LOCATE 10,22:COLOR A8,A0:PRINT CHR$(IC221)+" Tableau Ascii 1 Û "+CHR$(IC2)
17040 COLOR CLT,A3:LOCATE 8,11:PRINT "<O>  Mot … changer   <   >  Avec une confirmation par O / N "
17050 X$=INKEY$:IF X$="" THEN 17050
17055 FOIS=0:THO=0
17060 IF ASC(RIGHT$(X$,1))=75 THEN KL=KL-1:IF KL=0 THEN KL=2
17070 IF ASC(RIGHT$(X$,1))=77 THEN KL=KL+1:IF KL=3 THEN KL=1
17075 COLOR CLT,A3:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17076 COLOR CLT,A3:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">":THO=0
17080 IF KL=1 THEN COLOR A14:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17090 IF KL=2 THEN COLOR A14:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">"
17199 COLOR A8,A11
17200 IF X$=E13$ AND KL=1 THEN THO=0:CARKA$="":GOTO 17500
17210 IF X$=E13$ AND KL=2 THEN CARKA$="":IF ACV$="" OR ACV$="NON" THEN ACV$="OUI":LOCATE 8,33:PRINT ACV$ ELSE ACV$="NON":LOCATE 8,33:PRINT ACV$
17300 IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 17050
17500 IF ACV$="" THEN ACV$="NON"
THO=0:GOSUB 20011:A=8:B=15:X3=1:X1=40:GOSUB 6010
17550 VA$="Mot … changer > ":GOSUB 2000
IF PASSE$="OUI" THEN 17559 ELSE 20011:GOTO 610
17559 MOT$=N$:IF MOT$="" THEN GOSUB 20011:GOTO 610

17560 A=13:GOSUB 6010:COLOR CLT,A7:LOCATE 14,17
VA$=" Par > ":GOSUB 2000
IF PASSE$="OUI" THEN 17562 ELSE GOSUB 20011:GOTO 610
17562 AAA$=N$:IF AAA$="" THEN GOSUB 20011:GOTO 610

COLOR A7,A0
17565 GOSUB 8101
17570 COLOR A12,A0
LOCATE 5,1:PRINT STRING$(80,"÷"):COLOR A14:LOCATE 4,2:PRINT " le Mot ";:COLOR A3:PRINT MOT$;:COLOR A14:PRINT " devient ";:COLOR A9,A0:PRINT AAA$
17580 COLOR A4,A0:LOCATE 21,1:PRINT STRING$(80,"÷"):COLOR A3
17590 K1=LEN(WK$(THO,PG)):K2=LEN(MOT$):K3=LEN(AAA$)
17600 FOR I=1 TO K1:A$=LEFT$(WK$(THO,PG),I):B$=RIGHT$(A$,K2)
IF B$=MOT$ THEN FOIS=FOIS+1:LOCATE 21,29:PRINT "Trouver ";FOIS:GOTO 18000
17630 NEXT I
17640 COLOR A11,A0:LOCATE 2,14:PRINT " Line ";THO:THO=THO+1
IF THO=LIG THEN COLOR A7,A0:LOCATE 22,1:PRINT SPACE$(80):LOCATE 22,1:COLOR A9,A11:PRINT "La Recherche et le remplacement sont terminer":GOSUB 49000:GOTO 10001
17650 GOTO 17590
18000 ZE=ZE+1:IF ZE=12 THEN ZE=1
BCBG=LEN(MOT$):MGTS=LEN(MOT$)
IF NOT MGTS=1 THEN W1=1:W2=2
TY=LEN(WK$(THO,PG)):TM$=RIGHT$(WK$(THO,PG),TY-I)
TP$=LEFT$(WK$(THO,PG),I-K2-CCCC)
LOCATE ZE+6,1:PRINT SPACE$(80):LOCATE ZE+6,1:COLOR A7,A0:PRINT TP$;:COLOR A9,A3:PRINT MOT$;:COLOR A7,A0:PRINT TM$
IF ACV$="OUI" THEN LOCATE 4,46:PRINT SPACE$(30):LOCATE 4,46:COLOR A14,A0:PRINT "*** ";:COLOR A7:PRINT "A remplacer ";:COLOR A11:PRINT "O";:COLOR A12:PRINT "/";:COLOR  A9:PRINT "N";:COLOR A14:PRINT " ***":GOTO 18400
IF ACV$="NON" THEN WK$(THO,PG)=TP$+AAA$+TM$:A$="":B$="":TP$="":TM$="":CCCC=0:W1=0:W2=0:SP=0:K2=0:YKY=0:GOTO 17590
18400 X$=INKEY$:IF X$="" THEN 18400
IF X$="o" OR X$="O" THEN WK$(THO,PG)=TP$+AAA$+TM$:GOTO 17590
IF X$="n" OR X$="N" THEN LOCATE 4,46:PRINT SPACE$(30):GOTO 17640
IF X$=E27$ THEN 20010
SOUND 1600,.1:GOTO 18400
20000 COLOR A15,A1
20001 IF NOT V=1 THEN 20002
FOR I=0 TO 18:W$=WK$(LIG+I,PG)+SPACE$(80)
LOCATE 4+I,1,0:PRINT SPACE$(80):EDF$=LEFT$(W$,80)
IF (LIG+I)>DDBK-1 AND (LIG+I)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 4+I%,1,0:PRINT EDF$
NEXT I%:GOTO 20003

20002 IF NOT V=19 THEN 20003
FOR I=0 TO 18:W$=WK$(LIG-I,PG)+SPACE$(80)
LOCATE 22-I,1,0:PRINT SPACE$(80):EDF$=LEFT$(W$,80)
IF (LIG-I)>DDBK-1 AND (LIG-I)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 22-I,1,0:PRINT EDF$
NEXT I
20003 GOSUB 10060:GOTO 10120
20004 A=10:B=10:X1=60:X3=3:GOSUB 6000:JK=1
20006 FOR I=0 TO 2:COLOR CLT,A3:LOCATE 11+I,27:PRINT SPACE$(42):COLOR CLT,A3:LOCATE 11+I,13:PRINT "Nom en cour > ";:COLOR A1:PRINT NOM$(I):NEXT I
COLOR A15,A4:LOCATE 10+JK,27:PRINT SPACE$(42):LOCATE 10+JK,27:PRINT NOM$(JK-1)
20005 X$=INKEY$:IF X$="" THEN 20005
IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=3
IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN JK=JK+1:IF JK=4 THEN JK=1
IF X$=E27$ THEN 20010
IF X$=E13$ AND JK=1 THEN PG=0
IF X$=E13$ AND JK=2 THEN PG=1
IF X$=E13$ AND JK=3 THEN PG=2
GOTO 20006
20010 AA=0:COLOR A15,A1:AA=LIG-V
FOR I=0 TO 18:B=LEN(WK$(AA+I+1,PG))
IF NOT B<80 THEN C$=LEFT$(WK$(AA+I+1,PG),80):ZZT=0 ELSE ZZT=80-B:C$=WK$(AA+I+1,PG)
IF WK$(AA+I+1,PG)="" THEN C$="":ZZT=80
IF (AA+I+1)>DDBK-1 AND (AA+I+1)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 4+I,1,0:PRINT C$+space$(ZZT):COLOR A15,A1
SAUT:
COLOR A15,A1:NEXT I:GOTO 10110
20011 AA=0:COLOR A15,A1:AA=LIG-V
FOR I=0 TO 18:BB=LEN(WK$(AA+I+1,PG))
20012 IF NOT BB<80 THEN C$=LEFT$(WK$(AA+I+1,PG),80):ZZT=0 ELSE ZZT=80-BB:C$=WK$(AA+I+1,PG)
20013 IF WK$(AA+I+1,PG)="" THEN C$="":ZZT=80
20014 IF (AA+I+1)>DDBK-1 AND (AA+I+1)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 4+I,1,0:PRINT C$+space$(ZZT):COLOR A15,A1
SAUT2:
COLOR A15,A1
NEXT I:LOCATE 4,1:COLOR A8,A3:RETURN
20015 AA=0:COLOR A15,A1:AA=LIG-V
20016 FOR I=0 TO 18:W$=WK$(AA+I+1,PG)+SPACE$(80)
EDF$=LEFT$(W$,80):IF (AA+I+1)>DDBK-1 AND (AA+I+1)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 4+I,1:PRINT EDF$
NEXT I
LOCATE V+3,1:COLOR A11,A1:PRINT SPACE$(80)
LOCATE V+3,1:COLOR A11,A12:PRINT LEFT$(WK$(LIG,PG),80)
RETURN
20035 COLOR A15,A1:FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(80):NEXT I:LOCATE 4,1:RETURN
20110 COLOR A15,A1:FOR I=0 TO 18:W$=WK$(LIG+I,PG)+SPACE$(80):EDF$=LEFT$(W$,80):LOCATE 4+I,1,0:PRINT EDF$:NEXT I:LIG=LIG-V:GOSUB 10060:GOTO 10110
20120 COLOR A15,A1:FOR I=0 TO 18:W$=WK$(LIG+I,PG)+SPACE$(80):EDF$=LEFT$(W$,80)
IF (LIG+I)>DDBK-1 AND (LIG+I)<FDBK+1 THEN COLOR A0,A3 ELSE COLOR A15,A1
LOCATE 4+I,1,0:PRINT EDF$
NEXT I:LIG=LIG+V-1:GOSUB 10060:GOTO 10110
$SEGMENT

40000 $INCLUDE "PARA"
49000 IF INKEY$="" THEN 49000 ELSE RETURN
50000 COLOR A15,A1:LOCATE V+3,1,1,0,7:PRINT LEFT$(WK$(LIG,PG),80)
LOCATE 2,1:COLOR A8,A0:PRINT "Modif":LOCATE 2,40:PRINT STRING$(9,219):COLOR A15,A1
RETURN
50100 COLOR A9,A0:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT CC$
RETURN
60000 IF ERL=2012 THEN RESUME 2000
IF ERL=8412 THEN RESUME 8410
IF ERL=6132 THEN RESUME 6130
IF ERL=-334 OR ERL=65192 THEN RESUME DISK
IF ERL=65206 OR ERL=-330 THEN RESUME 65207
IF ERL=201 THEN PRINT " ERREUR DE PROGRAMMATION ERL=201 ":GOSUB 49000:RESUME 10001
IF ERL=10021 AND ERR=76 THEN A=17:B=30:X1=36:X3=1:COLOR A8,3:GOSUB 6000:LOCATE 18,34:PRINT "Vous n'avez pas de lecteur ";L$:GOSUB 49000:COLOR A7,A0:RESUME D4
IF ERL=10021 AND ERR=53 THEN CLOSE:RESUME GUIDER
IF ERL=10021 AND ERR=55 THEN CLOSE:RESUME GUIDER
IF ERL=4000 THEN COLOR A8,A3:X3=1:A=10:B=10:X1=40:GOSUB 6000:COLOR CLT:LOCATE 11,17:PRINT "MOUSE.COM Introuvable":RESUME 10001
IF ERL=450 THEN CLOSE:SOUND 600,1:COLOR A15:LOCATE 8,27:PRINT " Introuvable  ";F$(JK):GOSUB 49000:RESUME 400
IF ERL=455 AND ERR=62 THEN CLOSE:GOSUB 49000:BB=0:RESUME 400
COLOR A8,A3
IF ERL=-336 OR ERL=-337 OR ERL=65200 OR ERL=3064 OR ERL=1061 OR ERL=-316 THEN GOSUB 20011:X3=1:A=10:B=10:X1=54:GOSUB 6010:COLOR A0:LOCATE 11,20:PRINT "INTROUVABLE >";ERL,ERR:GOSUB 49000:RESUME 10001
IF ERL=8023 THEN GOSUB 20011:X3=1:A=10:B=10:X1=54:GOSUB 6010:COLOR A0:LOCATE 11,20:PRINT "INTROUVABLE >";ERL,ERR:GOSUB 49000:RESUME 10001
IF ERL=65205 OR ERL=-331 AND ERR=62 THEN RESUME 65210
IF ERL=65205 AND NOT ERR=62 THEN RESUME 20010
IF ERL>3084 AND ERL<3095 THEN GOSUB 20011:A=6:B=20:X1=54:X3=1:GOSUB 6010:COLOR CLT,A7:LOCATE 7,22:PRINT " les fichiers AIDE sont introuvables sur le disque ":GOSUB 49000:RESUME 10001
IF ERL=35 THEN GOSUB 40:RESUME 45
60002 IF ERL=45 THEN XX=8:YY=9:RESUME 50
IF ERL=10000 THEN RESUME 10001
IF ERL=1330 OR ERL=1070 THEN RESUME 9010
IF ERL=20120 THEN V=1:H=1:LIG=1:RESUME 20010
IF ERL=1345 AND ERR=62 THEN RESUME 20010
IF ERL=1072 AND ERR=62 THEN RESUME 20010
IF ERL=403 THEN CLOSE:RESUME 404

IF ERL=496 THEN RESUME NOW
IF ERL=451 THEN RESUME 453
IF ERL=457 THEN RESUME 459
IF ERL=455 AND NOT ERR=62 THEN COLOR A31,A0:LOCATE 9,33:PRINT "ERREUR DANS LE PROGRAMME ":CLOSE:GOSUB 49000:RESUME 400
IF ERL=494 OR ERL=495 THEN PRINT "Impossible D'‚x‚cuter le Scanner de THOLL ":GOSUB 49000:RESUME 404
IF ERL=456 THEN COLOR 8,2:LOCATE 23,5:PRINT STRING$(70,"±"):LOCATE 17,7:PRINT "Fichier Introuvable ";:COLOR 12,4:PRINT F$:SOUND 500,1:GOSUB 49000:RESUME 459
IF ERL=463 THEN PRINT "Impossible d'effacer le fichier ":GOSUB 65000:RESUME 459
IF ERL=10298 THEN RESUME 10299
IF ERL=6530 THEN RESUME 1200
WIDTH 80:SCREEN SCEN

CLOSE:A=16:B=4:X1=70:X3=2:GOSUB 6000:COLOR A15,A4:LOCATE 16,28:PRINT " ERREUR VISUALISER ":COLOR CLT,A3:LOCATE 17,7

IF ERR=14 THEN SOUND 100,.4:COLOR 28,4:PRINT " ERREUR General 14  MEMOIRE Pleine  ";:COLOR A16,A7:PRINT " ESSAIE REPARATION -> ";FRE(0);"] ";REPA;" ":REPA=REPA+1:WK$(K800-REPA,PG)="":RESUME 10001
IF ERL=6304 OR ERL=6306 OR ERL=6408 THEN PRINT "Non enregistrer":GOSUB 49000:RESUME 6300
IF ERL=6302 OR ERL=6303 THEN PRINT "ERREUR D'APPEL":GOSUB 49000:RESUME 6300
IF ERL=10250 THEN PRINT "Fichier-Fenetre Intouvable ou incomplet ":GOSUB 49000:RESUME 10001
IF ERL=1057 THEN PRINT "MS-DOS impossible Command.com Introuvable ver DOS":GOSUB 49000:RESUME 10001
IF ERL=9550 THEN PRINT "Vous ne devez pas vous positionner avant l'origine ":GOSUB 49000:RESUME 10001
IF ERL=1200 THEN PRINT "Le fichier n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
IF ERL=934 OR ERL=942 THEN PRINT "Erreur sur l'Imprimante":GOSUB 65000:RESUME 20010
IF ERL=1345 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier **":GOSUB 65000:RESUME 20010
IF ERL=1210 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier **":GOSUB 65000:RESUME 20010
IF ERL=1072 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier avec SPEED **":GOSUB 65000:RESUME 20010
IF ERL=401 THEN PRINT "** Pas de Fichier Scan **":GOSUB 49000:RESUME 404
IF ERL=1430 THEN PRINT "le Fichier de Fusion ";NOM$(PG);" n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
IF ERL=1065 THEN PRINT "Le Fichier "+LEFT$(S$,7)+" n'a pas ‚t‚ renomer en  "+LEFT$(O$,7):GOSUB 65000:RESUME 20010
IF ERL=1445 THEN PRINT "Fin du fichier Fusion  ou ERREUR ":GOSUB 65000:RESUME 20010
IF ERL=5120 THEN PRINT "ERREUR Dans    Save  *.BAT":RESUME 5140
IF ERL=5140 THEN PRINT "ERREUR SYSTEM                    ";ERL;"  ";ERR:GOSUB 65000:RESUME 10001
IF ERL=1067 THEN PRINT "IMPOSSIBLE d'executer SHELL ou COMMAND.COM Non Trouvez <Esc> aide ":GOSUB 65000:GOTO 20010
IF ERL=1530 THEN PRINT " Le fichier n'a pas ete trouve Ou Erreur DISK ":GOSUB 65000:RESUME 1531
IF ERL>65165 AND ERL<65100 THEN PRINT "Erreur survenue pendant la recherche":GOSUB 65000:RESUME 10000

60060 IF ERL=-376 THEN LOCATE 4,4:PRINT "ERREUR ":PRINT ERL:PRINT ERR:GOSUB 49000:RESUME 10000
60080 LOCATE 2,2:PRINT "ERREURE ";ERL;"   ERR ";ERR;"  A= ";A
61060 GOSUB 40:COLOR A11,A0:B1=3
61070 A=5:B=20:X1=16:X3=1
61080 COLOR A10:LOCATE 6,22:PRINT "THOLL ver 1.00"
GOSUB 65020:GOSUB 49000
LOCATE 1,1:PRINT " ************** Relance ************ SäRGä "
RESET : RUN
END

65000 LOCATE 18,5:COLOR A12,A3:PRINT "<";:COLOR A1:PRINT "Esc";:COLOR A12:PRINT ">";:COLOR A0:PRINT "Si une erreur est survenue ou tapez sur une autre touche"
X$=INKEY$:IF X$="" THEN 65000
IF X$=E27$ THEN 65020
RESUME 10001
$SEGMENT
65020 R$=""
IF ERR=0 THEN R$="Erreure non trouver ou erreur in‚xistante  ("+TIME$+") /ERR0"
IF ERR=3 THEN R$="Return sans Gosub / Erreur de Prog "
IF ERR=5 THEN R$="Un paramŠtre ill‚gal est tranmis … une fonction Num ou Alpha "
IF ERR=7 THEN R$="Manque de place dans la Memoire -> commande Impossible"
IF ERR=9 THEN R$="Indice sortant du cadre autoris‚ "
IF ERR=10 THEN R$="Deux d‚claration DIM sont donn‚es pour la mˆme matrice"
IF ERR=11 THEN R$="Division par Z‚ro "
IF ERR=14 THEN R$="Plus de place disponible pour les Chaines [M‚moire] "
IF ERR=24 THEN R$="Le p‚riph‚rique ne repond plus,Verifiez si le p‚riph‚rique est bien Pr‚sent"
IF ERR=25 THEN R$="Erreur sur unitŠ , Un peripherique Šmet un signal d'erreur"
IF ERR=27 THEN R$="Pas de papier dans l'imprimante ou imprimante hors tension"
IF ERR=50 THEN R$="D‚passement de capacit‚ "
IF ERR=53 THEN R$="Un fichier est introuvable sur disque ou diskette"
IF ERR=55 THEN R$="Tentative d'ouvrir une seconde fois un fichier dˆja ouvert"
IF ERR=57 THEN R$="Erreur provenant du materiel au moment d'une commande sur unit‚"
IF ERR=61 THEN R$="Votre diskette ou votre disque dur est plein"
IF ERR=62 THEN R$="Donn‚e ‚puis‚e dans le fichier lu ,EOF, Le fichier est fini "
IF ERR=64 THEN R$="Utilisation d'un caractere ‚rron‚ dans l'‚criture d'un NOM"
IF ERR=67 THEN R$="Il n'y a plus assez de place dans le catalogue de la diskette ou du disque dur"
IF ERR=68 THEN R$="UnitŠ non disponible  ( Periph‚rique absent ) "
IF ERR=70 THEN R$="Impossible d'‚crire sur le disque qui est prot‚g‚ en ‚criture"
IF ERR=71 THEN R$="Pas de diskette dans le lecteur,le clapet du lecteur n'est pas ferm‚"
IF ERR=72 THEN R$="Erreur sur la diskette ou le disque dur,d‚faut m‚canique "
IF ERR=75 THEN R$="Erreur lors de l'acces … un fichier avec OPEN"
IF ERR=76 THEN R$="La piste indiqu‚e pour un acc‚s de fichier n'est pas correcte"
65099 A=10:B=2:X1=74:X3=4:GOSUB 6000:LOCATE 11,7:COLOR A0:PRINT R$:LOCATE 12,7:PRINT "Num‚roe de L'ERL= ";ERL;"  : Num‚roe de ERR= ";ERR;" FRE -> ";FRE("")
IF ERDEV$="" THEN LOCATE 13,25:PRINT "* Non Identifier *LIG =";LIG;" V= ";V
LOCATE 13,7:PRINT "P‚riph‚rique ->";ERDEV$
GOSUB 49000
RETURN

65100 I=-1:A=0:FOIS=0:UXU$="NO":TIAW=0:
65110 I=I+1:W$=LEFT$(WK$(I,PG),80)
K=LEN(MOT$):LOCATE 2,14:COLOR A12,A0:PRINT " ligne ";I;" "
IF I=LIG THEN SOUND 400,1:SOUND 800,1:SOUND 400,1:LOCATE 5,1:COLOR A8,A7:PRINT "Fin de la Recherche":GOSUB 49000:GOSUB 20011:GOTO 610
PP=LEN(W$)
FOR P=1 TO PP:FF$=LEFT$(W$,P):FF2$=RIGHT$(FF$,K)
IO=I:PO=P
65125 IF FF2$=MOT$ THEN FOIS=FOIS+1:LOCATE 4,29:PRINT " Trouver ";FOIS:GOTO 65150
NEXT P
65135 X$=INKEY$:IF X$="" THEN 65110
IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 65110
65150 A=A+1:B=LEN(W$):GF=LEN(FF$):GF=GF-K
PIP$=LEFT$(W$,GF)
SP=B-K-GF:MARGO$=RIGHT$(W$,SP)
I$=STR$(I):LOCATE 5+A,1:COLOR 28,12:PRINT I$+"";:COLOR 16:PRINT ">";:COLOR A7,A0:PRINT PIP$;:COLOR A8,A9:PRINT MOT$;:COLOR A7,A0:PRINT MARGO$
SOUND 1600,.1:I=IO:P=PO:FF2$=""
65163 IF A=16 THEN TIAW=0:GOSUB 65170
65164 IF A=16 THEN FOR FI=1 TO 17:LOCATE 5+FI,1:PRINT SPACE$(80):NEXT FI:A=1
65165 GOTO 65125
65170 TIAW=TIAW+1:IF TIAW=10000 THEN UXU$="OUI":TIAW=0:GOTO 65164
65172 IF INKEY$="" THEN 65170
65173 UXU$="OUI":GOTO 65164
65180 X$=INKEY$:IF X$="" THEN 65180
IF X$=E27$ THEN GOSUB 20011:GOTO 610
K=0:FOR I=0 TO K800 STEP 50:K=K+1:K$=STR$(K):WK$(I,PG)="<ÍÍÍÍ Page "+K$+" Í Nom -> ........ù... "+STRING$(36,205)+" >":NEXT I:GOTO 20010
DISK:
GOSUB 20011:A=8:B=10:X1=65:X3=1:GOSUB 6010:COLOR CLT
65190 VA$="Lecteur >":GOSUB 2000
65192 IF PASSE$="OUI" THEN 65195 ELSE GOSUB 20011:GOTO 610
65195 LECTEUR$=N$:GOSUB 20011
IF LECTEUR$="X" THEN ERASE PCTOOLS%:DIM PCTOOLS%(1000):CLOSE:GOTO 65200
GOSUB 20011
A$="DIR "+LECTEUR$+" /S /B /O:N >>"+LECTEUR$+"DISK.THL":B$="DIR "+LECTEUR$+" /A:H /S /B /O:N >"+LECTEUR$+"DISK.THL"
65199 LOCATE 22,1:SHELL B$:SHELL A$:
65200 AXX=0:CLOSE:A$=LECTEUR$+"DISK.THL":OPEN A$ FOR INPUT AS #1
ERASE DX$,PCTOOLS%:DIM DX$(2000),PCTOOLS%(1000):A=10:B=10:X1=55:X3=3:GOSUB 6010:LOCATE 10,15:COLOR A14,A1:PRINT " Fichier lister "
FOR I=1 TO 2000
65205 INPUT #1,DX$(I)
65206 IF NOT LECTEUR$="" THEN OPEN DX$(I) FOR INPUT AS #2
IF NOT LECTEUR$="" THEN X=LOF(2):AXX=AXX+X:CLOSE #2:COLOR CLT,A7:LOCATE 11,12:PRINT "Chargement et Analyse >";:COLOR A12,A7:PRINT USING "######## ";X;:COLOR A0,A7:PRINT "oct       "
IF NOT LECTEUR$="" THEN LOCATE 12,11:PRINT SPACE$(X1):COLOR CLT,A7:LOCATE 12,12:PRINT DX$(I)
COLOR CLT,A7
IF NOT LECTEUR$="" THEN LOCATE 13,11:PRINT " Nombre de Fichier Lister ";:COLOR A1,A7:PRINT I;"  "
65207 NEXT I
65210 NB1=I-1:A=4:B=10:X1=60:X3=15:GOSUB 6000
65215 JK=1
65216 COLOR CLT,A3:LOCATE 5,18:PRINT " Nombre de Fichier ";NB1;" pour ";AXX
FOR T=0 TO 5:LOCATE 7+T,12:PRINT SPACE$(59)
IF PCTOOLS%(T+JK)=1 THEN LOCATE 7+T,13:PRINT CHR$(251)
LOCATE 7+T,15:PRINT DX$(T+JK)
NEXT T
LOCATE 14,15:PRINT "(A)ppeler   (C)opier   (E)ffacer    (R)un   "
LOCATE 15,15:PRINT "(S)hell     (L)ecteur  (T)ype"
LOCATE 18,18:PRINT " .......... -->                     ":COLOR A15,A4
LOCATE 7,12:PRINT SPACE$(58):LOCATE 7,15:PRINT DX$(JK)
IF PCTOOLS%(JK)=1 THEN COLOR 28:LOCATE 7,13:PRINT CHR$(251)
65220 X$=INKEY$:IF X$="" THEN 65220
IF X$=RZ$+"H" OR X$="8" THEN JK=JK-1:IF JK=0 THEN JK=1
IF X$=RZ$+"P" OR X$="2" THEN JK=JK+1:IF JK=NB1+1 THEN JK=NB1
IF X$=RZ$+"P" OR X$="2" OR X$=RZ$+"H" OR X$="8" THEN 65216
IF X$=E27$ THEN 20010
IF X$="A" OR X$="a" THEN NOM$(PG)=DX$(JK):CLOSE:GOTO 1315
IF X$="E" OR X$="e" THEN COLOR 16,7:LOCATE 6,14:PRINT " EFFACEMENT "+DX$(JK):GOSUB 1120:KILL DX$(JK):GOSUB 20011:DX$(JK)="":GOTO DISK
IF X$="C" OR X$="c" THEN C1
IF X$="R" OR X$="r" THEN R1
IF X$="S" OR X$="s" THEN S1
IF X$="T" OR X$="t" THEN D$="TYPE "+DX$(JK):GOSUB 1120:GOSUB SORTIE:SHELL D$:GOSUB 49000:GOTO 10001
IF X$="L" OR X$="l" THEN GOSUB 20011:GOTO D4
IF X$=E13$ AND NOT PCTOOLS%(JK)=1 THEN SOUND 800,.1:PCTOOLS%(JK)=1:GOTO 65216
IF X$=E13$ AND NOT PCTOOLS%(JK)=0 THEN SOUND 1600,.1:PCTOOLS%(JK)=0:GOTO 65216
GOTO 65216
C1:
A=17:B=17:X1=27:VA$=" Lecteur cible >":GOSUB 2000
IF PASSE$="OUI" THEN SOUND 1600,1 ELSE 65216
CIBLE$=N$:IF NOT CIBLE$="" THEN CPY
GOTO 65216
R1:
A=17:B=14:X1=45:VA$=" Parametres    >":GOSUB 2000
IF PASSE$="OUI" THEN SOUND 1600,1 ELSE 65216
PARA$=N$:D$=DX$(JK)+" "+PARA$:GOSUB 1120:GOSUB SORTIE:RUN D$:GOSUB 49000:GOTO 10001
GOTO 65216
S1:
A=17:B=14:X1=45:VA$=" Parametres    >":GOSUB 2000
IF PASSE$="OUI" THEN SOUND 1600,1 ELSE 65216
PARA$=N$:D$=DX$(JK)+" "+PARA$:GOSUB 1120:GOSUB SORTIE:SHELL D$:GOSUB 49000
GOTO 10001
CPY:
FOR I=1 TO NB1:SOUND 1600,.1:A$=""
IF PCTOOLS%(I)=1 THEN A$="COPY "+DX$(I)+" "+CIBLE$+" /V":COLOR A15,A3:LOCATE 13,20:PRINT "COPIE ";:COLOR A12:PRINT DX$(I)+"";:COLOR A15:PRINT " sur ";:COLOR A12:PRINT CIBLE$+"";:COLOR A15:PRINT " ":LOCATE 22,1:SHELL A$
NEXT I
LOCATE 13,22:PRINT SPACE$(40)
GOTO 65216
SORTIE:
COLOR A3,A0:CLS:COLOR A15,A4:LOCATE 1,1:PRINT SPACE$(80):LOCATE 1,1:PRINT " THOLL ‚x‚cution et Lancement                                      SERGE TS ":COLOR A1,A0:PRINT STRING$(80,"Í")
RETURN
