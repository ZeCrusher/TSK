$STACK 32766

$DYNAMIC

ON ERROR GOTO 60000
OPTION BASE 0

RZ$=CHR$(0):E13$=CHR$(13):E27$=CHR$(27):PG=0:DIM VXX$(30):OM0=0:OM8=8:PG=1:DDB0=1:FDBK=1:DDB1=1:FDB1=1:DDB2=1:FDB2=1
2 SCEN=0:REPA=0:STG$=STRING$(80,254):S=&HB800:S=S+65535:DEF SEG=S
DEFINT B,C,D,E,F,G,H,J,I,L,P,Q,R,S,T,U,V,Y,Z
FOR I=1 TO 25:FOR U=1 TO 80:VXX$(I)=VXX$(I)+CHR$(SCREEN(I,U)):NEXT U:NEXT I
ET=0:ED1=219:ED0=223:ED2=219:ED6=221:ED7=222:ED4=219:ED3=219:ED10=220:IC18=8:IC2=222:IC78=8:IC220=220:IC223=223:IC221=221:IC38=8:IC98=8
K800=700:RFT=1

EB=15:FB=4:EM=8:FM=3:EI=8:FI=7:EE=15:FE=1:ET=0:ES=15:FS=1

KEY 1,"ECHO ":KEY 2,"GOTO ":KEY 3,"FOR ":KEY 4,"IF ":KEY 5,"PAUSE ":KEY 6,"REM ":KEY 7,"SHIFT ":KEY 8,CHR$(34)+"%1"+CHR$(34):KEY 9,"CLS ":KEY 10,"EXIST "
DIM K$(20):E8$=CHR$(8):PG=0
C$=COMMAND$
IF C$="/M" OR C$="/m" OR C$="MEM" OR C$="mem" OR C$="/MEM" OR C$="/mem" THEN COLOR 14,1:PRINT "T-S THOLL":COLOR 3,0:PRINT " Memoire Restante ";:COLOR 12:PRINT USING " ######.## Ko ";(FRE(-1)/1024):SHELL:C$=""
5 IF NOT C$="" THEN GOSUB 40:GOTO 40000
10 IF K800<40 THEN K800=40
DIM CLR(35)
20 WIDTH 80:COLOR A7,A0:CLS:SCREEN SCEN
30 GOSUB 35:GOTO 45
35 CLOSE:OPEN "COULEUR.THL" FOR INPUT AS #1:LINE INPUT #1,X$:GOSUB 4113:FOR I=0 TO 31:INPUT #1,CLR(I):NEXT I:INPUT #1,OM0:INPUT #1,OM8:GOSUB 36:RETURN
36 A0=CLR(0):A1=CLR(1):A2=CLR(2):A3=CLR(3):A4=CLR(4):A5=CLR(5):A6=CLR(6):A7=CLR(7):A8=CLR(8):A9=CLR(9):A10=CLR(10):A11=CLR(11):A12=CLR(12):A13=CLR(13):A14=CLR(14):A15=CLR(15):A16=CLR(16):A17=CLR(17)
A18=CLR(18):A19=CLR(19):A20=CLR(20):A21=CLR(21):A22=CLR(22):A23=CLR(23):A24=CLR(24):A25=CLR(25):A26=CLR(26):A27=CLR(27):A28=CLR(28):A29=CLR(29):A30=CLR(30):A31=CLR(31)
CLOSE
RETURN
$SEGMENT
40 A0=0:A1=1:A2=2:A3=3:A4=4:A5=5:A6=6:A7=7:A8=8:A9=9:A10=10:A11=11:A12=12:A13=13:A14=14:A15=15:A16=16:A17=17:A18=18:A19=19:A20=20:A21=21:A22=22
A23=23:A24=24:A25=25:A26=26:A27=27:A28=28:A29=29:A30=30:A31=31:ET=0:RETURN
45 CLOSE:OPEN "THCONFIG." FOR INPUT AS #2:INPUT #2,XX:INPUT #2,YY:INPUT #2,ET
50 color 7,A0:CLS:CLOSE
51 WIDTH 80:SCREEN SCEN:GOTO 300
300 COLOR XX,0:LOCATE 1,1:FOR I=1 TO 24:PRINT STRING$(80,177);:NEXT I
IF XX=0 THEN XX=3
305 COLOR A8,XX:LOCATE 2,2:PRINT CHR$(219)+STRING$(76,"ß")+CHR$(219)

307 FOR I=1 TO 17:LOCATE 2+I,2:PRINT CHR$(221)+SPACE$(76)+CHR$(222):NEXT I
308 LOCATE 19,2:PRINT CHR$(219)+STRING$(76,220)+CHR$(219)
310 COLOR A1,3:LOCATE 6,6:PRINT SPACE$(11):LOCATE 5,5:PRINT STRING$(27,219):LOCATE 6,22:PRINT SPACE$(11)
312 FOR I=1 TO 9:LOCATE 5+I,16:PRINT STRING$(6,219);:PRINT " ":NEXT I
LOCATE 15,17:PRINT "      "
314 COLOR YY,3:FOR I=1 TO 8:LOCATE 4+I,32:PRINT "Û";:LOCATE 5+I,33:PRINT " ":NEXT I
LOCATE 9,32:PRINT STRING$(6,219)
FOR I=1 TO 9:LOCATE 4+I,38:PRINT "Û";:LOCATE 5+I,39:PRINT " ":NEXT I:LOCATE 10,33:PRINT "     "
FOR I=1 TO 7:LOCATE 4+I,42:PRINT "Û";:LOCATE 5+I,43:PRINT " ":LOCATE 4+I,49:PRINT "Û";:LOCATE 5+I,50:PRINT " ":NEXT I
LOCATE 5,42:PRINT STRING$(7,219):LOCATE 6,43:PRINT "      "::LOCATE 11,42:PRINT STRING$(7,219):LOCATE 12,43:PRINT "       "
FOR I=1 TO 8:LOCATE 4+I,54:PRINT "Û";:LOCATE 5+I,55:PRINT " ":NEXT I:LOCATE 11,54:PRINT STRING$(7,219):LOCATE 12,55:PRINT "       "
FOR I=1 TO 9:LOCATE 4+I,63:PRINT "Û";:LOCATE 5+I,64:PRINT " ":NEXT I:LOCATE 13,63:PRINT STRING$(9,219):LOCATE 14,64:PRINT "         "
COLOR A0,YY:CD$=" TS     Programme  THOLL ver 1.00                            par TSAKI-SERGE [1991-1992]                Edition de Fichier Texte sequentiel BATCH                               TSAKI. SäRGä [ M-G ] "
B=LEN(CD$):Z=1:A=60
380 A=A+Z:IF A=B THEN Z=-1
IF A=60 THEN Z=1
X1$=LEFT$(CD$,A):X2$=RIGHT$(X1$,60):DELAY 0.05
COLOR A12,A0:LOCATE 23,10,0:PRINT "<";:COLOR A3:PRINT X2$;:COLOR A12:PRINT ">"
390 IF INKEY$="" THEN 380
GOTO 10000
500 COLOR A16,A7:LOCATE 1,8:PRINT "Esc":SYST$="NON":IF KN=0 THEN KN=1
$INCLUDE "MENUKN01.BAS"
510 X$=INKEY$:IF X$="" THEN 510
X=0:A=0:Y=0
520 IF X$=RZ$+"K" OR X$="4" THEN KN=KN-1:IF KN=0 THEN KN=7
530 IF X$=RZ$+"M" OR X$="6" THEN KN=KN+1:IF KN=8 THEN KN=1
IF X$="N" THEN KN=1:X$=E13$
IF X$="F" THEN KN=2:X$=E13$
IF X$="T" THEN KN=3:X$=E13$
IF X$="O" THEN KN=4:X$=E13$
IF X$="E" THEN KN=5:X$=E13$
IF X$="I" THEN KN=6:X$=E13$
IF X$="C" THEN KN=7:X$=E13$
531 LOCATE 1,12:GOSUB 10022
532 IF X$=E27$ THEN COLOR A10,A0:LOCATE 1,8,0:PRINT "Esc":GOTO 10120
540 COLOR A15,A12
IF X$=E13$ OR X$="2" OR X$=RZ$+"P" THEN COLOR A10,A0:LOCATE 1,8:PRINT "Esc":GOTO 610
IF KN=0 THEN KN=1
IF KN=1 THEN LOCATE 1,12:PRINT " Nom F. "
542 IF KN=2 THEN LOCATE 1,20:PRINT " Fichier "
543 IF KN=3 THEN LOCATE 1,29:PRINT " Texte "
544 IF KN=4 THEN LOCATE 1,36:PRINT " Options "
546 IF KN=5 THEN LOCATE 1,45:PRINT " Execut "
547 IF KN=6 THEN LOCATE 1,53:PRINT " Imprime "
548 IF KN=7 THEN LOCATE 1,62:PRINT " Copier "
600 GOTO 500
610 J=1:IF KN=1 THEN 6100
612 IF KN=2 THEN 1000
613 IF KN=3 THEN 3000
614 IF KN=4 THEN 8200
615 IF KN=5 THEN 5000
616 IF KN=6 THEN 800
617 IF KN=7 THEN 6600
620 IF KN=0 THEN 10000
END
800 A=4:B=44:X1=30:X3=3:GOSUB 6000:J=1
$INCLUDE "MNIMPRIM.BAS"
END

J2A:
VA$="Debut Ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 943 ELSE 20011:GOTO 610
943 DEB=VAL(N$):IF DEB>K800 OR DEB<0 THEN GOSUB 20011:GOTO 610
GOTO 940
J2B:
VA$="Fin ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 944 ELSE 20011:GOTO 610
944 FIN=VAL(N$):IF FIN>K800 OR FIN<0 THEN GOSUB 20011:GOTO 610
GOTO 942
$SEGMENT
1000 A=4:B=5:X1=20:X3=10:GOSUB 6000:J=1:A=2
AI$="Permet de sauvegarder votre travail sur le disque ":GOSUB 2100
1003 CLOSE
$INCLUDE "MNSAVE"
END

1064 A=6:B=3:X1=65:X3=1:GOSUB 6010
VA$="Nom Fichier source >":GOSUB 2000
IF PASSE$="OUI" THEN B1064 ELSE 20011:GOTO 610

B1064:
S$=N$:IF S$="" THEN GOSUB 20011:GOTO 610
A=11:B=3:X1=65:X3=1:GOSUB 6010
VA$="Nouveau Nom object > ":GOSUB 2000
IF PASSE$="OUI" THEN B1065 ELSE 20011:GOTO 610
B1065:
O$=N$:IF O$="" THEN GOSUB 20011:GOTO 610
GOSUB 1120
1065 NAME S$ AS O$
GOSUB 20010:GOTO 610
1070 CLOSE:OPEN NOM$(PG) FOR INPUT AS #1
GOSUB 20011:A=10:B=35:X1=9:X3=2:GOSUB 6000:O=0:KO=0:OK=0:K=0
FOR I=1 TO K800
1072 LINE INPUT #1,WK$(I,PG):B=LEN(WK$(I,PG)):K=K+B:KO=K/1024:O=FRE(0):OK=O/1024
COLOR ET,FM:LOCATE 11,37:PRINT USING "##.# Ko";KO
IF O<4096 THEN COLOR 28,FM
IF O<2048 THEN 1073
LOCATE 12,37:PRINT USING "##.# Ko";OK
NEXT I
1073 CLOSE
GOTO 10001
1100 A=6:B=3:X1=65:X3=1:GOSUB 6010
1105 '
1107 '
1110 VA$="Sauver > ":GOSUB 2000
IF PASSE$="OUI" THEN 1112 ELSE GOSUB 20011:GOTO 610
1112 NM$=N$:IF NM$="" THEN GOSUB 20011:GOTO 610
IF INSTR(NM$,".")=0 THEN NM$=NM$+".Bat"
NOM$(PG)=NM$
1115 GOSUB 1120:GOTO 1199
1120 A=12:B=12:X1=20:X3=5:GOSUB 6000
LOCATE A+1,B+2:COLOR ET:PRINT "Tapez <Entrer>   "
LOCATE A+2,B+2:PRINT "une Fois pres .."
1135 LOCATE A+4,B+1:PRINT "   Ou Tapez <Esc>  "
1150 X$=INKEY$:IF X$="" THEN 1150
IF X$=E27$ AND AXXX$="OUI" THEN AXXX$="":GOTO 10001
IF X$=E27$ THEN AXXX$="":GOTO 20010
IF X$=E13$ THEN RETURN
GOTO 1120
1199 GOSUB 6530
1200 CLOSE:IF X$="O" OR X$="o" THEN OPEN NOM$(PG) FOR OUTPUT AS #1
IF X$="F" OR X$="f" THEN OPEN NOM$(PG) FOR APPEND AS #1
LOCATE 22,1:COLOR A7,A0:PRINT SPACE$(80):GOSUB 20011
A=14:B=3:X1=60:X3=2:GOSUB 6000:COLOR ET,FM
K=0:FOR I=RFT TO LIG
1210 PRINT #1,WK$(I,PG):B=LEN(WK$(I,PG)):K=K+B:KO=K/1024:K=INT(K)
1211 LOCATE 15,4:PRINT "Caractere Ecrit -->";:COLOR A14:PRINT USING "#######";K
1212 COLOR ET,FM:LOCATE 15,46:PRINT "Ligne ";I:LOCATE 16,10:PRINT USING "##.## Ko ecrit sur le disque ";KO
NEXT I
1220 CLOSE:GOTO 10001
1300 A=7:B=3:X1=65:X3=1:GOSUB 6000
1305 OBLIGER$="OUI"
1310 COLOR ET,FM:LOCATE 8,5:PRINT "Chargement >";NOM$(PG)
1311 X$=INKEY$:IF X$="" THEN 1311
IF X$=E13$ THEN 1315
A=7:B=3:X1=65:X3=1:GOSUB 6010
VA$="Chargement >":GOSUB 2000
IF PASSE$="OUI" THEN 1314 ELSE GOSUB 20011:GOTO 610
1314 IF N$="" THEN GOSUB 20011:GOTO 610
IF INSTR(N$,".")=0 THEN N$=N$+".Bat"
NOM$(PG)=N$
1315 GOSUB 1120
1320 FOR I=1 TO K800:WK$(I,PG)="":NEXT I
IF RAPIDE$="OUI" THEN 1070
GOSUB 20011
1321 A=7:B=20:X1=50:X3=11:GOSUB 6000
LOCATE 9,22:COLOR ET:PRINT "Nombre d'Octect(s)":E25=25:TOUR=0:TOUR2=0
LOCATE 10,22:PRINT "Nombre de Caractere(s) Totale ":N$=""
LOCATE 11,22:PRINT "Nombre de Ligne(s)            "
LOCATE 12,22:PRINT "Caractere(s) dans la ligne  "
LOCATE 13,22:PRINT "Memoire restante ":CLOSE
1330 CLOSE:COLOR ET,FM:OPEN NOM$(PG) FOR INPUT AS #2:X=LOF(2)
LOCATE 9,60:PRINT X:MIMEX=TIMER
1340 FOR I=1 TO K800
1345 LINE INPUT #2,WK$(I,PG)
BH=LEN(WK$(I,PG)):AA=BH+AA
COLOR ET,FM:LOCATE 10,60:PRINT AA
LOCATE 11,60:PRINT I
LOCATE 12,60:PRINT BH
LOCATE 13,60:PRINT FRE(0)
TOUR=TOUR+1:IF TOUR=E25 THEN N$=N$+"þ":LOCATE 14,22:PRINT "Matrice ";N$:TOUR=0:TOUR2=TOUR2+1:IF TOUR2=10 THEN E25=70
LOCATE 15,B+2:PRINT "Positionnement  ->";LOC(2)
LOCATE 16,B+2:PRINT "Nom > ";NOM$(PG):KO#=AA/1024
LOCATE 17,B+2:PRINT "Nombre de Ko "
LOCATE 17,57:PRINT USING "###.### Ko";KO#
LOCATE 18,B+2:PRINT "Memoire RAM restante en Ko
LOCATE 18,57:PRINT USING "####.## Ko ";(FRE(-1)/1024)
LOCATE 8,B+2:PRINT "Temps couler en seconde "
COLOR A12,FM:LOCATE 8,57:MIM=TIMER-MIMEX:PRINT USING "###.## Sec";MIM
1350 NEXT I
1360 CLOSE:GOSUB 20011:GOTO 610
1400 A=7:B=3:X1=65:X3=1:GOSUB 6010:J=1:COLOR ET,A7
VA$="Fusion >":GOSUB 2000
IF PASSE$="OUI" THEN 1413 ELSE GOSUB 20011:GOTO 610
1413 KNOM$=N$
1414 IF KNOM$="" THEN GOSUB 20011:GOTO 610
IF INSTR(KNOM$,".")=0 THEN KNOM$=KNOM$+".Bat":
1415 GOSUB 1120:A=13:B=20:X3=6:X1=50:GOSUB 6000:COLOR ET,FM
LOCATE 14,22:PRINT "Nombres d'Octect(s) dans Fusion":AI$="Charge et Analise ":GOSUB 2100
LOCATE 15,22:PRINT "Nombres de Caractere(s) Totale"
LOCATE 16,22:PRINT "Nombres de Ligne(s)           "
LOCATE 17,22:PRINT "Caractere(s) dans la ligne  "
LOCATE 18,22:PRINT "Mmoire rstante            ":I=0:A=0
LOCATE 19,22:PRINT "Mmoire RAM                 "
1430 CLOSE:COLOR ET,FM:OPEN KNOM$ FOR INPUT AS #2:X=LOF(2)
LOCATE 14,60:PRINT X
1440 A=0:FOR I=LIG TO K800
1445 LINE INPUT #2,WK$(I,PG):BH=LEN(WK$(I,PG)):AA=BH+AA
LOCATE 15,60:PRINT AA:LOCATE 16,60:PRINT I:LOCATE 17,60:PRINT BH
COLOR A12,FM:LOCATE 18,60:PRINT FRE(0):LOCATE 19,60:PRINT FRE(-1)
COLOR ET,FM:NEXT I
1460 GOSUB 20011:GOTO 610
1500 A=10:B=5:X1=65:X3=1:GOSUB 6010:COLOR ET,FI
VA$="Effacement >":GOSUB 2000
IF PASSE$="OUI" THEN 1515 ELSE GOSUB 20011:GOTO 610
1515 EFFMG$=N$:IF EFFMG$="" THEN GOSUB 20011:GOTO 610
GOSUB 1120
1530 KILL EFFMG$
1531 GOSUB 20010:GOTO 610
2000 N$="":TR=0:GOSUB 2014:PASSE$="NON"
2012 X$=INPUT$(1):TR=TR+1
IF X$=E8$ OR X$=RZ$+"K" THEN BB=LEN(N$):N$=LEFT$(N$,(BB-1)):GOSUB 2014:GOTO 2012
IF X$=E27$ THEN GOSUB 20011:OBLIGER$="":GOTO 610
IF X$=E13$ THEN PASSE$="OUI":OBLIGER$="":RETURN
IF OBLIGER$="OUI" THEN X1=X1-4:OBLIGER$=""
KREL=LEN(VA$):KERNEL=KREL+1
2013 N$=N$+X$:IF TR>(X1-KERNEL) THEN N$=LEFT$(N$,(X1-KERNEL)):TR=X1-KERNEL
GOSUB 2014:GOTO 2012
2014 COLOR A1,A7:LOCATE A+1,B+1:PRINT SPACE$(X1):COLOR A1:LOCATE A+1,B+2:PRINT VA$+"";:COLOR ET:PRINT N$
RETURN
$SEGMENT
2100 COLOR EE,FE:LOCATE 23,1:PRINT SPACE$(80);
LOCATE 24,1:COLOR ET,FM:PRINT SPACE$(80);
LOCATE 24,3:PRINT AI$;
RETURN
3000 A=4:B=22:X3=14:X1=19:GOSUB 6000:J=1
$INCLUDE "MNTEXTE"

3070 A=7:B=11:X1=33:X3=6:GOSUB 6000:J=1
$INCLUDE "MNTPATH.BAS"
GOTO 3070

3076 GOSUB 20011
IF PG=0 THEN DDBK=DDB0:FDBK=FDB0
IF PG=1 THEN DDBK=DDB1:FDBK=FDB1
IF PG=2 THEN DDBK=DDB2:FDBK=FDB2
FOR I=DDBK TO FDBK:A=LEN(WK$(I,PG))
FOR M=1 TO A
X$=LEFT$(WK$(I,PG),1):IF X$=" " THEN WK$(I,PG)=RIGHT$(WK$(I,PG),A-1):A=A-1
IF NOT X$=" " THEN MARGO0
NEXT M
MARGO0:
IF PG=0 THEN DDBK=DDB0:FDBK=FDB0
IF PG=1 THEN DDBK=DDB1:FDBK=FDB1
IF PG=2 THEN DDBK=DDB2:FDBK=FDB2

X=0:X$="":B=0:FOR R=DDBK TO FDBK:B=LEN(WK$(I,PG)):X=B+1
FOR VANE=1 TO B:X=X-1:X$=RIGHT$(WK$(I,PG),1)
IF X$=" "  THEN WK$(I,PG)=LEFT$(WK$(I,PG),X)
IF NOT X$=" " THEN MARGO1
NEXT VANE:NEXT R
MARGO1:
IF A<80 THEN B=80-A:B=INT(B/2):WK$(I,PG)=SPACE$(B)+WK$(I,PG)
NEXT I
GOSUB 20011
GOTO 3070
3077 IF PG=0 THEN DDBK=DDB0:FDBK=FDB0
IF PG=1 THEN DDBK=DDB1:FDBK=FDB1
IF PG=2 THEN DDBK=DDB2:FDBK=FDB2

FOR I=DDBK TO FDBK:A=LEN(WK$(I,PG))
FOR M=1 TO A:X$=LEFT$(WK$(I,PG),1)
IF X$=" " THEN WK$(I,PG)=RIGHT$(WK$(I,PG),A-1):A=A-1
IF NOT X$=" " THEN MARGO3
NEXT M
MARGO3:
NEXT I:GOTO 3070

$SEGMENT
3080 A=6:B=49:X3=10:X1=9:GOSUB 6000
J=1:AI$="Aide sur les fonctions de base d'un fichier BATCH":GOSUB 2100
K$(1)=" ECHO    ":K$(2)=" GOTO    ":K$(3)=" FOR     "
K$(4)=" IF      ":K$(5)=" PAUSE   ":K$(6)=" REM     "
K$(7)=" SHIFT   ":K$(8)=" "+CHR$(34)+"%1"+CHR$(34)+"    "
K$(9)=" CLS     ":K$(10)=" CALL    "
3081 COLOR ET,FM
FOR I=1 TO 10:LOCATE 6+I,50:PRINT K$(I):NEXT I
COLOR EB,FB:LOCATE 6+J,50:PRINT K$(J)
3082 X$=INKEY$:IF X$="" THEN 3082
IF X$=RZ$+"P" OR X$="2" THEN J=J+1:IF J=11 THEN J=1
IF X$=RZ$+"H" OR X$="8" THEN J=J-1:IF J=0 THEN J=10
IF X$=E27$ THEN 10001
IF NOT X$=E13$ THEN 3081
3085 IF J=1 THEN BL$=LVG$+"EC70.THL":BLOAD BL$
3086 IF J=2 THEN BL$=LVG$+"GO279.THL":BLOAD BL$
3087 IF J=3 THEN BL$=LVG$+"FO277.THL":BLOAD BL$
3088 IF J=4 THEN BL$=LVG$+"IF281.THL":BLOAD BL$
3089 IF J=5 THEN BL$=LVG$+"PA285.THL":BLOAD BL$
3090 IF J=6 THEN BL$=LVG$+"RE286.THL":BLOAD BL$
3091 IF J=7 THEN BL$=LVG$+"SH287.THL":BLOAD BL$
3092 IF J=8 THEN BL$=LVG$+"P1289.THL":BLOAD BL$
3093 IF J=9 THEN BL$=LVG$+"CL093.THL":BLOAD BL$
3094 IF J=10 THEN BL$=LVG$+"CA410.THL":BLOAD BL$
GOSUB 49000:GOTO 3080
3100 A=7:B=13:X1=50:X3=1:GOSUB 6010
3110 VA$="Mot  Chercher > ":GOSUB 2000
IF PASSE$="OUI" THEN 3112 ELSE 20011:GOTO 610
3112 MOT$=N$:IF MOT$="" THEN GOSUB 20011:GOTO 610
COLOR EE,FE:FOR I=1 TO 19:LOCATE 3+I,1:PRINT SPACE$(80):NEXT I
3125 COLOR A12,A4:LOCATE 4,1:PRINT "Recherche de ";:COLOR A3,A0:PRINT MOT$
I=1:COLOR A7,A0:LOCATE 5,3:PRINT "Ligne nø ";I;"  "
GOTO 65100
3200 A=16:B=5:X3=1:X1=65:GOSUB 6000
COLOR ET,FM:LOCATE 17,7:PRINT "Path = ";LVG$
3210 X$=INKEY$:IF X$="" THEN 3210
IF X$=E27$ THEN 20010
IF NOT X$=E13$ THEN 3210
A=16:B=5:X3=1:X1=65:GOSUB 6010
VA$="Path > ":GOSUB 2000
IF PASSE$="OUI" THEN 3998 ELSE 20011:GOTO 610
3998 LVG$=N$:GOTO 10001
4110 A=6:B=30:X3=10:X1=47:GOSUB 6000
4111 COLOR ET
A$=LEFT$(STG$,25)
LOCATE 7,32:PRINT " Barre en Cour ->";:COLOR A12:PRINT A$:COLOR ET
LOCATE 9,33:PRINT "( 1 ) 123456789012345678901234567890123456"
LOCATE 10,33:PRINT "( 2 ) ÞÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍØÍÍÍÍ"
LOCATE 11,33:PRINT "( 3 ) ";STRING$(37,254)
LOCATE 12,33:PRINT "( 4 ) ÃÄÄÄÂÄÄÄÄÂÄÄÄÂÄÄÄÄÂÄÄÄÂÄÄÄÄÂÄÄÄÄ"
FOR I=0 TO 2:LOCATE 13+I,33:PRINT "(   ";I+5;") Encadrement Menus nø ";I+1:NEXT I
LOCATE 13,35:PRINT E8$:LOCATE 14,35:PRINT CHR$(218):LOCATE 15,35:PRINT CHR$(201)
4112 X$=INKEY$:IF X$="" THEN 4112
IF X$="1" THEN STG$="12345678901234567890123456789012345678901234567890123456789012345678901234567890"
IF X$="2" THEN STG$="ÞÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÝ"
IF X$="3" THEN STG$=STRING$(80,254)
IF X$="4" THEN STG$="ÃÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄ´"
IF X$=E27$ OR X$=E13$ THEN GOSUB 20011:GOTO 610
GOSUB 4113:GOTO 4111
4113 IF X$="5" THEN IC18=8  :IC221=221:IC78=8  :IC223=223:IC98=8  :IC2=222:IC38=8:IC220=220
IF X$="6" THEN IC18=192:IC221=179:IC78=218:IC223=196:IC98=191:IC2=179:IC38=217:IC220=196
IF X$="7" THEN IC18=200:IC221=186:IC78=201:IC223=205:IC98=187:IC2=186:IC38=188:IC220=205
RETURN

DISK:
A=8:B=10:X1=13:X3=1:GOSUB 6010:COLOR ET
AI$="Tapez la lettre du lecteur suivie de "+CHR$(34)+":"+CHR$(34)+" [Exemple > C: ] ":GOSUB 2100
4500 VA$="Lecteur >":GOSUB 2000
4510 IF PASSE$="OUI" THEN 4515 ELSE GOSUB 20011:GOTO 610
4515 LECTEUR$=N$
4520 FOR I=1 TO 1600:KIDJOE$(I)="":NEXT I
4530 IF LECTEUR$="$" THEN LECTEUR$="":GOTO 4590
IF LECTEUR$="" THEN FS$="DIR /A:-D /B /S /O:N >DISK02F$.THL" ELSE FS$="DIR "+LECTEUR$+" /A:-D /B /S /O:N >DISK02F$.THL"
FOR I=1 TO 1600:KIDJOE$(I)="":NEXT I
AI$="Installation en cours du fichier temporaire sur disque ....":GOSUB 2100

4550 SHELL FS$
4590 CLOSE:OPEN "DISK02F$.THL" FOR INPUT AS #1
4600 FOR IRON=1 TO 1600:LINE INPUT #1,KIDJOE$(IRON):NEXT IRON
4605 IRON=IRON-1:CLOSE
4610 GOSUB 20011:A=5:B=2:X1=76:X3=16:GOSUB 6020:LOCATE 5,24:COLOR A15,A4:PRINT " FICHIER "
COLOR A15,A1:LOCATE 7,5:PRINT USING " ###### Fichier(s) ";IRON
COLOR A8,FM:LOCATE 8,6:PRINT STRING$(19,"ß"):LOCATE 7,24:PRINT "Ü"
GOSUB 4635:COLOR A8,FM:LOCATE 21,6:PRINT "ßßßßßßßß":LOCATE 20,13:PRINT "Ü"
LOCATE 21,16:PRINT "ßßßßßßßß":LOCATE 20,23:PRINT "Ü":LOCATE 21,26:PRINT "ßßßßßßßßßßßß":LOCATE 20,37:PRINT "Ü"
COLOR ES,FS:LOCATE 7,69:PRINT " A: ":LOCATE 9,69:PRINT " B: ":LOCATE 11,69:PRINT " C: ":LOCATE 13,69:PRINT " D: ":LOCATE 15,69:PRINT " E: "
FOR I=1 TO 10 STEP 2:COLOR A8,FM:LOCATE 7+I,70:PRINT "ßßßß"
LOCATE 6+I,73:PRINT "Ü"
NEXT I

AI$="Barre d'space pour acceder aux menus , Esc pour Fermer le menu choisi ":GOSUB 2100
A=9:B=4:X1=60:X3=9:GOSUB 6020:J=1:IO=0
4625 COLOR ET,FM:FOR I=1 TO 9:LOCATE 9+I,5:PRINT SPACE$(60):LOCATE 9+I,5:PRINT LEFT$(KIDJOE$(I+IO),58):NEXT I
LOCATE 9+J,5:COLOR EB,FB:PRINT SPACE$(60):LOCATE 9+J,5:COLOR EB,FB:PRINT LEFT$(KIDJOE$(J+IO),58)
4630 X$=INKEY$:IF X$="" THEN 4630
IF X$=RZ$+"H" OR X$="8" THEN J=J-1:IF J=0 THEN J=1:IO=IO-1:IF IO=-1 THEN IO=0
IF X$=RZ$+"P" OR X$="2" THEN J=J+1:IF J=10 THEN J=9:IO=IO+1:IF IO=IRON THEN IO=IRON
IF X$=E27$ THEN 20010
IF X$=" " THEN 4640
GOTO 4625
4635 COLOR ES,FS:LOCATE 20,5:PRINT " Editer ":LOCATE 20,15:PRINT " Lancer "
LOCATE 20,25:PRINT " Rechercher ":RETURN

4640 W=1
4645 GOSUB 4635:COLOR EB,FB:SOUND 1800,.1:SOUND 500,.1
IF W=1 THEN LOCATE 20,5:PRINT " EDITER "
IF W=2 THEN LOCATE 20,15:PRINT " LANCER "
IF W=3 THEN LOCATE 20,25:PRINT " RECHERCHER "
4650 X$=INKEY$:IF X$="" THEN 4650
IF X$=RZ$+"K" THEN W=W-1:IF W=0 THEN W=3
IF X$=RZ$+"M" THEN W=W+1:IF W=4 THEN W=1
4651 IF X$=E27$ THEN GOSUB 4635:GOTO 4625
IF NOT X$=E13$ THEN 4645
IF W=1 THEN A=14:B=5:X1=22:X3=3:GOSUB 6020:GOTO 4700
IF W=2 THEN 4800
IF W=3 THEN A=14:B=25:X1=30:X3=3:GOSUB 6020:'GOTO 4900
GOSUB 49000:GOSUB 4635:GOTO 4625

4700 U=1:AI$="Charge le fichier dans l'diteur / Visualise le fichier avant chargement":GOSUB 2100
K$(1)=" Editer charge Normal "
K$(2)=" Editer charge rapide "
K$(3)=" Visualiser Asc/Hex   "
4710 COLOR ET,FM:FOR I=1 TO 3:LOCATE 14+I,6:PRINT K$(I):NEXT I
COLOR EB,FB:LOCATE 14+U,6:PRINT K$(U)
4720 X$=INKEY$:IF X$="" THEN 4720
IF X$=RZ$+"H" THEN U=U-1:IF U=0 THEN U=3
IF X$=RZ$+"P" THEN U=U+1:IF U=4 THEN U=1
IF X$=E27$ THEN 4651
IF NOT X$=E13$ THEN 4710
IF U=1 THEN NOM$(PG)=KIDJOE$(J+IO):FOR I=1 TO K800:WK$(I,PG)="":NEXT I:GOTO 1321
IF U=2 THEN NOM$(PG)=KIDJOE$(J+IO):FOR I=1 TO K800:WK$(I,PG)="":NEXT I:RAPIDE$="OUI":GOTO 1070
IF U=3 THEN 4750
GOTO 4710

4750 A=10:B=5:X1=57:X3=7:GOSUB 6020:U=0:LOCATE 10,8:COLOR A15,A1:PRINT " Visualiser ";LEFT$(KIDJOE$(IO+J),20)+" "
AI$="Visualise un fichier, Taper sur <Esc> pour sortir":GOSUB 2100
4760 Y=0:O=0:CLOSE:OPEN KIDJOE$(J+IO) FOR INPUT AS #1
4770 X$=INPUT$(1,#1)
X=ASC(X$)
Y=Y+1:O=O+3:IF Y=12 AND O=36 THEN O=0:U=U+1:Y=0:IF U=7 THEN U=0:GOSUB 49000:A=10:B=5:X1=57:X3=7:GOSUB 6020:LOCATE 10,8:COLOR A15,A1:PRINT " Visualiser ";LEFT$(KIDJOE$(IO+J),20)+" ":GOTO 4770
COLOR ET,FM:IF X=32 THEN COLOR 12:X=249
IF X=13 THEN COLOR 15:X=219
IF X>64 AND X<91 THEN COLOR 0
IF X=27 THEN COLOR 1:X=27
IF X=12 OR X=11 OR X=30 THEN COLOR 16:X=219
IF X=7 THEN COLOR 1:X=219
LOCATE 11+U,8+Y:PRINT CHR$(X):X2=ASC(X$):LOCATE 11+U,26+O:PRINT HEX$(X2):LOCATE 18,10:COLOR A15,A1:PRINT " Ascii ":LOCATE 18,26:PRINT " Hexadecimal "
H$=INKEY$:IF H$="" THEN 4770
IF H$=E27$ THEN X$=E27$:GOTO 4651
GOTO 4770
4800 COLOR A7,A0:CLS:GOSUB V:LOCATE 1,1:COLOR ET,FM:PRINT SPACE$(80)
4810 CLOSE:OPEN KIDJOE$(J+IO) FOR INPUT AS #1
4820 CLOSE:LOCATE 1,1:PRINT "Lancement de ";KIDJOE$(J+IO)
4830 SHELL KIDJOE$(J+IO)
COLOR A7,A0
LOCATE 17,17:PRINT "Tapez sur une touche ........ ":GOSUB 49000
GOTO 10001
5000 A=4:B=47:X3=3:X1=24:GOSUB 6000
AI$="Excute le programme qui se trouve dans l'Editeur ":GOSUB 2100
K$(1)=" Excutions MS-DOS      "
K$(2)=" Parametres Programme   "
K$(3)=" Auto-Sauvegarde        "
5020 COLOR ET,FM:FOR I=1 TO 3:LOCATE 4+I,48:PRINT K$(I):NEXT I
COLOR EB,FB:LOCATE 4+J,48:PRINT K$(J):COLOR A3,A9
IF BAT$="" THEN BAT$="ON"
LOCATE 7,67:PRINT BAT$
5025 X$=INKEY$:IF X$="" THEN 5025
IF X$="4" OR X$=RZ$+"K" THEN KN=4:GOSUB 20011:GOTO 610
IF X$="6" OR X$=RZ$+"M" THEN KN=6:GOSUB 20011:GOTO 610
IF X$=RZ$+"H" OR X$="8" THEN J=J-1:IF J=0 THEN J=3
IF X$=RZ$+"P" OR X$="2" THEN J=J+1:IF J=4 THEN J=1
IF X$=E27$ THEN 20010
$INCLUDE "MENUKN05.BAS"
IF NOT X$=E13$ THEN 5020
IF J=1 THEN 5100
IF J=2 THEN X1=60:X3=1:A=15:B=5:GOSUB 6010:COLOR A14,A1:LOCATE 15,9:PRINT " Parametres de la ligne de commande ":GOTO EXE
IF J=3 AND BAT$="OFF" THEN BAT$="ON":GOTO 5020
IF J=3 AND BAT$="ON" THEN BAT$="OFF":GOTO 5020
5050 GOTO 5020
5052 GOTO 5100

$SEGMENT
EXE:
VA$=" >":GOSUB 2000
IF PASSE$="OUI" THEN 5080 ELSE 20011:GOTO 610
5080 P$=N$:IF P$="" THEN GOSUB 20011:GOTO 610 ELSE PA$=P$:GOSUB 20011:GOTO 610
GOSUB 20011:GOTO 5000
5100 COLOR 7,0:CLS:FOR I=1 TO 22:LOCATE I,1:PRINT VXX$(I):NEXT I
IF PG=0 THEN KOB=0:FOR I=DDB0 TO FDB0:KOB=KOB+LEN(WK$(I,PG)):NEXT I
IF PG=1 THEN KOB=0:FOR I=DDB1 TO FDB1:KOB=KOB+LEN(WK$(I,PG)):NEXT I
IF PG=2 THEN KOB=0:FOR I=DDB2 TO FDB2:KOB=KOB+LEN(WK$(I,PG)):NEXT I
A=10:B=10:X1=60:X3=6:GOSUB 6000
COLOR A12,A4:LOCATE 10,20:PRINT " THOLL "
COLOR ET,FM:LOCATE 11,14:PRINT "Nom du Programme    >";:COLOR ET,A7:PRINT NOM$(PG)
COLOR ET,FM:LOCATE 12,14:PRINT "Parametres en cour  >";:COLOR ET,A7:PRINT PA$
COLOR ET,FM:LOCATE 13,14:PRINT "Place en Oct sur le disque    >";:COLOR ET,A7:PRINT USING " ###### Oct ";KOB
COLOR ET,FM:LOCATE 14,14:PRINT "Place restante en Memoire RAM >";:COLOR ET,A7:PRINT USING " ###.### Ko ";((FRE(-1)/1024))
IF PG=0 THEN COLOR ET,FM:LOCATE 15,14:PRINT "Execution de la ligne ";:COLOR A12,FM:PRINT DDB0;:COLOR ET,FM:PRINT " jusqu' la ligne ";:COLOR A12,FM:PRINT FDB0
IF PG=1 THEN COLOR ET,FM:LOCATE 15,14:PRINT "Execution de la ligne ";:COLOR A12,FM:PRINT DDB1;:COLOR ET,FM:PRINT " jusqu' la ligne ";:COLOR A12,FM:PRINT FDB1
IF PG=2 THEN COLOR ET,FM:LOCATE 15,14:PRINT "Execution de la ligne ";:COLOR A12,FM:PRINT DDB2;:COLOR ET,FM:PRINT " jusqu' la ligne ";:COLOR A12,FM:PRINT FDB2

COLOR ET,FM:LOCATE 16,14:PRINT "Mode SAVE sur >";:COLOR A0,A7:PRINT BAT$
GOSUB 49000:AXXX$="OUI"
GOSUB 1120
COLOR 7,0:CLS
5120 IF BAT$="ON" AND NOT NOM$(PG)="" THEN OPEN NOM$(PG) FOR OUTPUT AS #2:
IF PG=0 THEN FOR I=DDB0 TO FDB0:PRINT #2,WK$(I,PG):NEXT I:CLOSE
IF PG=1 THEN FOR I=DDB1 TO FDB1:PRINT #2,WK$(I,PG):NEXT I:CLOSE
IF PG=2 THEN FOR I=DDB2 TO FDB2:PRINT #2,WK$(I,PG):NEXT I:CLOSE

5130 SH$=NOM$(PG)+" "+PA$:CLS
5140 SHELL SH$:GOSUB 49000
LOCATE 20,2:PRINT "Tapez sur une touche pour revenir  THOLL ":GOSUB 49000

5150 GOTO 10001
6000 COLOR EM,FM:LOCATE A,B:PRINT CHR$(IC78)+STRING$(X1,IC223)+CHR$(IC98)
FOR I=1 TO X3:LOCATE A+I,B:PRINT CHR$(IC221)+SPACE$(X1)+CHR$(IC2)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR EM,FM:NEXT I
LOCATE A+I,B:PRINT CHR$(IC18)+STRING$(X1,IC220)+CHR$(IC38)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SR=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SR:PRINT CHR$(SCREEN(A+1+I,B+1+SR)):NEXT SR
COLOR ET,FM:RETURN
6010 COLOR EI,FI:LOCATE A,B:PRINT CHR$(IC78)+STRING$(X1,IC223)+CHR$(IC98)
FOR I=1 TO X3:LOCATE A+I,B:PRINT CHR$(IC221)+SPACE$(X1)+CHR$(IC2)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR EI,FI:NEXT I
LOCATE A+I,B:PRINT CHR$(IC18)+STRING$(X1,IC220)+CHR$(IC38)+"";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SR=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SR:PRINT CHR$(SCREEN(A+1+I,B+1+SR)):NEXT SR
COLOR ET,A7
RETURN
6020 COLOR EM,FM:LOCATE A,B:PRINT "Ú"+STRING$(X1,"Ä")+"¿":FOR I=1 TO X3:LOCATE A+I,B:PRINT "³"+SPACE$(X1)+"³":NEXT I:LOCATE A+I,B:PRINT "À"+STRING$(X1,"Ä")+"Ù":RETURN
6030 COLOR A3,A0:LOCATE A,B:PRINT "É"+STRING$(X1,"Í")+"»":FOR I=1 TO X3:LOCATE A+I,B:PRINT "º"+SPACE$(X1)+"º":NEXT I:LOCATE A+I,B:PRINT "È"+STRING$(X1,"Í")+"¼":RETURN
6040 COLOR A8,A7:LOCATE A,B:PRINT "É"+STRING$(X1,"Í")+"»":FOR I=1 TO X3:LOCATE A+I,B:PRINT "º"+SPACE$(X1)+"º":NEXT I:LOCATE A+I,B:PRINT "È"+STRING$(X1,"Í")+"¼":RETURN

6100 X1=30:X3=6:A=5:B=6:GOSUB 6000:AI$="Change le nom du programme en cour sans l'ffacer":GOSUB 2100
K$(1)=" Changement du Nom du fichier "
K$(2)=" Nouveau Fichier en Cour      "
K$(3)=" Modifier les couleurs        "
K$(4)=" 0>"+NOM$(0)+SPACE$(29):K$(4)=LEFT$(K$(4),28)
K$(5)=" 1>"+NOM$(1)+SPACE$(29):K$(5)=LEFT$(K$(5),28)
K$(6)=" 2>"+NOM$(2)+SPACE$(29):K$(6)=LEFT$(K$(6),28)
6111 FOR I=1 TO 6:COLOR ET,FM:LOCATE 5+I%,7:PRINT K$(I):NEXT I
COLOR 12,FM:IF PG=0 THEN LOCATE 9,7:PRINT K$(4)
IF PG=1 THEN LOCATE 10,7:PRINT K$(5)
IF PG=2 THEN LOCATE 11,7:PRINT K$(6)
COLOR EB,FB:LOCATE 5+J,7:PRINT K$(J)
6120 X$=INKEY$:IF X$="" THEN 6120
IF X$=RZ$+"H" OR X$="8" THEN J=J-1:IF J=0 THEN J=6
IF X$=RZ$+"P" OR X$="2" THEN J=J+1:IF J=7 THEN J=1
IF X$=E27$ THEN 20010
IF X$="6" OR X$=RZ$+"M" THEN KN=2:COLOR A7,A0:GOSUB 20011:GOTO 610
IF X$="4" OR X$=RZ$+"K" THEN GOSUB 20011:GOTO 6600

$INCLUDE "MENUKN06.BAS"

IF NOT X$=E13$ THEN 6111
IF J=1 THEN 6130
IF J=2 THEN 6200
IF J=3 THEN 6300
IF J=4 THEN PG=0:GOTO 6100
IF J=5 THEN PG=1:GOTO 6100
IF J=6 THEN PG=2:GOTO 6100
GOTO 6111

6130 A=12:B=9:X1=50:X2=1:X3=1:GOSUB 6010
GOSUB 6134:TR=0:N$=""
6132 X$=INPUT$(1):TR=TR+1
IF X$=E8$ OR X$=RZ$+"K" THEN B=LEN(N$):N$=LEFT$(N$,(B-1)):GOSUB 6134:GOTO 6132
IF X$=E27$ THEN GOSUB 20011:GOTO 610
IF X$=E13$ THEN 6135
6133 N$=N$+X$:IF TR>40 THEN N$=LEFT$(N$,40):TR=40
GOSUB 6134:GOTO 6132
6134 LOCATE 13,10:PRINT SPACE$(50):COLOR ET,FI:LOCATE 13,10:PRINT "Nom >";:COLOR A1:PRINT N$:RETURN
6135 TH$=N$:IF TH$="" THEN GOSUB 20011:GOTO 610 ELSE NOM$(PG)=TH$:GOSUB 20011:GOTO 610
6200 A=11:B=9:X1=51:X2=1:X3=2:GOSUB 6000:COLOR ET
LOCATE 12,11:PRINT "MEMOIRE effacer O/N     Memoire restante ";FRE(0):OCT=FRE(-1)/1024
LOCATE 13,11:PRINT USING "Memoire RAM Disponible ####.## Ko";OCT
6215 X$=INKEY$:IF X$="" THEN 6215
IF X$="n" OR X$="N" OR X$=E27$ THEN GOSUB 20011:GOTO 610
IF X$="O" THEN COLOR A8,FM:GOSUB 6000:COLOR A0:LOCATE 12,11:COLOR A1:PRINT "  INITIALISATION        Memoire restante ":LOCATE 12,54:PRINT FRE(0):FOR I=1 TO K800:WK$(I,PG)="":NEXT I:NOM$(PG)="":GOSUB 20011:GOTO 610
GOTO 6215
6300 '

$INCLUDE "COLOR.BAS"

$SEGMENT
6530 CLOSE:OPEN NOM$(PG) FOR INPUT AS #1:CLOSE
A=6:B=10:X1=60:X3=2:GOSUB 6000
LOCATE 7,12:PRINT " Ce fichier xiste dja , Voulez-vous le remplacer ? [";:COLOR A12:PRINT "O";:COLOR A14:PRINT "/";:COLOR A12:PRINT "N";:COLOR ET:PRINT "]"
LOCATE 8,12:PRINT " ou fusionner le texte de l'diteur avec ce fichier ? [";:COLOR A12:PRINT "F";:COLOR ET:PRINT "]"
6532 X$=INKEY$:IF X$="" THEN 6532
IF X$="O" or X$="o" THEN RETURN
IF X$="F" or X$="f" THEN RETURN
IF X$="n" OR X$="N" THEN GOSUB 20011:GOTO 610
GOTO 6532

6600 A=6:B=45:X1=24:X3=3:GOSUB 6000:J=1
$INCLUDE "MNCOPY.BAS"
GOTO 6605

$SEGMENT

7555 IF INKEY$="" THEN 7555
7666 SCREEN SCEN,0,0:GOTO 10120
8000 A=14:B=10:X1=28:X3=2:GOSUB 6000
8001 COLOR ET,FM:LOCATE 15,15:PRINT "Quitter THOLL [O/N] "
LOCATE 16,15:PRINT "Initialiser   [ ";:COLOR A12,FM:PRINT "I";:COLOR ET,FM:PRINT " ]"
8010 X$=INKEY$:IF X$="" THEN 8010
8020 IF X$="O" THEN CLS:END
8023 IF X$="I" THEN SH$=LVG$+"THL":SHELL SH$:GOTO 20010
8030 IF X$="" OR X$="N" OR X$=E27$ THEN 20010
8040 FOR M=1 TO 300 STEP 10:SOUND 150+M,.1:SOUND 1600,.1:LOCATE 15,15:COLOR A4,FM:PRINT "Pas la Bonne Touche":NEXT M
GOTO 8000
8101 FOR I=0 TO 18:LOCATE 4+I,1:PRINT SPACE$(80):NEXT I:RETURN

8200 A=4:B=35:X1=24:X3=12:GOSUB 6000:J=1:A=2:CLOSE
$INCLUDE "MNOPTION.BAS"
GOTO 8200

$SEGMENT
8410 A=10:B=10:X1=13:X3=1:GOSUB 6010
VA$="Ligne >":GOSUB 2000
IF PASSE$="OUI" THEN 8415 ELSE GOSUB 20011:GOTO 610
8415 L=VAL(N$):IF L<(K800-20) AND L<K800 AND L>0 THEN LIG=L:SOUND 500,1:V=1:H=1
GOSUB 20011:GOTO 610
8420 GOSUB 20011:A=5:B=5:X1=70:X3=15:GOSUB 6000
$INCLUDE "PROG.BAS"
END
8170 COLOR A7,A0:GOSUB 8101:A=0:B=4
8180 COLOR ET,FM:LOCATE 4,1:PRINT "Ú"+SPACE$(78)+"¿"
FOR I=1 TO 17:LOCATE 4+I,1:PRINT "³"+SPACE$(78)+"³":NEXT I
LOCATE 4+I,1:PRINT "À"+SPACE$(78)+"Ù"
FOR I=32 TO 255
A=A+1
IF I>64 AND I<91 THEN COLOR A2 ELSE COLOR 15
IF I>47 AND I<58 THEN COLOR A12 ELSE COLOR 15
LOCATE A+4,B:PRINT CHR$(I);:COLOR A1:PRINT "";I
IF A=18 THEN A=-1:B=B+6
NEXT I
8400 GOSUB 49000:GOSUB 20011:GOTO 610
8500 COLOR A1:LOCATE 9,18:PRINT " Code Touche "
COLOR ET:LOCATE 10,20:Print " Taper sur la Touche desirer pour "
LOCATE 11,20:PRINT " connaitre son Code Ascii "
8510 X$=INKEY$:IF X$="" THEN 8510
IF X$=CHR$(12) THEN X$="Clear":GOTO 8500
COLOR ET,FM:LOCATE 12,20:PRINT "Code Normal CHR$( ";ASC(X$);" ) "
LOCATE 13,20:X=ASC(RIGHT$(X$,1)):PRINT "Pour ALT + Touche -> ";X;"  "
LOCATE 14,20:PRINT "Alt -> RZ$+CHR$(";X;") "
LOCATE 15,20:PRINT "Reprsentation ";X$;" "
IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 8500
$SEGMENT
9000 '
9010 A=6:B=30:X1=40:X3=8:GOSUB 6000
9020 COLOR 15,4:LOCATE 6,35:PRINT " ERREUR "
9030 KJ=2
9040 COLOR A4,FM:LOCATE 7,32:PRINT "Le Fichier n'a pas ete ouvert en"
LOCATE 8,32:PRINT "lecture [";:COLOR A1:PRINT LEFT$(NOM$(PG),20);:COLOR A4:PRINT "]"
9045 FOR I=0 TO 4:LOCATE 9+I,31:PRINT SPACE$(36):NEXT I
9050 LOCATE 10,40:PRINT "(R)ecommencer l'appel "
LOCATE 12,40:PRINT "(A)nnuler l'appel "
IF KJ=1 THEN COLOR A8,FM:LOCATE 9,35:PRINT "Ú"+STRING$(29,"Ä")+"¿":LOCATE 10,35:PRINT "³":LOCATE 10,65:PRINT "³":LOCATE 11,35:PRINT "À"+STRING$(29,"Ä")+"Ù"
IF KJ=2 THEN COLOR A8,FM:LOCATE 11,35:PRINT "Ú"+STRING$(29,"Ä")+"¿":LOCATE 12,35:PRINT "³":LOCATE 12,65:PRINT "³":LOCATE 13,35:PRINT "À"+STRING$(29,"Ä")+"Ù"
9072 X$=INKEY$:IF X$="" THEN 9072
9080 IF X$="r" OR X$="R" OR X$=RZ$+"H" THEN KJ=1
9085 IF X$="A" OR X$="a" OR X$=RZ$+"P" THEN KJ=2
9090 IF X$=E13$ AND KJ=2 THEN GOSUB 20011:GOTO 610
9093 IF X$=E13$ AND KJ=1 THEN 1315
9100 GOTO 9040

9200 SOUND 260,1:X=10:Y=10
$INCLUDE "MNCADRE.BAS"


10000 DIM WK$(K800,2),KIDJOE$(1600),VXX$(25)
10001 SCREEN 0:COLOR A7,A0,A0:CLS:H=1:V=1:A$="":RFT=1
WIDTH 80:CLOSE:IF LIG>K800-20 THEN LIG=LIG-20
IF LIG<10 THEN LIG=1
$INCLUDE "LINEDUBA.BAS"
10010 COLOR A8,A0:LOCATE 1,1:FOR I=1 TO 2:PRINT STRING$(80,"Û");:NEXT I:SOUND 1600,.2
10020 COLOR A10,A0:LOCATE 1,1:PRINT "Shift";:COLOR A6:PRINT "/";:COLOR A2:PRINT " Esc ";:GOSUB 10022
COLOR A3,A0:PRINT " Alt  ";:COLOR A9:PRINT "Q";:COLOR A1:PRINT " Fin":COLOR A7,A0
COLOR A11,A0:LOCATE 2,14,0:PRINT " Line ";:COLOR A9:PRINT LIG;:COLOR A8,A0:PRINT "ÛÛÛÛ"
COLOR A11,A0:LOCATE 2,28:PRINT " Col ";:COLOR A9:PRINT H:COLOR A3,A0:LOCATE 2,67:PRINT "Pos ";:COLOR A12,A0:PRINT POK$
COLOR A8,A0:LOCATE 2,1:PRINT "Modif":LOCATE 3,1:PRINT STG$:LOCATE 3,H:COLOR A4,A0:PRINT CHR$(25)
KEY 1,"ECHO ":KEY 2,"GOTO ":KEY 3,"FOR ":KEY 4,"IF ":KEY 5,"PAUSE ":KEY 6,"REM ":KEY 7,"SHIFT ":KEY 8,CHR$(34)+"%1"+CHR$(34):KEY 9,"CLS ":KEY 10,"EXIST ":GOSUB 20011
IF TYN$="ON2" THEN GU2
IF NOT PREUM$="NO" THEN A=10:B=18:X1=40:X3=6:GOSUB 6000:LOCATE 11,24:COLOR ET:PRINT "THOLL ver 1.00 [ 1990 - 1991 ]":LOCATE 13,34:PRINT "Ecrit par":COLOR ET,FM:LOCATE 15,26:PRINT "<ð SERGä TSAKIROPOULOS ð>":PREUM$="NO":GOSUB 49000:GOSUB 20011
$SEGMENT
GUIDER:
GU2:
GOSUB 20011:GOTO 10040
10022 COLOR A14,A0:PRINT " N";:COLOR A12,A0:PRINT "om F. ";:COLOR A14,A0:PRINT " F";:COLOR A12,A0:PRINT "ichier ";:COLOR A14,A0:PRINT " T";:COLOR A12,A0:PRINT "exte ";
COLOR A14,A0:PRINT " O";:COLOR A12,A0:PRINT "ptions ";:COLOR A14,A0:PRINT " E";:COLOR A12,A0:PRINT "xecut ";:COLOR A14,A0:PRINT " I";:COLOR A12,A0:PRINT "mprime ";:COLOR A14,A0:PRINT " C";:COLOR A12,A0:PRINT "opier ";:RETURN
10040 '
10041 GOSUB 20011:AI$="Installation en cours ....":GOSUB 2100
10042 '
10043 COLOR A14,A0
10044 IF POK$="" THEN POK$="NON"
10046 COLOR A3,A0:LOCATE 2,67:PRINT "Pos ";:COLOR A12,A0:PRINT POK$:COLOR A8,A0:LOCATE 2,1:PRINT "Modif"
10050 GOSUB 10060:GOTO 10100
10060 COLOR A11,A0:LOCATE 2,14,0:PRINT " Line ";:COLOR A9:PRINT LIG;:COLOR A8,A0:PRINT "ÛÛÛÛ"
10061 COLOR A11,A0:LOCATE 2,28:PRINT " Col ";:COLOR A9:PRINT H
LOCATE 3,1:PRINT STG$:LOCATE 3,H:COLOR A4,A0:PRINT CHR$(25)
10066 RETURN
10100 AI$=" Esc-Menu / Alt-C Debut,Alt-K Fin du cadre  ":GOSUB 2100
LOCATE 3,1,0:COLOR A9,A0:PRINT STG$
IF TYN$="ON2" THEN TYN$="":GOTO 1321
IF TYN$="ON" THEN TYN$="":NOM$(PG)=HO2$:GOTO 1321
10110 GOSUB 10060:AI$=" Esc-Menu / Alt-C Debut,Alt-K Fin du cadre  ":GOSUB 2100
10120 LOCATE V+3,H,1,0,7
10200 X$=INKEY$:IF X$="" THEN 10120
IF X$=E13$ AND NOT POK$="OUI" THEN SOUND 1600,1:X$=RZ$+"P":H=1
IF X$=RZ$+"K" THEN H=H-1:IF H=0 THEN H=1:GOTO 10110 ELSE 10110
IF X$=RZ$+"H" THEN V=V-1:LIG=LIG-1:IF V=0 THEN V=1:IF LIG=0 THEN LIG=1
IF X$=RZ$+"P" THEN V=V+1:LIG=LIG+1:IF V=20 THEN V=19:IF LIG=K800+1 THEN LIG=K800
IF X$=RZ$+"M" THEN H=H+1:IF H=81 THEN H=80:GOTO 10110
IF LCP$="ON" THEN GOSUB 20015
IF X$=RZ$+"P" THEN 20000
IF X$=RZ$+"H" THEN 20000
IF X$=RZ$+"G" THEN V=1:H=1:LIG=1:GOSUB 20011
IF X$=RZ$+"O" THEN V=1:H=1:LIG=K800-20:GOSUB 20011
IF X$=RZ$+"Q" AND NOT LIG>(K800-30) AND V<18 THEN LIG=LIG+18:GOSUB 20011
IF X$=RZ$+CHR$(16) THEN 8000
IF LIG>22 AND X$=RZ$+"I" AND LIG>22 AND NOT LIG<22 THEN LIG=LIG-18:GOTO 20120
IF X$=RZ$+"H" OR X$=RZ$+"P" OR X$=RZ$+"M" OR X$=RZ$+"K" THEN GOSUB 10060:GOTO 10120
IF X$=E27$ AND NOT POK$="OUI" THEN X$="":GOTO 540
IF X$=CHR$(9) THEN COLOR A3,A0:LOCATE 2,67:PRINT "Pos ";:COLOR A12,A0:PRINT POK$
IF X$=CHR$(9) AND POK$="NON" THEN POK$="OUI"
IF X$=CHR$(9) AND POK$="OUI" THEN POK$="NON"
IF X$=RZ$+CHR$(19) THEN 5052
IF X$=RZ$+CHR$(23) AND NOT POK$="OUI" THEN COLOR A8,A7:LOCATE 4,4:PRINT "** Patientez Insertion **":ZA=K800:FOR Z=LIG+1 TO K800:ZA=ZA-1:WK$(ZA,PG)=WK$(ZA-1,PG):NEXT Z:WK$(LIG,PG)="":GOTO 20010
IF X$=RZ$+" " AND NOT POK$="OUI" THEN COLOR EB,FB:LOCATE 4,4:PRINT "** Patientez Delete **":FOR Z=LIG TO K800-1:WK$(Z,PG)=WK$(Z+1,PG):NEXT Z:WK$(K800,PG)="":GOTO 20010
IF X$=RZ$+"." THEN 9200
IF X$=RZ$+"%" THEN 9500
IF X$=RZ$+"T" THEN KN=1:GOTO 610
IF X$=RZ$+"U" THEN 1000
IF X$=RZ$+"V" THEN 3000
IF X$=RZ$+"W" THEN 8200
IF X$=RZ$+"X" THEN 5000
IF X$=RZ$+"Y" THEN 800
IF X$=RZ$+"Z" THEN 6600
IF X$=RZ$+CHR$(38) THEN SOUND 600,.1:LCP$="OFF":GOTO 20010
IF X$=RZ$+CHR$(24) THEN SOUND 1600,.1:LCP$="ON":GOSUB 20015:GOTO 20010
IF X$=RZ$+CHR$(18) THEN GOSUB 65020:GOTO 20010
IF X$=CHR$(14) THEN LPRINT CHR$(7):LPRINT "** THOLL 1.00 - TSAKI **":LPRINT "Nom --> ";NOM$(PG):LPRINT "Date -> ";DATE$;" : Time -> ";TIME$:LPRINT E13$:FOR I=1 TO 5:LPRINT CHR$(7):NEXT I
IF X$=RZ$+CHR$(17) THEN A=10:B=10:X1=60:X3=2:GOSUB 6000:LOCATE 11,13:PRINT "Caractere total du TEXTE ":X=0:FOR I=1 TO LIG:B=LEN(WK$(I,PG)):LOCATE 11,38:X=X+B:PRINT "ligne ";I;" Total=";X:NEXT I
IF X$=RZ$+CHR$(17) THEN COLOR ET:MA=X/1024:LOCATE 12,13:PRINT USING " Valeur Equivalente   ###.### Ko ";MA:GOSUB 49000:GOTO 20010
IF X$=CHR$(17) THEN W$=WK$(LIG,PG):SOUND 500,1:GOTO 10299
IF X$=CHR$(12) THEN WK$(LIG,PG)=W$:SOUND 600,1:GOTO 10299
BB=LEN(WK$(LIG,PG)):LOCATE 10,1
H1=-2:H2=1
IF X$=E8$ AND H>BB AND BB=0 THEN 10299
IF X$=E8$ AND H>BB THEN H=BB:WK$(LIG,PG)=WK$(LIG,PG)+"   "
IF X$=E8$ AND H>1 AND BB>H THEN WW$=LEFT$(WK$(LIG,PG),H+H1):XX$=RIGHT$(WK$(LIG,PG),BB-H+H2):WK$(LIG,PG)=WW$+XX$:COLOR EE,FE:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):H=H-1:GOTO 10299
IF X$=E8$ AND H=1 AND LEN(WK$(LIG,PG))>H THEN 10299
IF X$=E8$ THEN 10299
10269 IF X$=RZ$+CHR$(82) AND BB<H THEN 10299
10270 IF X$=RZ$+CHR$(82) AND H>1 AND BB>H THEN WW$=LEFT$(WK$(LIG,PG),H):XX$=RIGHT$(WK$(LIG,PG),BB-H):WK$(LIG,PG)=WW$+" "+XX$:COLOR EE,FE:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):GOTO 10299
10271 IF X$=RZ$+CHR$(82) AND H=1 THEN WK$(LIG,PG)=" "+WK$(LIG,PG):SOUND 1600,.1:COLOR EE,FE:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):GOTO 10299
10280 IF X$=RZ$+CHR$(82) THEN COLOR EE,FE:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT LEFT$(WK$(LIG,PG),80):GOTO 10299
'IF X$=RZ$+CHR$(83) THEN  A=A  'DELETE
10298 C=LEN(X$):IF C=2 THEN 10299
IF POK$="OUI" THEN SOUND 1780,1:GOTO 10299
B=LEN(WK$(LIG,PG)):IF B<H THEN WK$(LIG,PG)=WK$(LIG,PG)+SPACE$(H-B)
MID$(WK$(LIG,PG),H)=X$:IF H<80 THEN H=H+1
COLOR EE,FE:LOCATE V+3,1,1,0,7:PRINT SPACE$(80):LOCATE V+3,1,1,0,7:PRINT LEFT$(WK$(LIG,PG),80)
10299 '
GOSUB 10060
10300 GOTO 10120
$SEGMENT
17000 A=7:B=9:X1=67:X3=1:GOSUB 6000:KL=1
17020 '
17040 COLOR ET,F3:LOCATE 8,11:PRINT "<O>  Mot  changer   <   >  Avec une confirmation par O / N "
17050 X$=INKEY$:IF X$="" THEN 17050
17055 FOIS=0:THO=0
17060 IF X$=RZ$+"K" THEN KL=KL-1:IF KL=0 THEN KL=2
17070 IF X$=RZ$+"M" THEN KL=KL+1:IF KL=3 THEN KL=1
17075 COLOR ET,FM:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17076 COLOR ET,FM:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">":THO=0
17080 IF KL=1 THEN COLOR A14:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17090 IF KL=2 THEN COLOR A14:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">"
17199 COLOR A8,A11
17200 IF X$=E13$ AND KL=1 THEN THO=0:CARKA$="":GOTO 17500
17210 IF X$=E13$ AND KL=2 THEN CARKA$="":IF ACV$="" OR ACV$="NON" THEN ACV$="OUI":LOCATE 8,33:PRINT ACV$ ELSE ACV$="NON":LOCATE 8,33:PRINT ACV$
17300 IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 17050
17500 IF ACV$="" THEN ACV$="NON"
THO=0:GOSUB 20011:A=8:B=15:X3=1:X1=40:GOSUB 6010
17550 VA$="Mot  changer > ":GOSUB 2000
IF PASSE$="OUI" THEN 17559 ELSE 20011:GOTO 610
17559 MOT$=N$:IF MOT$="" THEN GOSUB 20011:GOTO 610

17560 A=13:GOSUB 6010:COLOR ET,FI:LOCATE 14,17
VA$=" Par > ":GOSUB 2000
IF PASSE$="OUI" THEN 17562 ELSE GOSUB 20011:GOTO 610
17562 AAA$=N$:IF AAA$="" THEN GOSUB 20011:GOTO 610

COLOR A7,A0
17565 GOSUB 8101
17570 COLOR A12,A0
LOCATE 5,1:PRINT STRING$(80,"÷"):COLOR A14:LOCATE 4,2:PRINT " le Mot ";:COLOR A3:PRINT MOT$;:COLOR A14:PRINT " devient ";:COLOR A9,A0:PRINT AAA$
17580 COLOR A4,A0:LOCATE 21,1:PRINT STRING$(80,"÷"):COLOR A3
17590 K1=LEN(WK$(THO,PG)):K2=LEN(MOT$):K3=LEN(AAA$)
17600 FOR I=1 TO K1:A$=LEFT$(WK$(THO,PG),I):B$=RIGHT$(A$,K2)
IF B$=MOT$ THEN FOIS=FOIS+1:LOCATE 21,29:PRINT "Trouver ";FOIS:GOTO 18000
17630 NEXT I
17640 COLOR A11,A0:LOCATE 2,14:PRINT " Line ";THO:THO=THO+1
IF THO=LIG THEN COLOR A7,A0:LOCATE 22,1:PRINT SPACE$(80):LOCATE 22,1:COLOR A9,A11:PRINT "La Recherche et le remplacement sont terminer":GOSUB 49000:GOTO 10001
17650 GOTO 17590
18000 ZE=ZE+1:IF ZE=12 THEN ZE=1
BCBG=LEN(MOT$):MGTS=LEN(MOT$)
IF NOT MGTS=1 THEN W1=1:W2=2
TY=LEN(WK$(THO,PG)):TM$=RIGHT$(WK$(THO,PG),TY-I)
TP$=LEFT$(WK$(THO,PG),I-K2-CCCC)
LOCATE ZE+6,1:PRINT SPACE$(80):LOCATE ZE+6,1:COLOR A7,A0:PRINT TP$;:COLOR A9,A3:PRINT MOT$;:COLOR A7,A0:PRINT TM$
IF ACV$="OUI" THEN LOCATE 4,46:PRINT SPACE$(30):LOCATE 4,46:COLOR A14,A0:PRINT "*** ";:COLOR A7:PRINT "A remplacer ";:COLOR A11:PRINT "O";:COLOR A12:PRINT "/";:COLOR  A9:PRINT "N";:COLOR A14:PRINT " ***":GOTO 18400
IF ACV$="NON" THEN WK$(THO,PG)=TP$+AAA$+TM$:A$="":B$="":TP$="":TM$="":CCCC=0:W1=0:W2=0:SP=0:K2=0:YKY=0:GOTO 17590
18400 X$=INKEY$:IF X$="" THEN 18400
IF X$="o" OR X$="O" THEN WK$(THO,PG)=TP$+AAA$+TM$:GOTO 17590
IF X$="n" OR X$="N" THEN LOCATE 4,46:PRINT SPACE$(30):GOTO 17640
IF X$=E27$ THEN 20010
SOUND 1600,.1:GOTO 18400

20000 $INCLUDE "A6THL.BAS"
GOTO 20003

20002 $INCLUDE "A5THL.BAS"
GOTO 10120

20004 A=10:B=10:X1=60:X3=3:GOSUB 6000:J=1
20006 FOR I=0 TO 2:COLOR ET,FM:LOCATE 11+I,27:PRINT SPACE$(42):COLOR ET,FM:LOCATE 11+I,13:PRINT "Nom en cour > ";:COLOR A1:PRINT NOM$(I):NEXT I
COLOR EB,FB:LOCATE 10+J,27:PRINT SPACE$(42):LOCATE 10+J,27:PRINT NOM$(J-1)
20005 X$=INKEY$:IF X$="" THEN 20005
IF X$=RZ$+"H" OR X$="8" THEN J=J-1:IF J=0 THEN J=3
IF X$=RZ$+"P" OR X$="2" THEN J=J+1:IF J=4 THEN J=1
IF X$=E27$ THEN 20010
IF X$=E13$ AND J=1 THEN PG=0
IF X$=E13$ AND J=2 THEN PG=1
IF X$=E13$ AND J=3 THEN PG=2
GOTO 20006

20010 $INCLUDE "A4THL.BAS"
GOTO 10110

20011 $INCLUDE "A3THL.BAS"
RETURN

20015 $INCLUDE "A2THL.BAS"
RETURN

20035 COLOR EE,FE:FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(80):NEXT I:LOCATE 4,1:RETURN
20110 COLOR EE,FE:FOR I=0 TO 18:W$=WK$(LIG+I,PG)+SPACE$(80):EDF$=LEFT$(W$,80):LOCATE 4+I,1,0:PRINT EDF$:NEXT I:LIG=LIG-V:GOSUB 10060:GOTO 10110

20120 $INCLUDE "A1THL.BAS"
GOTO 10110

$SEGMENT

40000 $INCLUDE "PARA.BAS"
49000 IF INKEY$="" THEN 49000 ELSE RETURN
60000
IF ERR=57 THEN SOUND 1500,1:BEEP:SOUND 800,1:RESUME NEXT
IF ERL=4600 AND ERR=62 THEN RESUME 4605
IF ERL=2012 THEN RESUME 2000
IF ERL=8412 THEN RESUME 8410
IF ERL=6132 THEN RESUME 6130
IF ERL=201 THEN PRINT " ERREUR DE PROGRAMMATION ERL=201 ":GOSUB 49000:RESUME 10001
IF ERL=4760 THEN LOCATE 17,20:PRINT "Erreur sur fichier ":GOSUB 49000:X$=E27$:RESUME 4651
IF ERL=4810 THEN LOCATE 17,20:PRINT "Erreur sur fichier ":GOSUB 49000
IF ERL=4770 AND NOT ERR=62 THEN CLOSE:COLOR A15,A5:LOCATE 17,10:PRINT "** Fin Anormal du fichier **":GOSUB 49000:X$=E27$:RESUME 4651
IF ERL=4770 AND ERR=62 THEN CLOSE:GOSUB 49000:X$=E27$:RESUME 4651
IF ERL=9500 THEN AI$=" L'angle droit ne doit pas avoir la mme origine ":GOSUB 2100:GOSUB 49000:RESUME 20010
IF ERL=4810 THEN A=7:B=7:X1=30:X3=1:GOSUB 6040:LOCATE 8,9:PRINT "Fichier non present ..."::GOSUB 49000:RESUME 10001
IF ERL=4820 THEN A=7:B=7:X1=30:X3=1:GOSUB 6040:LOCATE 8,9:PRINT "Erreur fichier temporaire":GOSUB 49000:RESUME 10001

COLOR ET,FM
IF ERL=-336 OR ERL=-337 OR ERL=65200 OR ERL=3064 OR ERL=1061 OR ERL=-316 THEN GOSUB 20011:X3=1:A=10:B=10:X1=54:GOSUB 6010:COLOR A0:LOCATE 11,20:PRINT "INTROUVABLE >";ERL,ERR:GOSUB 49000:RESUME 10001
IF ERL=8023 THEN GOSUB 20011:X3=1:A=10:B=10:X1=54:GOSUB 6010:COLOR A0:LOCATE 11,20:PRINT "INTROUVABLE >";ERL,ERR:GOSUB 49000:RESUME 10001
IF ERL>3084 AND ERL<3095 THEN GOSUB 20011:A=6:B=20:X1=54:X3=1:GOSUB 6010:COLOR ET,FM:LOCATE 7,22:PRINT " les fichiers AIDE sont introuvables sur le disque ":GOSUB 49000:RESUME 10001
IF ERL=35 THEN GOSUB 40:RESUME 45
IF ERL=45 THEN XX=8:YY=9:RESUME 50
IF ERL=10000 THEN RESUME 10001
IF ERL=1330 OR ERL=1070 THEN RESUME 9010
IF ERL=20120 THEN V=1:H=1:LIG=1:RESUME 20010
IF ERL=1345 AND ERR=62 THEN GOSUB REUSSI:RESUME 20010
IF ERL=1072 AND ERR=62 THEN GOSUB REUSSI:RESUME 20010
IF ERL=10298 THEN RESUME 10299
IF ERL=6530 THEN X$="O":RESUME 1200
WIDTH 80:SCREEN SCEN
CLOSE:A=16:B=4:X1=70:X3=2:GOSUB 6000:COLOR A15,A4:LOCATE 16,28:PRINT " ERREUR VISUALISER ":COLOR ET,FM:LOCATE 17,7
IF ERR=14 THEN SOUND 100,.4:COLOR 28,4:PRINT " ERREUR General 14  MEMOIRE Pleine  ";:COLOR A16,A7:PRINT " ESSAIE REPARATION -> ";FRE(0);"] ";REPA;" ":REPA=REPA+1:WK$(K800-REPA,PG)="":RESUME 10001
IF ERL=6304 OR ERL=6306 OR ERL=6408 THEN PRINT "Non enregistrer ERL >";ERL;" ERR> ";ERR:GOSUB 49000:RESUME 6300
IF ERL=6302 OR ERL=6303 THEN PRINT "ERREUR D'APPEL":GOSUB 49000:RESUME 6300
IF ERL=4570 OR ERL=4590 THEN PRINT "Erreur sur fichier temporaire ERR>";ERR;" ERL>";ERL:GOSUB 49000:RESUME 10001
IF ERL=4550 OR ERL=4540 THEN PRINT "Erreur sur fichier temporaire avec SHELL":GOSUB 49000:RESUME 10001
IF ERL=4600 AND NOT ERR=62 THEN PRINT "Erreur sur fichier temporaire avec SHELL":GOSUB 49000:RESUME 10001
IF ERL=10250 THEN PRINT "Fichier-Fentre Intouvable ou incomplet ":GOSUB 49000:RESUME 10001
IF ERL=1057 THEN PRINT "MS-DOS impossible Command.com Introuvable ver DOS":GOSUB 49000:RESUME 10001
IF ERL=9550 THEN PRINT "Vous ne devez pas vous positionner avant l'origine ":GOSUB 49000:RESUME 10001
IF ERL=1200 THEN PRINT "Le fichier n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
IF ERL=934 OR ERL=942 THEN PRINT "Erreur sur l'Imprimante":GOSUB 65000:RESUME 20010
IF ERL=1345 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier **":GOSUB 65000:RESUME 20010
IF ERL=1210 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier **":GOSUB 65000:RESUME 20010
IF ERL=1072 AND NOT ERR=62 THEN PRINT "** Fin Anormal du fichier avec SPEED **":GOSUB 65000:RESUME 20010
IF ERL=1430 THEN PRINT "le Fichier de Fusion ";NOM$(PG);" n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
IF ERL=1065 THEN PRINT "Le Fichier "+LEFT$(S$,7)+" n'a pas t renomer en  "+LEFT$(O$,7):GOSUB 65000:RESUME 20010
IF ERL=1445 THEN PRINT "Fin du fichier Fusion  ou ERREUR ":GOSUB 65000:RESUME 20010
IF ERL=5120 THEN PRINT "ERREUR Dans    Save  *.BAT":RESUME 5140
IF ERL=5140 THEN PRINT "ERREUR SYSTEM                    ";ERL;"  ";ERR:GOSUB 65000:RESUME 10001
IF ERL=1067 THEN PRINT "IMPOSSIBLE d'executer SHELL ou COMMAND.COM Non Trouvez <Esc> aide ":GOSUB 65000:GOTO 20010
IF ERL=1530 THEN PRINT " Le fichier n'a pas ete trouve Ou Erreur DISK ":GOSUB 65000:RESUME 1531
IF ERL>65165 AND ERL<65100 THEN PRINT "Erreur survenue pendant la recherche":GOSUB 65000:RESUME 10000

60060 IF ERL=-376 THEN LOCATE 4,4:PRINT "ERREUR ":PRINT ERL:PRINT ERR:GOSUB 49000:RESUME 10000
60080 LOCATE 2,2:PRINT "ERREURE ";ERL;"   ERR ";ERR;"  A= ";A
61060 GOSUB 40:COLOR A11,A0
61070 A=5:B=20:X1=16:X3=1
61080 COLOR A10:LOCATE 1,1:PRINT "THOLL ver 1.00":GOSUB 65020:GOSUB 49000
END
65000 LOCATE 18,5:COLOR A12,A3:PRINT "<";:COLOR A1:PRINT "Esc";:COLOR A12:PRINT ">";:COLOR A0:PRINT "Si une erreur est survenue ou tapez sur une autre touche"
X$=INKEY$:IF X$="" THEN 65000
IF X$=E27$ THEN 65020
RESUME 10001
$SEGMENT
65020 AI$="#######           Erreur dtecte !!!!?..         ######## ":GOSUB 2100:SOUND 1500,1

$INCLUDE "MNERREUR.BAS"

65099 A=10:B=2:X1=74:X3=4:GOSUB 6000:LOCATE 11,7:COLOR A0:PRINT R$:LOCATE 12,7:PRINT "Numroe de L'ERL= ";ERL;"  : Numroe de ERR= ";ERR;" FRE -> ";FRE("")
IF ERDEV$="" THEN LOCATE 13,25:PRINT "* Non Identifier *LIG =";LIG;" V= ";V
LOCATE 13,7:PRINT "Priphrique ->";ERDEV$:GOSUB 49000:RETURN
65060 AI$="Tapez sur * Entrer * pour afficher la ligne indiquer ":GOSUB 2100:SOUND 1500,1
65070 X$=INKEY$:IF X$=""THEN 65070
IF X$=E13$ THEN LIG=I:H=LEN(PIP$)+1:GOTO 20010
IF X$=E27$ THEN 20010
RETURN
65100 I=-1:A=0:FOIS=0:UXU$="NO":TIAW=0:
65110 I=I+1:W$=LEFT$(WK$(I,PG),80)
K=LEN(MOT$):LOCATE 2,14:COLOR A12,A0:PRINT " ligne ";I;" "
IF I=LIG THEN SOUND 400,2:LOCATE 5,1:COLOR A8,A7:PRINT "Fin de la Recherche":GOSUB 49000:GOSUB 20011:GOTO 610
PP=LEN(W$):IF PP>80 THEN PP=80
FOR P=K TO PP
FF$=LEFT$(W$,P):FF2$=RIGHT$(FF$,K):IO=I:PO=P
65125 IF FF2$=MOT$ THEN FOIS=FOIS+1:COLOR EB,FB:LOCATE 4,29:PRINT " Trouver ";FOIS:GOTO 65150
NEXT P
65135 X$=INKEY$:IF X$="" THEN 65110
IF X$=E27$ THEN GOSUB 20011:GOTO 610
GOTO 65110
65150 B=LEN(W$):GF=LEN(FF$):GF=GF-K:PIP$=LEFT$(W$,GF):SP=B-K-GF:MARGO$=RIGHT$(W$,SP)
FOR A=1 TO 17:COLOR EE,FE:LOCATE 5+A,1:PRINT SPACE$(80);:NEXT A
IF I>5 THEN FOR A=1 TO 15:LOCATE 5+A,1:COLOR EE,FE:PRINT LEFT$(WK$(A+(I-5),PG),80):NEXT A:LOCATE 10,1:COLOR EE,FE:PRINT PIP$;:COLOR A15,A4:PRINT MOT$;:COLOR EE,FE:PRINT MARGO$;:GOSUB 65060
IF I<5 THEN FOR A=1 TO 15:LOCATE 5+A,1:COLOR EE,F1:PRINT LEFT$(WK$(A,PG),80):NEXT A:LOCATE 5+I,1:COLOR EE,FE:PRINT PIP$;:COLOR A15,A4:PRINT MOT$;:COLOR EE,FE:PRINT MARGO$;:GOSUB 65060
SOUND 1600,.1:I=IO:P=PO:FF2$=""
65165 GOTO 65125
65170 IF INKEY$="" THEN 65170
65173 UXU$="OUI":GOTO 65125
65180 X$=INKEY$:IF X$="" THEN 65180
IF X$=E27$ THEN GOSUB 20011:GOTO 610
K=0:FOR I=0 TO K800 STEP 50:K=K+1:K$=STR$(K):WK$(I,PG)="< ÍÍÍ Page ["+K$+"] Í Nom -> ........ù... "+STRING$(36,205)+" >":NEXT I
GOTO 20010
REUSSI:
A=10:B=10:X1=15:X3=1:GOSUB 6000:LOCATE 11,12:PRINT "REUSSIE ..!!!":GOSUB 49000
RETURN
V:
COLOR 7,0:CLS:FOR I=1 TO 22:LOCATE I,1:PRINT VXX$(I):NEXT I
RETURN
