0 ON ERROR GOTO 2931:FMAT=3:Q1=1:Q3=3:Q2=2
7 KEY 1," LIST 3400-"
10 CLS:SCREEN 2:LOCATE 1,1:PRINT "F1 Face F2 Cote (L)igne (F)ichier (O)ption Cercle Fleche Paint Time Window     ":SH=-1:DEC=150:M$="C":DEB=10:FIN=590:DEV=0:IO=-1:UY=-1:EL=.40999
20 DIM H1(150),V1(150),H2(150),V2(150),F1(50),F2(50),DY(50):KEY 5,CHR$(250):KEY 1,CHR$(131):KEY 2,CHR$(132):KEY 3,CHR$(133):KEY 4,CHR$(134):KEY 6,CHR$(135):KEY 7,CHR$(137):KEY 8,CHR$(138):KEY 9,CHR$(139)
30 DIM O1(150),E1(150),O2(150),E2(150),R1(100),R2(100),DIA(100),PZC$(150),PJK$(150),D1(100),D2(100),D3(100),ELA(100),ELB(100),FH(50),FV(50),DI(50),PAH(30),PAV(30),FORA(30),OP$(100)

32 DIM G%(30,30),W%(29,29),A%(35,30),C%(25,25),f%(32,32),F9%(11,11),B%(15,15)


40 DIM RU%(7,7)

41 VIEW (10,9)-(615,198),0,1:Z=1:H=300:V=100:ENR=0:Z2=1:MOP$="FACE"
50 LINE (0,0)-(600,200),0,BF
60 IF MOP$="COTED" AND RO$="ORDSUP" THEN GOSUB 2310
70 GET (H-4,V)-(H+4,V+5),RU%
75 LINE (H,V+4)-(H,V+5),3
80 LINE (H,V)-(H+4,V+4),3
90 LINE (H-4,V+4)-(H+4,V+4),3
100 LINE (H,V)-(H-4,V+4),3
104 LINE (H-4,V)-(H+4,V+5),0,BF
106 PUT (H-4,V),RU%
107 '
108 CLOSE
110 IF ENR=1 THEN LINE (H1(ZC),V1(ZC))-(H1(ZC),V1(ZC)),3
111 IF ENR=1 THEN LINE (H1(ZC),V1(ZC))-(H1(ZC),V1(ZC)),0
120 '
130 X$=INKEY$:IF X$="" THEN 70
140 IF X$="4" OR ASC(RIGHT$(X$,1))=75 THEN H=H-Z2:GOTO 110
150 IF X$="1" THEN H=H-Z2:V=V+Z2:GOTO 110
160 IF X$="6" OR ASC(RIGHT$(X$,1))=77 THEN H=H+Z2:GOTO 110
170 IF X$="3" THEN H=H+Z2:V=V+Z2:GOTO 110
180 IF X$="2" OR ASC(RIGHT$(X$,1))=80 THEN V=V+Z2:GOTO 110
190 IF X$="7" THEN V=V-Z2:H=H-Z2:GOTO 110
200 IF X$="8" OR ASC(RIGHT$(X$,1))=72 THEN V=V-Z2:GOTO 110
210 IF X$="9" THEN V=V-Z2:H=H+Z2:GOTO 110
220 IF X$="+" THEN Z2=Z2+1:GOTO 110
230 IF X$="-" THEN Z2=Z2-1:GOTO 110
240 IF X$="5" AND MOP$="FACE" THEN 2230
250 IF X$="5" AND MOP$="COTED" THEN 2310
260 IF X$="0" THEN LINE (0,V)-(600,V),3,,100:
261 IF X$=CHR$(27) AND H<250 AND H>190 THEN 970
262 IF X$=CHR$(27) AND H<568 AND H>496 THEN 1300
270 IF X$=CHR$(9) THEN RO$="ORDSUP":GOTO 60
280 IF X$="." THEN LINE (H,0)-(H,600),3,,100:
290 IF X$=CHR$(0)+CHR$(16) THEN end
300 IF X$=CHR$(13) AND ENR=0 AND MOP$="FACE" THEN ZC=ZC+1:H1(ZC)=H:V1(ZC)=V:SOUND 500,3:ENR=1:PZC$(ZC)=M$:GOTO 110
310 IF X$=CHR$(13) AND ENR=1 AND MOP$="FACE" THEN H2(ZC)=H:V2(ZC)=V:SOUND 1500,3:ENR=0:PZC$(ZC)=M$:GOSUB 2890
320 IF X$="F" OR X$="f" THEN 970
330 IF X$="N" OR X$="n" THEN 840
335 IF X$="P" OR X$="p" THEN 8400
340 IF X$="L" OR X$="l" THEN 1760
345 IF X$=CHR$(139) THEN 7000
350 IF X$=CHR$(13) AND EN2=0 AND MOP$="COTED" THEN JK=JK+1:O1(JK)=H:E1(JK)=V:SOUND 500,3:EN2=1:PJK$(JK)=M$:GOTO 110
360 IF X$=CHR$(13) AND EN2=1 AND MOP$="COTED" THEN O2(JK)=H+DEV:E2(JK)=V:SOUND 1500,3:EN2=0:PJK$(JK)=M$:GOSUB 2890

370 IF X$="V" OR X$="v" THEN BEEP:GET (30,3)-(220,15),C%:LOCATE 3,6:PRINT  FRE(0):GOSUB 2990:LINE (30,3)-(220,15),0,BF:PUT (30,3),C%

380 IF X$="C" OR X$="c" THEN IF CI$="ON" THEN CI$="OFF" ELSE CI$="ON"

381 IF X$="C" OR X$="c" THEN GET (30,3)-(134,15),C%:LOCATE 3,6:PRINT  " CERCLE ";CI$:GOSUB 2990:LINE (30,3)-(134,15),0,BF:PUT (30,3),C%

390 IF X$=CHR$(32) THEN GET (30,1)-(130,15),C%:LOCATE 3,7:PRINT  " ";MOP$:GOSUB 2990:LINE (30,1)-(130,15),0,BF:PUT (30,1),C%

400 IF X$=CHR$(250) THEN 2100
410 IF X$=CHR$(135) THEN 470
420 IF X$=CHR$(131) THEN MOP$="FACE":GOSUB 2230:GOTO 110
430 IF X$=CHR$(132) THEN LINE (-1,-1)-(620,200),0,BF:MOP$="COTED":RO$="ORDSUP":GOSUB 2310:GOTO 110
437 IF X$=CHR$(137) THEN 8000
438 IF X$="R" OR X$="r" THEN 4810
440 IF X$=CHR$(133) THEN 1440
449 IF X$=CHR$(138) THEN 1250
450 IF X$=CHR$(134) THEN 1520
460 GOTO 90


470 I=0:

480 GET (208,28)-(405,87),F%
490 LINE (208,28)-(400,82),0,BF
495 LINE (213,33)-(405,87),1,BF
496 LINE (209,29)-(399,81),0,BF
500 LINE (208,28)-(400,82),1,B
510 LINE (209,29)-(399,81),0,BF
520 FOR A=1 TO 4:LOCATE 5+A,29:PRINT CHR$(23+A):NEXT A
530 LOCATE 6,32:PRINT  "Verticale en Haut"
540 LOCATE 7,32:PRINT  "Verticale en Bas"
550 LOCATE 8,32:PRINT  "Horizontal Droite"
560 LOCATE 9,32:PRINT  "Horizontal Gauche"
570 LOCATE 10,31:PRINT "Effacer Dernier Fl"
580 LOCATE 11,32:PRINT "Retrouver Fleche"
590 GET (209,31+I)-(399,38+I),F9%
600 PUT (209,31+I),F9%,PRESET
610 X$=INKEY$:IF X$="" THEN 610
620 IF X$="2" THEN I=I+8:IF I>40 THEN I=0
630 IF X$="8" THEN I=I-8:IF I=-8 THEN I=40
640 IF X$=CHR$(13) THEN 670

650 IF X$=CHR$(27) THEN LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:GOTO 110
655 IF X$="6" THEN LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:GOTO 8000
656 IF X$="4" THEN LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:GOTO 970
660 GOTO 510
670 LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:
680 IF I=0 AND MOP$="FACE" THEN FF=FF+1:DI(FF)=8:FH(FF)=H:FV(FF)=V:GOTO 2500
690 IF I=0 AND MOP$="COTED" THEN PH=PH+1:DY(PH)=8:F1(PH)=H:F2(PH)=V:GOTO 2500
700 IF I=8 AND MOP$="FACE" THEN FF=FF+1:DI(FF)=2:FH(FF)=H:FV(FF)=V :GOTO 2500
710 IF I=8 AND MOP$="COTED" THEN PH=PH+1:DY(PH)=2:F1(PH)=H:F2(PH)=V:GOTO 2500
720 IF I=16 AND MOP$="FACE" THEN FF=FF+1:DI(FF)=6:FH(FF)=H:FV(FF)=V:GOTO 2500
730 IF I=16 AND MOP$="COTED" THEN PH=PH+1:DY(PH)=6:F1(PH)=H:F2(PH)=V:GOTO 2500
740 IF I=24 AND MOP$="FACE" THEN FF=FF+1:DI(FF)=4:FH(FF)=H:FV(FF)=V:GOTO 2500
750 IF I=24 AND MOP$="COTED" THEN PH=PH+1:DY(PH)=4:F1(PH)=H:F2(PH)=V:GOTO 2500
760 IF I=32 AND MOP$="COTED" THEN PH=PH-1:SOUND 600,3:
761 IF I=40 AND MOP$="COTED" THEN PH=PH+1:SOUND 1600,2:
770 IF I=32 AND MOP$="FACE" THEN FF=FF-1:SOUND 600,3:
771 IF I=40 AND MOP$="FACE" THEN FF=FF+1:SOUND 1600,2:
780 GOTO 110
790 END
800 '
810 '
820 PRINT "V6"
830 PRINT "V7"
840 GET (370,35)-(580,50),G%
850 LINE (370,35)-(580,50),0,BF:LINE (370,35)-(580,50),1,B
860 LOCATE 7,52:PRINT "Nouveau Fichier O/N "
870 X$=INKEY$:IF X$="" THEN 860
880 IF X$="O" THEN ERASE H1,V1,H2,V2,PAH,PAV,FORA,ELB,ELA
890 IF X$="O" THEN ERASE F1,F2,DI,FH,FV,DY
900 IF X$="O" THEN ERASE O1,E1,O2,E2
910 IF X$="O" THEN ERASE R1,R2,DIA
920 IF X$="O" THEN ERASE PZC$,PJK$
930 IF X$="O" THEN ERASE D1,D2,D3:ZC=0:JK=0
940 IF X$="O" THEN LINE (370,35)-(580,50),0,BF:PUT (370,35),G%:GOTO 10
950 IF X$="N" THEN LINE (370,35)-(580,50),0,BF:PUT (370,35),G%:GOTO 110
960 SOUND 6700,.2:GOTO 870
970 I=0  '      W W W W W   A A A A A A
980 GET (150,4)-(347,78),A%
990 LINE (150,4)-(342,73),0,BF
995 LINE (155,9)-(347,78),1,BF
1000 LINE (150,4)-(342,73),1,B
1010 LINE (151,5)-(341,72),0,BF
1020 LOCATE 3,22:PRINT "Stocker ";FI$
1030 LOCATE 4,22:PRINT "Stocker sous ..."
1040 LOCATE 5,22:PRINT "Appeller "
1050 LOCATE 6,22:PRINT "*****************"
1060 LOCATE 7,22:PRINT "Compilation en GwBasic"
1070 LOCATE 8,22:PRINT "Retrouve speed Fichier"
1080 LOCATE 9,22:PRINT "Recherche Fichier"
1090 LOCATE 10,22:PRINT "***************"
1130 GET (151,6+I)-(341,14+I),W%
1140 PUT (151,6+I),W%,PRESET:CLOSE
1150 X$=INKEY$:IF X$="" THEN 1150
1160 IF X$="8" OR ASC(RIGHT$(X$,1))=72 THEN I=I-8:IF I<0 THEN I=56
1170 IF X$="2" OR ASC(RIGHT$(X$,1))=80 THEN I=I+8:IF I>56 THEN I=0
1175 IF X$=CHR$(13) THEN 4000
1180 IF X$=CHR$(27) THEN LINE (150,4)-(347,78),0,BF:PUT (150,4),A%:GOTO 110
1181 IF X$="4" THEN LINE (150,4)-(347,78),0,BF:PUT (150,4),A%:GOTO 1760
1182 IF X$="6" THEN LINE (150,4)-(347,78),0,BF:PUT (150,4),A%:GOTO 470
1190 GOTO 1010
1200 COLOR 9:LOCATE 5,5:PRINT "Entrer le ou les Nom de fichier(s) a retrouver "
1210 COLOR 1:LOCATE 6,5:PRINT "[ Vous pouvez utiliser les Jokers (??? et * )
1220 COLOR 10:LOCATE 8,5:INPUT " Nom -> ",N$
1230 COLOR 7:FILES N$
1240 GOSUB 2990:SCREEN 2:GOTO 10

1250 :I=0 'OP HD

1253 GET (480,4)-(600,40),G%
1255 LINE (480,4)-(600,40),1,B
1256 LINE (481,5)-(599,39),0,BF
1260 LOCATE 3,63:PRINT "REGLAGE HEURE "
1263 LOCATE 4,63:PRINT "REGLAGE DATE  "
1264 LOCATE 5,63:PRINT "REGLAGE ALARME"
1265 LOCATE 6,63:PRINT "ALARME ";AL$
1266 GET (481,6+I)-(599,14+I),W%
1267 PUT (481,6+I),W%,PRESET
1268 X$=INKEY$:IF X$="" THEN 1268
1270 IF X$="8" THEN I=I-8:IF I<0 THEN I=24
1280 IF X$="2" THEN I=I+8:IF I>24 THEN I=0

1283 IF X$=CHR$(27) THEN LINE (480,4)-(600,40),0,BF:PUT (480,4),G%:GOTO 110

1284 IF X$=CHR$(13) AND I=24 THEN IF AL$="ON" THEN AL$="OFF" ELSE AL$="ON"
1285 IF X$=CHR$(13) AND NOT I=24 THEN 3000
1298 GOTO 1256
1299 END

1300 GET (505,5)-(590,15),A%

1330 LINE (505,5)-(590,15),2,B:LINE (506,6)-(589,14),0,BF
1340 LOCATE 3,67:PRINT "PAS ";Z2
1350 X$=INKEY$:IF X$="" THEN 1340
1360 IF X$=CHR$(13) THEN Z2=Z2+1:GOTO 1340
1370 IF X$=CHR$(27) THEN Z2=Z2-1:GOTO 1340

1380 LINE (505,5)-(590,15),0,BF:PUT (505,5),A%:GOTO 110
1390 END
1400 LINE (30,0)-(150,100),0,BF:PUT(30,0),A%

1410 IF I=0 THEN MOP$="FACE":GOSUB 2230:GOTO 110
1420 IF I=8 THEN MOP$="COTED":RO$="ORDSUP":GOSUB 2230:GOTO 110
1430 END
1440 GET (80,35)-(250,50),G%
1450 LINE (80,35)-(250,50),0,BF:LINE (80,35)-(250,50),1,B
1460 LOCATE 7,14:PRINT "H Decalage +/-";DEC
1470 X$=INKEY$:IF X$="" THEN 1460
1480 IF X$="+" THEN DEC=DEC+1
1490 IF X$="-" THEN DEC=DEC-1
1500 IF X$=CHR$(27) OR X$=CHR$(13) THEN LINE (80,35)-(250,50),0,BF:PUT (80,35),G%:GOTO 110
1510 GOTO 1460
1520 GET (80,35)-(250,50),G%
1530 LINE (80,35)-(250,50),0,BF:LINE (80,35)-(250,50),1,B
1540 LOCATE 7,14:PRINT "V Decalage +/-";DEV
1550 X$=INKEY$:IF X$="" THEN 1540
1560 IF X$="+" THEN DEV=DEV+1
1570 IF X$="-" THEN DEV=DEV-1
1580 IF X$=CHR$(27) OR X$=CHR$(13) THEN LINE (80,35)-(250,50),0,BF:PUT (80,35),G%:GOTO 110
1590 GOTO 1540
1600 GET (80,35)-(390,50),G%:K=1
1610 LINE (80,35)-(390,50),0,BF:LINE (80,35)-(390,50),1,B
1620 LOCATE 7,13:PRINT "Position ";PO$+CHR$(26)+"";SH
1630 LOCATE 7,30:PRINT " Debut ";DEB:LOCATE 7,42:PRINT "FIN ";FIN
1640 X$=INKEY$:IF X$="" THEN 1620
1650 IF X$="8" THEN DEB=DEB+K
1660 IF X$="2" THEN DEB=DEB-K
1670 IF X$="7" THEN SH=SH+K:IF SH=0 THEN PO$="OFF" ELSE PO$="ON"
1680 IF X$="1" THEN SH=SH-K:IF SH=0 THEN PO$="OFF" ELSE PO$="ON"
1690 IF X$="9" THEN FIN=FIN+K
1700 IF X$="3" THEN FIN=FIN-K
1710 IF X$=CHR$(32) THEN K=K+1
1720 IF X$=CHR$(8) THEN K=K-1
1730 IF X$=CHR$(27) OR X$=CHR$(13) THEN LINE (80,35)-(390,50),0,BF:PUT (80,35),G%:GOTO 1920
1740 GOTO 1620
1750 END
1760 I=0  ' A A  A  38 25
1770 IF MOP$="COTED" THEN PH=JK
1780 GET (110,0)-(295,73),A%
1790 LINE (110,0)-(290,68),0,BF
1795 LINE (115,5)-(295,73),1,BF
1800 LINE (110,0)-(290,68),1,B

1810 Z=8

1820 LINE (111,1)-(289,67),0,BF
1830 LOCATE 3,18:PRINT "Ligne en Continue"
1840 LOCATE 4,18:PRINT "Ligne en Pointiller"
1850 LOCATE 5,18:PRINT "Ligne de Rappel  "
1860 LOCATE 6,18:PRINT "Dernier L a effacer"
1870 LOCATE 7,18:PRINT "Dernier L recuperer"
1880 LOCATE 8,18:PRINT "Dernier C a effacer"
1890 LOCATE 9,18:PRINT "Dernier C recuperer"
1900 GET (113,6+I)-(287,14+I),B%:
1910 PUT (112,6+I),B%,PRESET
1920 X$=INKEY$:IF X$="" THEN 1920
1930 IF X$="8" THEN I=I-Z:IF I<0 THEN I=0:SOUND 1900,.1
1940 IF X$="2" THEN I=I+Z:IF I>48 THEN I=48:SOUND 1900,.1
1950 IF X$=CHR$(13) AND NOT I=16 THEN 1990
1960 IF X$=CHR$(13) AND I=16 THEN 1600

1970 IF X$=CHR$(27) THEN LINE (110,0)-(295,73),0,BF:PUT (110,0),A%:GOTO 90

1971 IF X$="6" THEN ERASE B%:LINE (110,0)-(295,73),0,BF:PUT (110,0),A%:GOTO 970
1980 GOTO 1820
1990 LINE (110,0)-(295,73),0,BF:PUT(110,0),A%
2000 IF I=0 AND MOP$="FACE" THEN M$="C":GOTO 110
2001 IF I=40 AND MOP$="FACE" THEN IO=IO-1:CIRCLE (R1(IO),R2(IO)),DIA(IO),0,,,ELA(IO):GOTO 110
2010 IF I=0 AND MOP$="COTED" THEN M$="C":GOTO 110
2011 IF I=40 AND MOP$="COTED" THEN UY=UY-1:CIRCLE (D1(UY),D2(UY)),D3(UY),0,,,ELB(UY):GOTO 110
2020 IF I=8 AND MOP$="FACE" THEN M$="P":GOTO 110
2021 IF I=48 AND MOP$="FACE" THEN IO=IO+1:CIRCLE (R1(IO),R2(IO)),DIA(IO),3,,,ELA(IO):GOTO 110
2030 IF I=8 AND MOP$="COTED" THEN M$="P":GOTO 110
2031 IF I=48 AND MOP$="COTED" THEN UY=UY+1:CIRCLE (D1(UY),D2(UY)),D3(UY),3,,,ELB(UY):GOTO 110
2040 IF I=24 AND MOP$="COTED" THEN SOUND 500,1:SOUND 4000,2:LINE (O1(JK),E1(JK))-(O2(JK),E2(JK)),0:JK=JK-1
2050 IF I=24 AND MOP$="FACE" THEN SOUND 500,1:SOUND 300,2:LINE (H1(ZC),V1(ZC))-(H2(ZC),V2(ZC)),0:ZC=ZC-1
2060 IF I=32 AND MOP$="COTED" THEN JK=JK+1:SOUND 500,1:SOUND 4000,2:LINE (O1(JK),E1(JK))-(O2(JK),E2(JK)),1
2070 IF I=32 AND MOP$="FACE" THEN ZC=ZC+1:SOUND 500,1:SOUND 300,2:LINE (H1(ZC),V1(ZC))-(H2(ZC),V2(ZC)),1
2080 GOTO 110
2090 END
2100 SOUND 500,1:SOUND 800,1:SOUND 400,1
2110 SOUND 500,1:SOUND 800,1:SOUND 400,1
2120 CIRCLE (H,V),RAY,3,,,EL
2130 CIRCLE (H,V),RAY,0,,,EL
2140 X$=INKEY$:IF X$="" THEN 2120
2150 IF X$="4" OR ASC(RIGHT$(X$,1))=75  THEN RAY=RAY-Z2:IF RAY<0 THEN BEEP:RAY=1
2160 IF X$="-" THEN Z2=Z2-1:IF Z2=0 THEN BEEP:Z2=1
2170 IF X$="+" THEN Z2=Z2+1:IF Z2=100 THEN BEEP:Z2=100
2172 IF X$="9" THEN EL=EL+.01:GOTO 2120
2173 IF X$="3" THEN EL=EL-.01:GOTO 2120
2174 IF X$="7" THEN EL=EL+1:GOTO 2120
2175 IF X$="1" THEN EL=EL-1:GOTO 2120
2176 IF X$="8" THEN EL=EL+.1:GOTO 2120
2177 IF X$="2" THEN EL=EL-.1:GOTO 2120
2178 IF X$="5" THEN EL=.40999:SOUND 500,2:SOUND 612,1
2180 IF X$="6" OR ASC(RIGHT$(X$,1))=77 THEN RAY=RAY+Z2:IF RAY>500 THEN BEEP:RAY=500
2190 IF MOP$="FACE" AND X$=CHR$(13) THEN IO=IO+1:R1(IO)=H:R2(IO)=V:DIA(IO)=RAY:ELA(IO)=EL:FOR I=0 TO IO:CIRCLE (R1(I),R2(I)),DIA(I),3,,,ELA(I):NEXT I:GOTO 410
2200 IF MOP$="COTED" AND X$=CHR$(13) THEN UY=UY+1:D1(UY)=H:D2(UY)=V:D3(UY)=RAY:ELB(UY)=EL:FOR I=0 TO UY:CIRCLE (D1(I),D2(I)),D3(I),3,,,ELB(I):NEXT I:GOTO 410
2210 IF X$=CHR$(27) THEN GOTO 410
2220 SOUND 1000,.1:GOTO 2120
2230 LINE (0,0)-(600,200),0,BF
2240 FOR I=0 TO ZC:IF MOP$="FACE" AND PZC$(I)="P" THEN LINE (H1(I),V1(I))-(H2(I),V2(I)),3,,31:'ICI
2250 NEXT I
2260 FOR I=0 TO ZC:IF MOP$="FACE" AND PZC$(I)="C" THEN LINE (H1(I),V1(I))-(H2(I),V2(I)),3
2270 NEXT I
2280 IF MOP$="FACE" THEN FOR I=0 TO IO:CIRCLE (R1(I),R2(I)),DIA(I),3,,,ELA(I):D=DIA(I)/2:NEXT I
2285 FOR I=0 TO IO
2290 IF CI$="ON" THEN D=DIA(I)/2:LINE (R1(I),R2(I)-D-10)-(R1(I),R2(I)+D+10),3,,-120
2295 IF CI$="ON" THEN LINE (R1(I)-D*2-10,R2(I))-(R1(I)+D*2+10,R2(I)),3,,-120
2298 NEXT I
2300 GOTO 2500
2310 '
2314 LINE (0,0)-(620,200),0,BF:FOR I=0 TO JK
2320 IF MOP$="COTED" AND PJK$(I)="P" THEN LINE (O1(I),E1(I))-(O2(I),E2(I)),2,,511
2330 NEXT I
2340 FOR I=0 TO JK:IF MOP$="COTED" AND PJK$(I)="C" THEN LINE (O1(I),E1(I))-(O2(I),E2(I)),3
2350 NEXT I
2360 FOR I=0 TO UY:CIRCLE (D1(I),D2(I)),D3(I),3,,,ELB(I):NEXT I
2370 '
2380 '
2390 FOR I=0 TO ZC
2400 IF MOP$="COTED" AND PZC$(I)="C" THEN LINE (DEB,V1(I)-DEV)-(FIN,V1(I)-DEV),3,,2:LINE (DEB,V2(I)-DEV)-(FIN,V2(I)-DEV),3,,2:LINE (300,V1(I)-DEV)-(300,V2(I)-DEV),3,,SH:LINE (H1(I)-DEC,V1(I)-DEV)-(H2(I)-DEC,V2(I)-DEV),3:RO$=""
2410 IF MOP$="COTED" AND PZC$(I)="P" THEN LINE (DEB,V1(I)-DEV)-(FIN,V1(I)-DEV),3,,2:LINE (DEB,V2(I)-DEV)-(FIN,V2(I)-DEV),3,,2:LINE (300,V1(I)-DEV)-(300,V2(I)-DEV),3,,SH:LINE (H1(I)-DEC,V1(I)-DEV)-(H2(I)-DEC,V2(I)-DEV),3,,511:RO$=""
2420 NEXT I
2430 FOR I=0 TO IO:CIRCLE (R1(I)-DEC,R2(I)-DEV),DIA(I),3,,,ELA(I):IF CI$="ON" THEN LINE (DEB,R2(I)-DEV)-(FIN,R2(I)-DEV),3,,-120:D=DIA(I)/2
2440 IF CI$="ON" THEN LINE (R1(I)-DEC,R2(I)-D-21-DEV)-(R1(I)-DEC,R2(I)+D+19-DEV),3,,-120
2450 IF CI$="ON" THEN LINE (DEB,R2(I)+D-DEV)-(FIN,R2(I)+D-DEV),3,,10
2460 IF CI$="ON" THEN LINE (DEB,R2(I)-D-DEV)-(FIN,R2(I)-D-DEV),3,,10
2470 IF CI$="ON" THEN  LINE (R1(I)-DEC-DIA(I),R2(I)-DEV)-(R1(I)-DEC+DIA(I),R2(I)-DEV),3,,-120
2480 NEXT I:RO$="FIN"
2490 '
2500 IF MOP$="FACE" THEN A=0:B=0:GOTO 2530
2510 IF MOP$="COTED" THEN A=DEC:B=DEV:GOTO 2530
2520 END
2530 FOR I=0 TO FF
2540 IF DI(I)=8 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)-4-A,FV(I)+4-B),3
2550 IF DI(I)=8 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)+4-A,FV(I)+4-B),3
2560 IF DI(I)=8 THEN LINE (FH(I)-4-A,FV(I)+4-B)-(FH(I)+4-A,FV(I)+4-B),3
2570 IF DI(I)=8 THEN LINE (FH(I)-A,FV(I)+4-B)-(FH(I)-A,FV(I)+7-B),3
2580 IF DI(I)=2 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)-4-A,FV(I)-4-B),3
2590 IF DI(I)=2 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)+4-A,FV(I)-4-B),3
2600 IF DI(I)=2 THEN LINE (FH(I)-4-A,FV(I)-4-B)-(FH(I)+4-A,FV(I)-4-B),3
2610 IF DI(I)=2 THEN LINE (FH(I)-A,FV(I)-4-B)-(FH(I)-A,FV(I)-7-B),3
2620 IF DI(I)=6 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)-4-A,FV(I)-4-B),3
2630 IF DI(I)=6 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)-4-A,FV(I)+4-B),3
2640 IF DI(I)=6 THEN LINE (FH(I)-4-A,FV(I-B)-4)-(FH(I)-4-A,FV(I)+4-B),3
2650 IF DI(I)=6 THEN LINE (FH(I)-4-A,FV(I)-B)-(FH(I)-7-A,FV(I)-B),3
2660 IF DI(I)=4 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)+4-A,FV(I)-4-B),3
2670 IF DI(I)=4 THEN LINE (FH(I)-A,FV(I)-B)-(FH(I)+4-A,FV(I)+4-B),3
2680 IF DI(I)=4 THEN LINE (FH(I)+4-A,FV(I)-4-B)-(FH(I)+4-A,FV(I)+4-B),3
2690 IF DI(I)=4 THEN LINE (FH(I)+4-A,FV(I)-B)-(FH(I)+7-A,FV(I)-B),3
2700 NEXT I:IF MOP$="FACE" THEN 110
2710 FOR I=0 TO PH
2720 IF DY(I)=8 THEN LINE (F1(I),F2(I))-(F1(I)-4,F2(I)+4),3
2730 IF DY(I)=8 THEN LINE (F1(I),F2(I))-(F1(I)+4,F2(I)+4),3
2740 IF DY(I)=8 THEN LINE (F1(I)-4,F2(I)+4)-(F1(I)+4,F2(I)+4),3
2750 IF DY(I)=8 THEN LINE (F1(I),F2(I)+4)-(F1(I),F2(I)+7),3
2760 IF DY(I)=2 THEN LINE (F1(I),F2(I))-(F1(I)-4,F2(I)-4),3
2770 IF DY(I)=2 THEN LINE (F1(I),F2(I))-(F1(I)+4,F2(I)-4),3
2780 IF DY(I)=2 THEN LINE (F1(I)-4,F2(I)-4)-(F1(I)+4,F2(I)-4),3
2790 IF DY(I)=2 THEN LINE (F1(I),F2(I)-4)-(F1(I),F2(I)-7),3
2800 IF DY(I)=6 THEN LINE (F1(I),F2(I))-(F1(I)-4,F2(I)-4),3
2810 IF DY(I)=6 THEN LINE (F1(I),F2(I))-(F1(I)-4,F2(I)+4),3
2820 IF DY(I)=6 THEN LINE (F1(I)-4,F2(I)-4)-(F1(I)-4,F2(I)+4),3
2830 IF DY(I)=6 THEN LINE (F1(I)-4,F2(I))-(F1(I)-7,F2(I)),3
2840 IF DY(I)=4 THEN LINE (F1(I),F2(I))-(F1(I)+4,F2(I)-4),3
2850 IF DY(I)=4 THEN LINE (F1(I),F2(I))-(F1(I)+4,F2(I)+4),3
2860 IF DY(I)=4 THEN LINE (F1(I)+4,F2(I)-4)-(F1(I)+4,F2(I)+4),3
2870 IF DY(I)=4 THEN LINE (F1(I)+4,F2(I))-(F1(I)+7,F2(I)),3
2880 NEXT I:GOTO 110
2890 IF MOP$="FACE" AND PZC$(ZC)="C" THEN LINE (H1(ZC),V1(ZC))-(H2(ZC),V2(ZC)),3:RETURN
2900 IF MOP$="FACE" AND PZC$(ZC)="P" THEN LINE (H1(ZC),V1(ZC))-(H2(ZC),V2(ZC)),3,,511:RETURN
2910 IF MOP$="COTED" AND PJK$(JK)="P" THEN LINE (O1(JK),E1(JK))-(O2(JK),E2(JK)),3,,255:RETURN
2920 IF MOP$="COTED" AND PJK$(JK)="C" THEN LINE (O1(JK),E1(JK))-(O2(JK),E2(JK)),3:RETURN
2930 END
2931 IF ERL=70 THEN IF H>600 THEN SOUND 60,.1:H=600:IF MOP$="COTED" THEN DEC=DEC+Z2:SOUND 40,.1:X$=CHR$(132):RESUME 430
2932 IF ERL=70 THEN IF H<0 THEN H=3:SOUND 60,.1:IF MOP$="COTED" THEN DEC=DEC-Z2:SOUND 40,.1:X$=CHR$(132):RESUME 430
2933 IF ERL=70 THEN IF V<0 THEN V=3:SOUND 40,.1:IF MOP$="COTED" THEN DEV=DEV-Z2:X$=CHR$(132):RESUME 430
2934 IF ERL=70 THEN IF V>198 THEN V=198:SOUND 40,.1:IF MOP$="COTED" THEN DEV=DEV+Z2:X$=CHR$(132):RESUME 430
2935 IF ERL=70 THEN RESUME 107
2936 IF ERL=106 THEN H=H+1:RESUME 107
2937 IF ERL=8152 OR ERL=8152 THEN SOUND 1600,.3:FORM=20:CH=4:RESUME 8040
2938 IF ERL=8000 THEN RESUME 8000
2939 IF ERL=8001 THEN RESUME 8001
2940 IF ERL=6000 THEN ERASE DR$,J$:RESUME 6000
2941 IF ERL=4070 THEN LOCATE 10,23:PRINT "  Pas de COMMAND.COM  ":GOSUB 2990:RESUME 1150
2942 IF ERL=8151 OR ERL=8152 THEN BEEP:RESUME 8040
2943 IF ERL=1230 THEN LOCATE 10,10:COLOR 20:PRINT "Fichier ";:COLOR 3:PRINT N$;:COLOR 20:PRINT " Introuvable ":RESUME 1240
2944 IF ERL=3081 THEN T$="":ZZ=1:RESUME 3101
2945 IF ERL=20 OR ERL=30 THEN RESUME 41
2946 IF ERL=3082 THEN D$="":ZZ=1:RESUME 3101
2947 IF ERL=4030 THEN LINE (150,4)-(347,78),0,BF:PUT (150,4),A%:RESUME 110
2950 IF 250=ERL THEN RESUME 260
2951 IF 6010=ERL THEN LOCATE 9,23:PRINT " DISK.MRK Introuvable ":ERASE DR$:GOSUB 2990:RESUME 1150
2952 IF 5240=ERL THEN LOCATE 4,13:PRINT "**  FICHIER ";FI$;" INTROUVABLE  **":GOSUB 2990:RESUME 5800
2953 IF 4240=ERL THEN LOCATE 4,13:PRINT " IMPOSIBLE D'ECRIRE LE FICHIER  ...":GOSUB 2990:RESUME 4800
2954 IF 5250=ERL OR 5264=ERL OR 5364=ERL OR 5350=ERL OR 5450=ERL OR 5470=ERL OR ERL=5550 OR ERL=5570 OR 5650=ERL OR 5670=ERL OR ERL=5750 OR ERL=5770 OR ERL=5776 OR ERL=5778 THEN RESUME 5800
2955 IF 4250=ERL OR 4264=ERL OR 4350=ERL OR 4450=ERL OR 4470=ERL OR ERL=4550 OR ERL=4570 OR 4650=ERL OR 4670=ERL OR ERL=4750 OR ERL=4770 OR ERL=4776 OR ERL=4778 THEN RESUME 4800
2956 IF 4800=ERL OR 5800=ERL THEN RESUME 1150
2957 IF 6020=ERL  THEN RESUME 6030

2958 IF 6002=ERL OR 6003=ERL OR 6005=ERL THEN LOCATE 9,22:PRINT "Erreur Recherche":GOSUB 49000:RESUME 990

2960 IF ERL=40 THEN RESUME NEXT
2961 IF ERL=880 THEN RESUME NEXT
2980 PRINT ERL:PRINT ERR:END
2990 IF INKEY$="" THEN 2990 ELSE RETURN
3000 IF I=0 THEN 3050
3010 IF I=8 THEN 3050
3020 IF I=16 THEN 3600
3030 IF I=24 THEN 3800
3040 END

3050 DIM T%(20,20):ZZ=1

3055 GET (450,13)-(590,33),T%
3058 LINE (450,13)-(590,33),0,BF
3060 LINE (450,13)-(590,33),3,B
3070 LOCATE 5,60:PRINT SPACE$(15)
3071 IF I=0 THEN LOCATE 4,60:PRINT "Heure ";TIME$
3072 IF I=8 THEN LOCATE 4,60:PRINT "Date  ";DATE$
3075 IF I=0 THEN LOCATE 5,60:PRINT "New ->";T$
3076 IF I=8 THEN LOCATE 5,60:PRINT "New ->";D$
3079 X$=INKEY$:IF X$="" THEN 3070
3080 IF X$=CHR$(27) THEN LINE (450,13)-(590,33),0,BF:PUT (450,13),T%:ERASE T%:GOTO 1268
3081 IF X$=CHR$(13) AND I=0 THEN TIME$=T$:T$="":ZZ=1:SOUND 500,.3
3082 IF X$=CHR$(13) AND I=8 THEN DATE$=D$:D$="":ZZ=1:SOUND 500,.3
3083 IF X$<"0" OR X$>"9" THEN SOUND 400,.1:GOTO 3080
3084 IF ZZ=7 THEN ZZ=6:GOTO 3080
3085 IF I=0 AND LEN(T$)<8 THEN T$=T$+X$:ZZ=ZZ+1:IF ZZ=3 THEN T$=T$+":"
3086 IF I=0 THEN IF ZZ=5 THEN T$=T$+":"
3088 IF I=8 AND LEN(D$)<8 THEN D$=D$+X$:ZZ=ZZ+1:IF ZZ=3 THEN D$=D$+"-"
3089 IF I=8 THEN IF ZZ=5 THEN D$=D$+"-"
3100 GOTO 3070

3101 DIM T2%(10,10):T$=""

3105 GET (400,21)-(537,33),T2%
3106 LINE (400,21)-(537,33),0,BF
3108 LINE (400,21)-(537,33),1,B
3110 IF I=0 THEN LOCATE 5,53:PRINT "Heure Incorrecte"
3111 IF I=8 THEN LOCATE 5,53:PRINT "DATE Incorrecte."
3120 IF INKEY$="" THEN 3110
3121 LINE (400,21)-(537,33),0,BF:PUT (400,21),T2%:ERASE T2%:GOTO 3070
3600 '
3800 '
3910 END
4000 IF I=0 THEN 4200
4010 IF I=8 THEN FI$="":GOTO 4200
4020 IF I=16 THEN FI$="":GOTO 5200
4030 IF I=24 THEN A1=A1+1
4040 IF I=32 THEN 9000
4050 IF I=40 THEN CLS:SCREEN 0:COLOR 14,0:PRINT "MERAK ver 1.00  Retrouver fichier sans COMMAND.COM":LOCATE 2,1:COLOR 4:PRINT STRING$(50,"-"):GOTO 1200
4060 IF I=48 THEN 6000
4070 IF I=56 THEN A1=A21
4190 END
4200 IF NOT FI$="" THEN 4230
4203 GET (80,11)-(390,26),G%
4210 LINE (80,11)-(390,26),0,BF:LINE (80,11)-(390,26),1,B
4220 LOCATE 4,13:PRINT "Nom -> ";:INPUT "",FI$
4230 OT$=FI$+".THL":CLOSE
4240 OPEN OT$ FOR OUTPUT AS #1:PRINT #1,"THOLL SERGE TSAKI FICHIER ";OT$:PRINT #1,Z2,CH,DEC,DEV,DEB,FIN:PRINT #1,MOP$:PRINT #1,CI$
4245 OPEN "THL.TSK" FOR OUTPUT AS #2
4246 PRINT #2,FI$:CLOSE #2
4250 PRINT #1,"- ZC -":PRINT #1,ZC
4260 FOR I=0 TO ZC
4264 IF PZC$(I)="C" THEN X=1 ELSE X=0
4270 PRINT #1,H1(I),V1(I),H2(I),V2(I),X
4275 NEXT I
4350 PRINT #1,"- JK -":PRINT #1,JK
4360 FOR I=0 TO JK
4364 IF PJK$(I)="C" THEN X=1 ELSE X=0
4370 PRINT #1,O1(I),E1(I),O2(I),E2(I),X
4375 NEXT I
4450 PRINT #1,"- IO -":PRINT #1,IO
4460 FOR I=0 TO IO
4470 PRINT #1,R1(I),R2(I),DIA(I),ELA(I)
4475 NEXT I
4550 PRINT #1,"- UY -":PRINT #1,UY
4560 FOR I=0 TO UY
4570 PRINT #1,D1(I),D2(I),D3(I),ELB(I)
4575 NEXT I
4650 PRINT #1,"- FF -":PRINT #1,FF
4660 FOR I=0 TO FF
4670 PRINT #1,FH(I),FV(I),DI(I)
4675 NEXT I
4750 PRINT #1,"- PH -":PRINT #1,PH
4760 FOR I=0 TO PH
4770 PRINT #1,F1(I),F2(I),DY(I)
4775 NEXT I
4776 PRINT #1,"- PAI -":PRINT #1,PAI
4777 FOR I=0 TO PAI
4778 PRINT #1,PAH(I),PAV(I),FORA(I)
4779 NEXT I
4800 I=0:LINE (80,11)-(390,26),0,BF:PUT (80,11),G%:GOTO 1150
4810 X=2:Y=2:GET (80,35)-(390,50),G%:K=1
4820 LINE (80,35)-(390,50),0,BF:LINE (80,35)-(390,50),1,B
4830 IF MOP$="FACE" THEN A1=1500-ZC:A2=100-IO:LOCATE 7,13:PRINT "Reste ";A1;" ligne(s)  ";A2;" Cercle(s)
4840 IF MOP$="COTED" THEN A1=1500-JK:A2=100-UY:LOCATE 7,13:PRINT "Reste ";A1;" ligne(s)  ";A2;" Cercle(s)
4850 IF INKEY$="" THEN 4850
4860 LINE (80,35)-(390,50),0,BF:PUT (80,35),G%:GOTO 110
5000 GOTO 4850
5200 GET (80,11)-(390,26),g%
5210 LINE (80,11)-(390,26),0,BF:LINE (80,11)-(390,26),1,B
5220 LOCATE 4,13:PRINT "Nom -> ";:INPUT "",FI$
5230 OT$=FI$+".THL":CLOSE
5240 OPEN OT$ FOR INPUT AS #1:ZC=0:PAI=0:PBI=0:IO=0:UY=0:FF=0:PH=0:INPUT #1,N$:LOCATE 4,13:PRINT N$:INPUT #1,Z2,CH,DEC,DEV,DEB,FIN:INPUT #1,MOP$:INPUT #1,CI$
5245 OPEN "THL.TSK" FOR OUTPUT AS #2
5246 PRINT #2,FI$:CLOSE #2
5250 INPUT #1,N0$:INPUT #1,ZC:LOCATE 4,13:PRINT SPACE$(36):LOCATE 4,15:PRINT "Nbr de ligne(s) ";ZC;" vue de Face"
5260 FOR I=0 TO ZC
5264 INPUT #1,H1(I),V1(I),H2(I),V2(I),X
5270 IF X=1 THEN PZC$(I)="C" ELSE PZC$(I)="P"


5275 NEXT I
5350 INPUT #1,N1$:INPUT #1,JK:LOCATE 4,13:PRINT SPACE$(36):LOCATE 4,15:PRINT "Nbr de ligne ";JK;" vue de Cote"
5360 FOR I=0 TO JK
5364 INPUT #1,O1(I),E1(I),O2(I),E2(I),X
5370 IF X=1 THEN PJK$(I)="C" ELSE PJK$(I)="P"
5375 NEXT I
5450 INPUT #1,N2$:INPUT #1,IO:LOCATE 4,13:PRINT SPACE$(36):LOCATE 4,15:PRINT "Nbr de Cercle ";IO;" vue Face"
5460 FOR I=0 TO IO
5470 INPUT #1,R1(I),R2(I),DIA(I),ELA(I)
5475 NEXT I
5550 INPUT #1,N3$:INPUT #1,UY:LOCATE 4,13:PRINT SPACE$(36):LOCATE 4,15:PRINT "Nbr de Cercle ";UY;" Vue Cote"
5560 FOR I=0 TO UY
5570 INPUT #1,D1(I),D2(I),D3(I),ELB(I)
5575 NEXT I
5650 INPUT #1,N4$:INPUT #1,FF:LOCATE 4,13:PRINT SPACE$(36)
5660 FOR I=0 TO FF:LOCATE 4,15:PRINT "Nombre de Fleche ";FF;" / ";I
5670 INPUT #1,FH(I),FV(I),DI(I)
5675 NEXT I
5750 INPUT #1,N5$:INPUT #1,PH
5760 FOR I=0 TO PH
5770 INPUT #1,F1(I),F2(I),DY(I)
5775 NEXT I
5776 INPUT #1,N7$:INPUT #1,PAI
5777 FOR I=0 TO PAI
5778 INPUT #1,PAH(I),PAV(I),FORA(I)
5779 NEXT I


5800 I=16:LINE (80,11)-(390,26),0,BF:PUT (80,11),G%:GOTO 1150
6000 LINE (151,5)-(341,72),0,BF:DIM  DR$(300),J$(300)
6002 CLOSE:OPEN "MKDISK.BAT" FOR OUTPUT AS #1
6003 PRINT #1,"ECHO OFF":PRINT #1,"DIR >DISK.MRK":CLOSE
6005 SHELL "MKDISK. BAT"
6010 OPEN "DISK.MRK" FOR INPUT AS #1
6020 FOR I=0 TO 300:INPUT #1,DR$(I):T=T+1:NEXT I
6030 CLOSE
6040 X$=LEFT$(DR$(2),17):LECT$=RIGHT$(X$,2)
6050 FOR E=3 TO T:I$=LEFT$(DR$(E),12)
6055 I2$=RIGHT$(I$,3):IF I2$="THL" THEN KLM=KLM+1:J$(KLM)=LEFT$(DR$(E),8):J$(KLM)=J$(KLM)+".THL"
6060 NEXT E
6100  '


6110 LOCATE 3,24:PRINT "Lecteur ";LECT$:K=0
6111 RES$=LEFT$(DR$(T-1),13):LOCATE 4,24:PRINT "Reste ";RES$
6112 LOCATE 5,24:PRINT DR$(T-2)
6113 LOCATE 8,22:PRINT KLM;" Fichier(s) THL"


6119 '


6120 LINE (186,37)-(290,71),0,BF
6121 LOCATE 7,23:PRINT CHR$(26)
6130 FOR I=1 TO 4:LOCATE 6+I,26:PRINT J$(K+I):NEXT I
6140 Z$=INKEY$:IF Z$="" THEN 6140
6150 IF Z$="2" THEN K=K+1:IF K>KLM+1 THEN K=1
6160 IF Z$="8" THEN K=K-1:IF K<0 THEN K=KLM
6167 IF Z$=CHR$(27) THEN LINE (150,4)-(342,73),0,BF:PUT (150,4),A%:ERASE DR$,J$:GOTO 970
6168 IF Z$=CHR$(13) THEN OT$=J$(K+1):GOTO 5240
6170 GOTO 6120
7000 DIM WIN%(30,25):RA=4
7005 GET (400,1)-(580,60),WIN%
7010 LINE (400,1)-(580,60),0,BF
7015 LINE (400,1)-(580,60),1,B
7016 'IF MOP$="FACE" THEN 7060
7017 IF MOP$="COTED" THEN 7020
7020 FOR I=0 TO ZC
7025 A1=H1(I)/RA:A2=V1(I)/RA:A3=H2(I)/RA:A4=V2(I)/RA
7030 IF PZC$(I)="C" THEN LINE (400+A1,1+A2)-(400+A3,1+A4),1
7032 IF PZC$(I)="P" THEN LINE (400+A1,1+A2)-(400+A3,1+A4),1,,520
7040 NEXT I
7999 END

8000 I=0

8001 '
8010 GET (208,28)-(405,87),F%
8020 LINE (208,28)-(400,82),0,BF
8021 LINE (213,33)-(405,87),1,BF
8022 LINE (209,29)-(399,81),0,BF
8023 LINE (208,28)-(400,82),1,B
8040 LINE (209,29)-(399,71),0,BF
8050 '
8060 LOCATE 6,32:PRINT  "PAINT SURFACE "
8070 LOCATE 7,32:PRINT  "Format ";FORM
8080 LOCATE 8,32:PRINT  "Effacer Paint drn"
8090 LOCATE 9,32:PRINT  "Retrouver Paint "
8100 LOCATE 10,32:PRINT "Renomer Format ";FORA
8110 GET (209,31+I)-(399,38+I),F9%
8120 PUT (209,31+I),F9%,PRESET
8130 X$=INKEY$:IF X$="" THEN 8130
8140 IF X$="2" THEN I=I+8:IF I>32 THEN I=0
8150 IF X$="8" THEN I=I-8:IF I=-8 THEN I=32
8151 IF X$="+" THEN FORM=FORM+1:LINE (209,72)-(399,80),0,BF:LINE (209,72)-(399,80),1,B:PAINT (210,75),CHR$(FORM)+CHR$(CH),3
8152 IF X$="-" THEN FORM=FORM-1:LINE (209,72)-(399,80),0,BF:LINE (209,72)-(399,80),1,B:PAINT (210,75),CHR$(FORM)+CHR$(CH),3
8160 IF X$=CHR$(13) THEN 8200
8170 IF X$=CHR$(27) THEN LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:GOTO 110
8172 IF X$="4" THEN LINE (208,28)-(405,87),0,BF:PUT (208,28),F%:GOTO 470
8180 GOTO 8040
8200 IF I=0 AND MOP$="FACE" THEN PAI=PAI+1:PAH(PAI)=H:PAV(PAI)=V:FORA(PAI)=FORM:X$=CHR$(27):GOTO 8170
8220 IF I=8 THEN SOUND 1700,.3:SOUND 500,.4:LOCATE 7,29:PRINT SPACE$(23):LOCATE 7,29:INPUT " 0 a 100 -> ",CH:GOTO 8040
8300 END
8400 IF MOP$="FACE" THEN IF NOT PAI=0 THEN FOR I=1 TO PAI:AP=FORA(I)+CH:PAINT (PAH(I),PAV(I)),CHR$(FORA(I))+CHR$(CH),3:NEXT I
8420 GOTO 110
9000 IF FI$="" THEN 1150
9010 ATU$=FI$+".BAS":OPEN ATU$ FOR OUTPUT AS #1:A=0
9015 PRINT #1,"0 SCREEN 2:CLS:PRINT "+CHR$(34)+" PIECE ";FI$;" EN VUE DE FACE "+CHR$(34)+":C1=1:C2=2:C3=3:CH=";CH
9016 PRINT #1,"2 'SCREEN 1:CLS:WINDOW SCREEN (0,0)-(619,199)"
9020 FOR I=0 TO ZC:A=A+5:PRINT #1,A;"LINE (";H1(I);",";V1(I);")-(";H2(I);",";V2(I);"),C1":NEXT I
9030 FOR I=0 TO IO:A=A+5:PRINT #1,A;"CIRCLE (";R1(I);",";R2(I);"),";DIA(I);",C2":NEXT I
9040 FOR I=0 TO PAI:A=A+5:PRINT #1,A;"PAINT (";PAH(I);",";PAV(I);"),CHR$(";FORA(I);")+CHR$(CH),C2":NEXT I
9050 A=A+5:PRINT #1,A;" IF INKEY$=";CHR$(34)+CHR$(34);" THEN ";A
9055 A=A+5:PRINT #1,A;" CLS
9120 FOR I=0 TO JK:A=A+5:PRINT #1,A;"LINE (";O1(I);",";E1(I);")-(";O2(I);",";E2(I);"),C1":NEXT I
9130 FOR I=0 TO UY:A=A+5:PRINT #1,A;"CIRCLE (";D1(I);",";D2(I);"),";D3(I);",C2":NEXT I
9140 LINE (151,5)-(341,78),0,BF
9145 LINE (151,5)-(341,78),1,B
9150 LOCATE 3,23:PRINT "Compilation GW-BASIC"
9160 LOCATE 5,22:PRINT "Compile de :"
9165 LOCATE 6,22:PRINT "La Vue de Face et de "
9170 LOCATE 7,22:PRINT "Cote , seul les lignes"
9180 LOCATE 8,22:PRINT "les cercles , et ,les "
9190 LOCATE 9,22:PRINT "Surface paint sont
9200 LOCATE 10,22:PRINT " Stocker ..."
9210 IF INKEY$="" THEN 9210
9220 GOTO 1010
49000 IF INKEY$="" THEN 49000
49010 RETURN
