ON ERROR GOTO 60000
WIDTH 80:SCREEN 0
DEFINT I,U,B
10 'IF NOT COMMAND$="MARGO" THEN PRINT "Fichier Programme THOLL ":PRINT "Par SäRGä TSAKI":GOSUB 49000:END
FOR I=1 TO 5:A$(I)="NON":NEXT I:JK=1
20 CLOSE:OM8=8:AM0=0:A=7:B=9:X1=40:X3=2
COLOR 8,3:LOCATE A,B:PRINT "Ú"+STRING$(X1,"Ä")+"¿"
FOR I=1 TO X3:LOCATE A+I,B:PRINT "³"+SPACE$(X1)+"³";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR 8,3:NEXT I
LOCATE A+I,B:PRINT "À"+STRING$(X1,"Ä")+"Ù";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SUPER=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SUPER:PRINT CHR$(SCREEN(A+1+I,B+1+SUPER)):NEXT SUPER:COLOR CLT,A3
50 COLOR 7:K$(1)=" Commencer la recherche       [ "+A$(1)+" ] ":           K$(2)=" Imprimer la Recherche        [ "+A$(2)+" ] "
55 COLOR 0,3:FOR I=1 TO 2:LOCATE 7+I,11:PRINT K$(I):NEXT I:COLOR 15,4:LOCATE 7+JK,11:PRINT K$(JK)
60 X$=INKEY$:IF X$="" THEN 60
IF ASC(RIGHT$(X$,1))=72 THEN JK=JK-1:IF JK=0 THEN JK=2
IF ASC(RIGHT$(X$,1))=80 THEN JK=JK+1:IF JK=3 THEN JK=1
IF X$=CHR$(27) THEN END
IF X$=CHR$(32) AND JK=1 THEN IF A$(1)="OUI" THEN A$(1)="NON" ELSE A$(1)="OUI"
IF X$=CHR$(32) AND JK=2 THEN IF A$(2)="OUI" THEN A$(2)="NON" ELSE A$(2)="OUI"
IF X$=CHR$(13) AND A$(1)="OUI" THEN 1000
GOTO 50
1000 OM8=8:AM0=0:A=11:B=15:X1=50:X3=1:COLOR 8,3:LOCATE A,B:PRINT "Ú"+STRING$(X1,"Ä")+"¿"
FOR I=1 TO X3:LOCATE A+I,B:PRINT "³"+SPACE$(X1)+"³";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR 8,3:NEXT I
LOCATE A+I,B:PRINT "À"+STRING$(X1,"Ä")+"Ù";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SUPER=1 TO X1+2:COLOR OM8,OM0:LOCATE A+1+I,B+1+SUPER:PRINT CHR$(SCREEN(A+1+I,B+1+SUPER)):NEXT SUPER
COLOR CLT,A3:LOCATE 12,17:COLOR 0,3:INPUT "Fichier ->",F$:IF F$="" THEN END
COLOR 0,3:LOCATE 12,16:PRINT SPACE$(50)
LOCATE 12,18:LINE INPUT "Mot (1) a Rechercher ->",M1$:IF M1$="" THEN M1$="xxxx"
LOCATE 12,16:PRINT SPACE$(50):LOCATE 12,18:LINE INPUT "Mot (2) a Rechercher ->",M2$:IF M2$="" THEN M2$="yyyy"
LOCATE 12,16:PRINT SPACE$(50):LOCATE 12,18:LINE INPUT "Mot (3) a Rechercher ->",M3$:IF M3$="" THEN M3$="zzzz"
LOCATE 12,16:PRINT SPACE$(50):LOCATE 12,18:COLOR 12:PRINT "Tapez sur une Trouche .... ou <Esc> pour Fin"
1010 X$=INKEY$:IF X$="" THEN 1010
1020 IF X$=CHR$(27) THEN END
CLS
1100 IF A$(2)="OUI" THEN LPRINT "Recherche sur le fichier ->";F$:LPRINT STRING$(80,247)
1110 IF A$(2)="OUI" THEN LPRINT "Definition THOLL":LPRINT:LPRINT " Mot (1) a rechercher ->> ";M1$
1120 IF A$(2)="OUI" THEN LPRINT " Mot (2) a rechercher -> ";M2$
1130 IF A$(2)="OUI" THEN LPRINT " Mot (3) a Rechercher -> ";M3$:LPRINT
1140 IF A$(2)="OUI" THEN LPRINT STRING$(80,247)
B1=LEN(M1$):B2=LEN(M2$):B3=LEN(M3$):
1150 IF A$(2)="OUI" Then LPRINT "Ouverture du fichier en Lecture"
CLS:COLOR 8,3:LOCATE 1,1:PRINT SPACE$(80):LOCATE 1,1:PRINT "RECHERCHE THOLL Ecrit par SäRGä TSAKI ";:COLOR 0:PRINT "    pour Fin Alt Q ":COLOR 7,0
COLOR 8:LOCATE 2,1:PRINT STRING$(80,247):LOCATE 8,1:PRINT STRING$(80,247):LOCATE 15,1:PRINT STRING$(80,247):COLOR 1
LOCATE 2,6:PRINT " Pour ";:COLOR 3:PRINT M1$;" ":COLOR 1:LOCATE 8,6:PRINT " Pour ";:COLOR 3:PRINT M2$;" ":COLOR 1:LOCATE 15,6:PRINT " Pour ";:COLOR 3:PRINT M3$;" ":COLOR 1
1160 OPEN F$ FOR INPUT AS #1:X=LOC(1)
1170 LINE INPUT #1,W$:COMBIEN=len(W$):ENTOU=ENTOU+COMBIEN
X=LOC(1):Y=LOF(1):NB=NB+1:B=LEN(W$):TOTAL=TOTAL+B:COLOR 1
IF W$="" THEN 1170
1172 '
LOCATE 22,1:PRINT "Caractere Analyser ";ENTOU:LOCATE 22,35:PRINT "Caractere du BUFFER ";X
LOCATE 23,1:PRINT "Nombre d'octeet ";Y
FOR I=1 TO B:G$=LEFT$(W$,I):O$=RIGHT$(G$,B1):M$=RIGHT$(G$,B2):I$=RIGHT$(G$,B3)
IF O$=M1$ THEN T=1:GOSUB 3000:U1=U1+1:LOCATE 2,44:PRINT " Trouver ->",U1
IF M$=M2$ THEN T=2:GOSUB 3000:U2=U2+1:LOCATE 8,44:PRINT " Trouver ->",U2
IF I$=M3$ THEN T=3:GOSUB 3000:U3=U3+1:LOCATE 15,44:PRINT " Trouver ->",U3
NEXT I
2000 X$=INKEY$:IF X$="" THEN 1170
IF X$=CHR$(0)+CHR$(16) THEN END
GOTO 1170
3000 COLOR 7:WX=WX+1:IF WX=6 THEN WX=0
IF T=1 AND A$(2)="NON" THEN FOR Q=1 TO 5:LOCATE 2+Q,1:PRINT SPACE$(80):NEXT Q:L$=LEFT$(G$,I-B1):K1=B-(I):Y$=RIGHT$(W$,K1):LOCATE 3,1:PRINT L$;:COLOR 0,4:PRINT M1$;:COLOR 7,0:PRINT Y$;:RETURN
3010 IF T=1 AND A$(2)="OUI" THEN L$=LEFT$(G$,I-B1):K1=B-(I):Y$=RIGHT$(W$,K1):LPRINT "[1] ";M1$;" >";U1:LPRINT L$+CHR$(27)+"E"+"³"+M1$+"³"+CHR$(27)+"F"+Y$:RETURN
IF T=2 AND A$(2)="NON" THEN FOR Q=1 TO 5:LOCATE 8+Q,1:PRINT SPACE$(80):NEXT Q:L$=LEFT$(G$,I-B2):K2=B-(I):Y$=RIGHT$(W$,K2):LOCATE 9,1:PRINT L$;:COLOR 0,3:PRINT M2$;:COLOR 7,0:PRINT Y$:RETURN
3020 IF T=2 AND A$(2)="OUI" THEN L$=LEFT$(G$,I-B2):K2=B-(I):Y$=RIGHT$(W$,K2):LPRINT "[2] ";M2$;" >";U2:LPRINT L$+CHR$(27)+"E"+"³"+M2$+"³"+CHR$(27)+"F"+Y$:RETURN
IF T=3 AND A$(2)="NON" THEN FOR Q=1 TO 5:LOCATE 15+Q,1:PRINT SPACE$(80):NEXT Q:L$=LEFT$(G$,I-B3):K3=B-(I):Y$=RIGHT$(W$,K3):LOCATE 16,1:PRINT L$;:COLOR 0,6:PRINT M3$;:COLOR 7,0:PRINT Y$:RETURN
3030 IF T=3 AND A$(2)="OUI" THEN L$=LEFT$(G$,I-B3):K3=B-(I):Y$=RIGHT$(W$,K3):LPRINT "[3] ";M3$;" >";U3:LPRINT L$+CHR$(27)+"E"+"³"+M3$+"³"+CHR$(27)+"F"+Y$:RETURN
GOSUB 49000
END
49000 IF INKEY$="" THEN 49000 ELSE RETURN
60000 IF ERL=1100 OR ERL=1110 OR ERL=1120 OR ERL=1130 OR ERL=1140 THEN LOCATE 22,1:PRINT " Erreur sur l'imprimante (Code err ";ERR;" / Code erl ";ERL;"  )":GOSUB 49000:END
IF ERL=1170 AND ERR=62 THEN LOCATE 20,1:PRINT "Fin du fichier Normal [ERR=62]":GOSUB 49000:GOSUB 49000:END
IF ERL=1170 THEN Locate 22,1:PRINT "Erreur Lecteur / fichier ... ";ERR:PRINT "ERL ";ERL:GOSUB 49000:END
IF ERL=1760 THEN LOCATE 22,1:PRINT "Erreur Depart de Fichier ... ";ERR:PRINT "ERL -> ";ERL:GOSUB 49000:END
IF ERL=3010 THEN LOCATE 20,1:PRINT "Erreur sur l'imprimante pour ";:COLOR 14:PRINT M1$;:COLOR 9:PRINT " Trouver ";U1:RESUME 2000
IF ERL=3020 THEN LOCATE 21,1:PRINT "Erreur sur l'imprimante pour ";:COLOR 14:PRINT M2$;:COLOR 9:PRINT " Trouver ";U2:RESUME 2000
IF ERL=3030 THEN LOCATE 22,1:PRINT "Erreur sur l'imprimante pour ";:COLOR 14:PRINT M3$;:COLOR 9:PRINT " Trouver ";U3:RESUME 2000
resume next