SCREEN 0,0,0:WIDTH 80
10 IF COMMAND$="" THEN COLOR 12:PRINT "Fichier Programme pour THOLL":COLOR 3:PRINT "Programme THOLL Par SäRGä TSAKI.":PRINT:GOSUB 49000:END
ON ERROR GOTO 6000
DEFINT I,K,T,Y,A
DIM A%(16000)
IF COMMAND$="MARGO" THEN 11
NX$=COMMAND$:IF NOT NX$="" THEN NM$=NX$:GOSUB CADRE:GOTO 99
11 OM8=8:AM0=0
A=10:B=10:X1=60:X3=1
COLOR 8,7:LOCATE A,B:PRINT "Ú"+STRING$(X1,"Ä")+"¿"
FOR I=1 TO X3:LOCATE A+I,B:PRINT "³"+SPACE$(X1)+"³";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3)):COLOR 8,7
NEXT I
LOCATE A+I,B:PRINT "À"+STRING$(X1,"Ä")+"Ù";:COLOR OM8,OM0:PRINT CHR$(SCREEN(A+I,B+X1+2))+CHR$(SCREEN(A+I,B+X1+3))
FOR SUPER=1 TO X1+2:COLOR OM8,OM0
LOCATE A+1+I,B+1+SUPER:PRINT CHR$(SCREEN(A+1+I,B+1+SUPER))
NEXT SUPER
COLOR CLT,A3
COLOR 8,7
COLOR 0:LOCATE 11,13:INPUT "Nom du fichier > ",NM$:IF NM$="" THEN END
GOSUB CADRE:GOTO 99
CADRE:
COLOR 8,3:LOCATE 4,1:PRINT CHR$(8)+STRING$(78,"ß")+CHR$(8)
FOR I=1 TO 17
LOCATE 4+I,1:PRINT CHR$(221)+SPACE$(78)+CHR$(222)
NEXT I
LOCATE 4+I,1:PRINT CHR$(8)+STRING$(78,220)+CHR$(8)
LOCATE 4+I,72:COLOR 0,4:PRINT " THOLL ":COLOR 0,3
LOCATE 5,3:PRINT " Nom du fichier en Cour >";NM$;"<":COLOR 8,3
LOCATE 6,1:PRINT CHR$(219)+STRING$(78,196)+CHR$(219)

LOCATE 18,10:COLOR 31:PRINT CHR$(219);:COLOR 0:PRINT " > CR [Entrer/CHR$(13)]"
LOCATE 19,10:COLOR 28:PRINT CHR$(249);:COLOR 0:PRINT " > un Espace "
LOCATE 18,40:COLOR 16:PRINT CHR$(219);:COLOR 0:PRINT " > Efface L'ecran [CHR$(12)]
RETURN
99 TOUR=1:COLOR 0
LOCATE 7,6:PRINT "Chargement en cour ....."

100 OPEN NM$ FOR INPUT AS #1
110 X$=INPUT$(1,#1):A%(TOUR)=ASC(X$):TOUR=TOUR+1
GOTO 110
200 LOCATE 7,6:PRINT "                        "
FOR I=1 TO 10:PC=0:PC2=0:PC1=0
FOR K=1 TO 8
Y=Y+1:IF Y=TOUR THEN SOUND 1600,1:COLOR 0:LOCATE 19,40:PRINT " Fin du Fichier ":GOSUB 49000:END
II=A%(y):IF A%(y)=32 THEN COLOR 12:II=249
IF A%(Y)=13 THEN COLOR 15:II=219
IF A%(Y)>64 AND A%(Y)<91 THEN COLOR 0
IF A%(Y)=27 THEN COLOR 1:II=27
IF A%(Y)=12 THEN COLOR 16:II=219
IF A%(Y)=11 THEN COLOR 16:II=219
IF A%(Y)=7 THEN COLOR 1:II=219
PC2=PC2+1:LOCATE 6+I,PC2+4:PRINT CHR$(II)
PC=PC+3:LOCATE 6+I,PC+15:PRINT HEX$(II)
PC1=PC1+4:LOCATE 6+I,PC1+40:PRINT A%(y)
COLOR 0,3
NEXT K
NEXT I
220 X$=INKEY$:IF X$="" THEN 220
IF X$=CHR$(32) OR X$=CHR$(13) THEN GOSUB CADRE:GOTO 200
IF X$=CHR$(27) THEN END
IF X$=CHR$(9) THEN Y=0
SOUND 1600,1
GOTO 220
END

1000 END

49000 IF INKEY$="" THEN 49000 ELSE RETURN

END
6000 IF ERL=100 THEN LOCATE 21,25:COLOR 15,4:PRINT " < Le fichier n'a pas ete trouver > ":GOSUB 49000:RESUME 1000
     IF ERL=110 THEN RESUME 200
