401 ERASE K$,MT,F$:DIM K$(500),MT(1000),F$(14)
NOW:
CLOSE:A$=L$+"SCAN.THL"
402 OPEN A$ FOR INPUT AS #1
ERASE K$:DIM K$(1000)
FOR I=1 TO 1000:SCC=I
403 INPUT #1,K$(I):INPUT #1,MT(I)
NEXT I
404 CLOSE:AI$(1)="Tapez sur les Fleches "
AI$(2)="pour deplacer le curseur"
AI$(3)="(avec "+CHR$(24)+CHR$(25)+") ,puis une fois"
AI$(4)="que la  selection d'un  "
AI$(5)="fichier  est  effectuee "
AI$(6)="vous taperez  sur F1   "
AI$(7)="pour  comparer la taille "
AI$(8)="actuelle du fichier et "
AI$(9)="la taille stocker en"
AI$(10)="memoire de Masse      "
COLOR A0,A3:LOCATE 1,1:PRINT SPACE$(80):KO=INT(FRE(-1)/1024)
LOCATE 1,1:PRINT "THOLL ";:COLOR A12:PRINT " ver 1.00";:COLOR A0:PRINT " ";STRING$(45,"Í")+"³ ";:PRINT USING "### Ko ";KO;:PRINT "³ Virus ³"
COLOR A8,A2:FOR I=1 TO 24:LOCATE 1+I,1:PRINT STRING$(80,"±");:NEXT I
CAE:
COLOR A12,A0:LOCATE 3,2:PRINT CHR$(201)+STRING$(76,"Í")+CHR$(187)
FOR I=1 TO 18:LOCATE 3+I,2:PRINT CHR$(186)+SPACE$(76)+CHR$(186):NEXT I
LOCATE 3+I,2:PRINT CHR$(200)+STRING$(76,"Í")+CHR$(188):COLOR A8,0:LOCATE 4,3:PRINT CHR$(218)+STRING$(25,"Ä")+CHR$(191)
FOR I=1 TO 4:LOCATE 4+I,3:PRINT CHR$(179)+SPACE$(25)+CHR$(179):NEXT I
LOCATE 4+I,3:PRINT CHR$(192)+STRING$(25,"Ä")+CHR$(217):COLOR A8:LOCATE 10,3:PRINT CHR$(218)+STRING$(25,"Ä")+CHR$(191)
FOR I=1 TO 10:LOCATE 10+I,3:PRINT CHR$(179)+SPACE$(25)+CHR$(179):NEXT I
LOCATE 10+I,3:PRINT CHR$(192)+STRING$(25,"Ä")+CHR$(217):COLOR A8:LOCATE 4,60:PRINT CHR$(218)+STRING$(17,"Ä")+CHR$(191)
FOR I=1 TO 11:LOCATE 4+I,60:PRINT CHR$(179)+SPACE$(17)+CHR$(179):NEXT I
LOCATE 4+I,60:PRINT CHR$(192)+STRING$(17,"Ä")+CHR$(217):COLOR A3:LOCATE 4,30:PRINT CHR$(218)+STRING$(28,"Ä")+CHR$(191)
FOR I=1 TO 16:LOCATE 4+I,30:PRINT CHR$(179)+SPACE$(28)+CHR$(179):NEXT I
LOCATE 4+I,30:PRINT CHR$(192)+STRING$(28,"Ä")+CHR$(217):COLOR A7,A0
FOR I=1 TO 10:LOCATE 10+I,4:PRINT AI$(I):NEXT I
COLOR A0,A3:LOCATE 4,35:PRINT " Menu Principal ":JK=1
COLOR A0,A12:LOCATE 22,5:PRINT "F1 ";:COLOR A0,A7:PRINT " Executions ":COLOR A0,A12:LOCATE 22,21:PRINT "F2 ";:COLOR A0,A7:PRINT " Fin "
COLOR A0,A12:LOCATE 22,30:PRINT "F3 ";:COLOR A0,A7:PRINT " Disque":COLOR A0,A12:LOCATE 22,39:PRINT "F4 ";:COLOR A0,A7:PRINT " Virus "
COLOR A0,A12:LOCATE 22,50:PRINT "F5 ";:COLOR A0,A7:PRINT " Relance ":COLOR A0,A12:LOCATE 22,63:PRINT "F6 ";:COLOR A0,A7:PRINT " Lecteur "
KEY 1,CHR$(1):KEY 2,CHR$(2):KEY 3,CHR$(3):KEY 4,CHR$(4):KEY 5,CHR$(5):KEY 6,CHR$(6)
408 COLOR A8,A0:LOCATE 13,61:PRINT STRING$(17,"Û"):LOCATE 15,61:PRINT STRING$(17,"Û")
409 LOCATE 14,61:PRINT "ÛÝERREUR DANGERÞÛ":COLOR A0,A12:LOCATE 6,31:PRINT "  Programmes verifiable  "
410 LOCATE 4,64:PRINT " Resultat ":LOCATE 6,62:COLOR A8,A0:PRINT "Pas different"
411 LOCATE 8,62:COLOR A8:PRINT "Erreur Danger":COLOR A3:LOCATE 17,60:PRINT "Taille actuelle"
412 COLOR A1:LOCATE 18,62:PRINT ">              <":COLOR A3:LOCATE 19,60:PRINT "Diffenrence de  "
413 COLOR A1:LOCATE 20,62:PRINT ">              <"
414 COLOR A3,A0:FOR I=1 TO 12:LOCATE 7+I,31:PRINT SPACE$(27):LOCATE 7+I,31:PRINT K$(I+SCA):NEXT I
415 COLOR A4:LOCATE 16,22:PRINT "ENTRER":COLOR A1:LOCATE 13,10:PRINT CHR$(24)+CHR$(25)
416 COLOR A3,A0:LOCATE 10,63:COLOR A7:PRINT " Verifie "
417 LOCATE 5,6:PRINT "Taille d'un programme":COLOR A12:MK=MT(JK+SCA)/1024:COLOR A6
418 LOCATE 6,10:PRINT USING "######### Oct";MT(JK+SCA):LOCATE 7,10:PRINT USING "  ####.### Ko";MK
419 LOCATE 8,12:PRINT HEX$(MK);" Hex ":COLOR A0,A12:LOCATE 10,9:PRINT "Utilisation"
420 COLOR A15,A4:LOCATE 7+JK,31:PRINT K$(JK+SCA)
405 X$=INKEY$:IF X$="" THEN 405
IF X$=CHR$(0)+"P" THEN JK=JK+1:IF JK=13 THEN JK=12:SCA=SCA+1:IF SCA>SCC+1 THEN SCA=SCC
IF X$=CHR$(0)+"H" THEN JK=JK-1:IF JK=0 THEN JK=1:SCA=SCA-1:IF SCA<0 THEN SCA=0
COLOR A3,A0:KEY 1,CHR$(1):KEY 2,CHR$(2):KEY 3,CHR$(3):KEY 4,CHR$(4):KEY 5,CHR$(5):KEY 6,CHR$(6):KEY 7,CHR$(7)
IF X$=CHR$(1) THEN 449
IF X$=CHR$(2) THEN 10
IF X$=CHR$(4) THEN 470
IF X$=CHR$(5) THEN RUN
IF X$=CHR$(6) THEN 480
IF X$=CHR$(3) THEN 455
GOTO 408
449 COLOR A12,A0:LOCATE 6,10:PRINT CHR$(201)+STRING$(50,"Í")+CHR$(187)
FOR I=1 TO 6:LOCATE 6+I,10:PRINT CHR$(186)+SPACE$(50)+CHR$(186):NEXT I
LOCATE 6+I,10:PRINT CHR$(200)+STRING$(50,"Í")+CHR$(188):COLOR A10
LOCATE 9,20:PRINT  "ÚÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄ¿"
LOCATE 10,20:PRINT "³   ";:COLOR A3:PRINT " ¬    «    ¬     ";:COLOR A10:PRINT "³"
LOCATE 11,20:PRINT "ÀÄÄÄÄÁÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÙ"
F$=K$(JK+SCA):PASSAGE=0:BB=0
450 OPEN F$ FOR INPUT AS #1
I=0:AX=LOF(1):TOURN=INT(AX/20)
IF NOT AX=MT(JK+SCA) THEN COLOR A31,A4:LOCATE 13,61:PRINT SPACE$(17):LOCATE 15,61:PRINT SPACE$(17):LOCATE 14,61:PRINT "* ERREUR DANGER *":COLOR A3,A0
IF AX>MT(JK+SCA) THEN OK=AX-MT(JK+SCA):A=1
IF AX<MT(JK+SCA) THEN OK=MT(JK+SCA)-AX:A=1
LOCATE 18,63:PRINT AX:LOCATE 20,60:COLOR A31:PRINT USING "####### oct";OK
LOCATE 8,23:PRINT " Caracteres > ";:COLOR A15:PRINT BB;"  "

A451:
IF PASSAGE>4 THEN COLOR A6
IF PASSAGE>9 THEN COLOR A12
IF PASSAGE>14 THEN COLOR A4
IF BB>TRN THEN PASSAGE=PASSAGE+1:LOCATE 10,20+PASSAGE:PRINT "þ":TRN=TRN+TOURN
451 A$=INPUT$(150,#1)
COLOR A3:LOCATE 7,11:PRINT " Verification en cour de ";F$(JK);:COLOR A6:PRINT " >";:COLOR A15:PRINT AX;:COLOR A6:PRINT "<   "
B=LEN(A$):BB=BB+B:LOCATE 8,23:PRINT " Caracteres > ";:COLOR A15:PRINT BB:COLOR A0,A7
452 COLOR A14,A0
GOTO A451
453 GOSUB 49000:GOTO NOW
455 COLOR A2,A0:LOCATE 6,10:PRINT CHR$(201)+STRING$(50,"Í")+CHR$(187)
FOR I=1 TO 5:LOCATE 6+I,10:PRINT CHR$(186)+SPACE$(50)+CHR$(186):NEXT I
LOCATE 6+I,10:PRINT CHR$(200)+STRING$(50,"Í")+CHR$(188)
FOR BL=1 TO SCC:F$=K$(BL):CLOSE
456 OPEN F$ FOR INPUT AS #1:BB=0:B=0
COLOR A8,A0:LOCATE 13,61:PRINT STRING$(17,"Û")
LOCATE 15,61:PRINT STRING$(17,"Û")
LOCATE 14,61:PRINT "ÛÝERREUR DANGERÞÛ"
COLOR A7,A0:LOCATE 9,15:PRINT SPACE$(30)
COLOR A14,A1:LOCATE 9,20:PRINT F$
COLOR A3,A0:I=0:AX=LOF(1)
IF NOT AX=MT(BL) THEN COLOR A31,A4:LOCATE 13,61:PRINT SPACE$(17):LOCATE 15,61:PRINT SPACE$(17):LOCATE 14,61:PRINT "- ERREUR DANGER -":COLOR A3,A0:GOTO 462
IF AX=0 THEN SOUND 1600,1:GOTO 457
P:
OK=MT(BL)-AX:A=1:LOCATE 18,63:PRINT AX
LOCATE 20,62:COLOR A31:PRINT USING "####### oct";OK
457 '
458 COLOR A3,A0:LOCATE 7,11:PRINT " Verification en cour de ";:COLOR A6:PRINT " >";:COLOR A15:PRINT AX;:COLOR A6:PRINT "< oct
BB=0
459 CLOSE
NEXT BL
460 IF INKEY$="" THEN 460 ELSE NOW
462 LOCATE 10,14:PRINT " Effacement O / N  / ( C )ontinue "
X$=INKEY$:IF X$="" THEN 462
IF X$="C" THEN COLOR A8,A0:LOCATE 13,61:PRINT SPACE$(17):LOCATE 15,61:PRINT SPACE$(17):LOCATE 14,61:PRINT "  ERREUR DANGER  ":COLOR A3,A0:GOTO P
IF X$="N" THEN LOCATE 10,14:PRINT "                                 " :GOTO 459
463 IF X$="O" THEN KILL K$(BL):LOCATE 11,14:PRINT "Effac‚ ";K$(BL)
IF X$="O" THEN LOCATE 10,14:PRINT "                                 ":K$(BL)="":COLOR A8,A0:LOCATE 13,61:PRINT SPACE$(17):LOCATE 15,61:PRINT SPACE$(17):LOCATE 14,61:PRINT "- ERREUR DANGER -":COLOR A3,A0:GOTO 459
GOTO 462
470 COLOR A1,A3:LOCATE 7,7:PRINT CHR$(218)+STRING$(62,"Ä")+CHR$(191)
FOR I=1 TO 13:LOCATE 7+I,7:PRINT CHR$(179)+SPACE$(62)+CHR$(179):NEXT I
LOCATE 7+I,7:PRINT CHR$(192)+STRING$(62,"Ä")+CHR$(217):LOCATE 7,10:COLOR A0,A1:PRINT " Commentaire ":COLOR A0,A3
LOCATE 8,9:PRINT " Un virus est un petit bout de programme Pirate qui empeche"
LOCATE 9,9:PRINT " l'ordinateur de fonctionner normalement ."
LOCATE 10,9:PRINT " Les virus informatiques se transmettent lorsque l'utilisa-"
LOCATE 11,9:PRINT " teur charge dans son ordinateur un programme deja contamine"
LOCATE 12,9:PRINT " Lui-meme , s'il ne prend pas certaines precautions , il"
LOCATE 13,9:PRINT " transmettra ce virus a un autre utilisateur "
LOCATE 15,9:PRINT " De nombreux virus , en s'attachant au programme qu'il "
LOCATE 16,9:PRINT " contamine , augmente sa taille  ."
LOCATE 17,9:PRINT " Donc en controlant la taille des programmes qui ont pour
LOCATE 18,9:PRINT " extention  *.EXE  *.COM et  *.SYS , il est facile de voir"
LOCATE 19,9:PRINT " si le programme a ete touche par un virus "
471 IF INKEY$="" THEN 471 ELSE CAE
480 COLOR A8,A0:LOCATE 11,23:PRINT CHR$(201)+STRING$(40,"Í")+CHR$(187)
FOR I=1 TO 4:LOCATE 11+I,23:PRINT CHR$(186)+SPACE$(40)+CHR$(186):NEXT I
LOCATE 11+I,23:PRINT CHR$(200)+STRING$(40,"Í")+CHR$(188)
LOCATE 12,26:COLOR A7:PRINT "Nouveau Scan du disque :"
COLOR A3:LOCATE 13,25:INPUT " Lecteur >",LECTEUR$
COLOR A12:LOCATE 15,25:PRINT "Etes-vous Sur O/N"
485 X$=INKEY$:IF X$="" THEN 485
IF X$="N" THEN CAE
IF X$="O" THEN 490
GOTO CAE
490 A$="DIR "+LECTEUR$+" /S /B /O:N >NUL >>"+LECTEUR$+"DISK.THL"
B$="DIR "+LECTEUR$+" /A:H /S /B /O:N >NUL >"+LECTEUR$+"DISK.THL"
491 SHELL B$:SHELL A$:
492 ERASE K$:DIM K$(1000)
494 A$=LECTEUR$+"DISK.THL":OPEN A$ FOR INPUT AS #1
495 B$=LECTEUR$+"SCAN.THL":OPEN B$ FOR OUTPUT AS #2
FOR I=1 TO 10000
496 INPUT #1,A$
497 CLOSE #3:OPEN A$ FOR INPUT AS #3:X=LOF(3)
498 PRINT #2,A$:PRINT #2,X:MT(I)=X
NEXT I
GOTO NOW
499 CLOSE
CONT2:
ERASE K$,MT,F$
