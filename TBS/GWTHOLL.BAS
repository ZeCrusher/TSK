0 LIG=28:V=19:GOSUB 40:GOTO 10000
1 KEY 1,"ECHO ":KEY 2,"GOTO ":KEY 3,"FOR ":KEY 4," IF ":KEY 5,"PAUSE ":KEY 6,"REM ":KEY 7,"SHIFT ":KEY 8,CHR$(34)+"%1"+CHR$(34):KEY 9,"CLS ":KEY 10," EXIST "
2 CLS:SCREEN 0:WIDTH 80:DIM K$(13)
5 IF NOT COMMAND$="" THEN GOSUB 40:GOTO 40000
10 ON ERROR GOTO 60000:DIM CLR(35)
20 WIDTH 80:SCREEN 0:CLS
30 GOSUB 35:GOTO 45
35 OPEN "COULEUR.THL" FOR INPUT AS #1:FOR I=0 TO 31:INPUT #1,CLR(I):NEXT I:
36 A0=CLR(0):A1=CLR(1):A2=CLR(2):A3=CLR(3):A4=CLR(4):A5=CLR(5):A6=CLR(6):A7=CLR(7):A8=CLR(8):A9=CLR(9):A10=CLR(10):A11=CLR(11):A12=CLR(12):A13=CLR(13)
37 A14=CLR(14):A15=CLR(15):A16=CLR(16):A17=CLR(17):A18=CLR(18):A19=CLR(19):A20=CLR(20):A21=CLR(21):A22=CLR(22):A23=CLR(23):A24=CLR(24):A25=CLR(25):A26=CLR(26):A27=CLR(27)
38 A28=CLR(28):A29=CLR(29):A30=CLR(30):A31=CLR(31):CLOSE:SOUND 40,1:RETURN
40 A0=0:A1=1:A2=2:A3=3:A4=4:A5=5:A6=6:A7=7:A8=8:A9=9:A10=10:A11=11:A12=12:A13=13:A14=14:A15=15:A16=16:A17=17:A18=18:A19=19:A20=20:A21=21:A22=22:A23=23:A24=24:A25=25:A26=26:A27=27:A28=28:A29=29:A30=30:A31=31:SOUND 1600,1:RETURN
45 OPEN "THCONFIG." FOR INPUT AS #2:INPUT #2,XX:INPUT #2,YY:CLOSE:SOUND 1600,3
50 CLS:WIDTH 80:SCREEN 0:GOTO 300
55 COLOR A8:LOCATE 1,1:FOR I=1 TO 25:PRINT STRING$(8,"≤");:NEXT I
60 COLOR A11,A0:B1=4
70 LOCATE 5,20:PRINT CHR$(219);:COLOR A1:PRINT STRING$(40,223);:COLOR A11:PRINT CHR$(219):COLOR A1:FOR I=1 TO B1:LOCATE 5+I,20:PRINT CHR$(221)+SPACE$(40)+CHR$(222)+"  ":NEXT I
73 COLOR A11:LOCATE 5+I,20:PRINT CHR$(219);:COLOR A1:PRINT STRING$(40,220);:COLOR A11:PRINT  CHR$(219)+"  "
75 LOCATE 11,22:PRINT SPACE$(42)
80 COLOR A9:LOCATE 7,25:PRINT "*  THOLL ver 1.00  [1991-1992]  *"
90 COLOR A11:LOCATE 8,25:PRINT STRING$(33,"-"):COLOR A1
95 B1=3:LOCATE 13,30:PRINT CHR$(219)+STRING$(20,223)+CHR$(219):FOR I=1 TO B1:LOCATE 13+I,30:PRINT CHR$(221)+SPACE$(20)+CHR$(222)+"  ":NEXT I:LOCATE 13+I,30:PRINT CHR$(219)+STRING$(20,220)+CHR$(219)+"  ":LOCATE I+13+1,32:PRINT SPACE$(22)
100 COLOR A12:LOCATE 15,34:PRINT "S‰RG‰   TSAKI."
200 GOSUB 49000:GOTO 10000
300 COLOR XX,0:LOCATE 1,1:FOR I=1 TO 25:PRINT STRING$(8,"≤");:NEXT I
310 COLOR YY,0:LOCATE 5,5:PRINT STRING$(27,219):LOCATE 6,22:PRINT SPACE$(11)
312 FOR I=1 TO 6:LOCATE 5+I,16:PRINT STRING$(6,219);:PRINT " ":NEXT I:LOCATE 12,17:PRINT "      "
314 FOR I=1 TO 7:LOCATE 4+I,32:PRINT "€";:LOCATE 5+I,33:PRINT " ":NEXT I:LOCATE 9,32:PRINT STRING$(6,219)
316 FOR I=1 TO 7:LOCATE 4+I,38:PRINT "€";:LOCATE 5+I,39:PRINT " ":NEXT I:LOCATE 10,33:PRINT "     "
324 FOR I=1 TO 7:LOCATE 4+I,42:PRINT "€";:LOCATE 5+I,43:PRINT " ":NEXT I:LOCATE 5,42:PRINT STRING$(7,219):LOCATE 6,43:PRINT "      "
330 FOR I=1 TO 7:LOCATE 4+I,49:PRINT "€";:LOCATE 5+I,50:PRINT " ":NEXT I:LOCATE 11,42:PRINT STRING$(7,219):LOCATE 12,43:PRINT "       "
340 FOR I=1 TO 7:LOCATE 4+I,54:PRINT "€";:LOCATE 5+I,55:PRINT " ":NEXT I:LOCATE 11,54:PRINT STRING$(7,219):LOCATE 12,55:PRINT "       "
350 FOR I=1 TO 7:LOCATE 4+I,63:PRINT "€";:LOCATE 5+I,64:PRINT " ":NEXT I:LOCATE 11,63:PRINT STRING$(9,219):LOCATE 12,64:PRINT "         "
390 GOSUB 49000
395 GOTO 55
500 COLOR A0,A7:LOCATE 1,8:PRINT "Esc"
510 X$=INKEY$:IF X$="" THEN 510
520 IF ASC(RIGHT$(X$,1))=75 THEN KN=KN-1:IF KN=0 THEN KN=7
530 IF ASC(RIGHT$(X$,1))=77 THEN KN=KN+1:IF KN=8 THEN KN=1
531 LOCATE 1,12:GOSUB 10022
532 IF X$=CHR$(27) THEN COLOR A10,A0:LOCATE 1,8:PRINT "Esc":GOTO 10120
540 COLOR A0,A3:IF X$=CHR$(13) THEN COLOR A10,A0:LOCATE 1,8:PRINT "Esc":GOTO 610
541 IF KN=1 THEN LOCATE 1,13:PRINT "Write "
542 IF KN=2 THEN LOCATE 1,21:PRINT "Fichier"
543 IF KN=3 THEN LOCATE 1,30:PRINT "Texte"
544 IF KN=4 THEN LOCATE 1,37:PRINT "C-Ascii"
546 IF KN=5 THEN LOCATE 1,46:PRINT "Execut "
547 IF KN=6 THEN LOCATE 1,54:PRINT "Imprime"
548 IF KN=7 THEN LOCATE 1,63:PRINT "Copier"
600 GOTO 510
610 IF KN=1 THEN COLOR A14,A6:LOCATE 4,1:PRINT SPACE$(80):LOCATE 4,1:INPUT "Entrer le nouveau NOM du fichier ou <ENTRER> ",TR$:IF TR$="" THEN 20010 ELSE NOM$=LEFT$(TR$,27):GOTO 20010
612 IF KN=2 THEN 1000
613 IF KN=3 THEN 3000
614 IF KN=4 THEN 8100
615 IF KN=6 THEN 800'LOCATE 20,1:PRINT SPACE$(80):LOCATE 20,1:SHELL "THIPRIM.EXE":LOCATE 21,1:COLOR A3,A9:PRINT "Fin du fichier / ou Erreur ":GOSUB 65000:GOTO 10001
616 IF KN=5 THEN 5000
617 IF KN=7 THEN 7000
620 IF KN=0 THEN 10000
700 END
800 COLOR A14,A6:FOR I=1 TO 6:LOCATE 3+I,1:PRINT SPACE$(80):NEXT I
805 COLOR A14,A6:LOCATE 4,5:INPUT "Donnez le nom du fichier a imprimee ",IPM$:IF IPM$="" THEN 20010
810 COLOR A9:LOCATE 5,7:INPUT "Code (1) [CHR$(Code a envoyer) ] De 0 a 255 -> ",CH1:IF CH>255 OR CH<0 THEN 800
820 LOCATE 6,7:INPUT "Code (2) De 0 a 255 --> ",CH2:IF CH2>255 OR CH2<0 THEN 800
830 LOCATE 7,5:COLOR A3:INPUT "Ligne de Commencement de l'impression dans Fichier -> ",COK:IF COK<0 THEN 800
840 LOCATE 8,5:INPUT "Fin Ligne de l'impression ",CO2K:IF COK>CO2K THEN 830
850 LOCATE 10,5:COLOR A1,A0:PRINT " Tapez sur une touche pour l'impression "
860 X$=INKEY$:IF X$="" THEN 860
870 IF X$=CHR$(27) THEN 20010
880 OPEN IPM$ FOR INPUT AS #1
890 FOR I=0 TO COK:LINE INPUT #1,A$:NEXT I
900 FOR I=COK TO CO2K
910 LINE INPUT #1,A$
920 LPRINT A$
930 NEXT I
940 GOSUB 65000:GOTO 20010
1000 COLOR A8,A3:LOCATE 4,5:PRINT CHR$(219)+STRING$(20,223)+CHR$(219):JK=1:A=2
1001 FOR I=1 TO 6:LOCATE 4+I,5:PRINT CHR$(221)+SPACE$(20)+CHR$(222):NEXT I:LOCATE 11,5:PRINT CHR$(219)+STRING$(20,220)+CHR$(219):OMB=LIG-V:AMB=OMB:OMB=OMB+2
1003 COLOR A9,A0
1008 COLOR A9,A0:K$(1)=" Enregistrer Sous   "
1009 K$(2)=" Enregistrer        "
1010 K$(3)=" Appellez Fichier   "
1012 K$(4)=" Fusion de Fichier  "
1014 K$(5)=" Recherche Fichiers "
1016 K$(6)=" Recherche Diskette "
1020 COLOR A0,A3:FOR I=0 TO 6:LOCATE 4+I,6:PRINT K$(I):NEXT I
1022 COLOR A15,A4:LOCATE 4+JK,6:PRINT K$(JK)
1025 X$=INKEY$:IF X$="" THEN 1025
1030 IF ASC(RIGHT$(X$,1))=72 THEN JK=JK-1:IF JK=0 THEN JK=6
1034 IF ASC(RIGHT$(X$,1))=80 THEN JK=JK+1:IF JK=7 THEN JK=1
1036 IF X$=CHR$(27) THEN 20010
1040 IF X$=CHR$(13) THEN 1055
1050 GOTO 1020
1055 IF JK=1 THEN 1100
1056 IF JK=2 THEN IF NOM$="" THEN 1100 ELSE GOSUB 1120:GOTO 1200
1057 IF JK=3 THEN 1300
1058 IF JK=4 THEN 1400
1059 IF JK=5 THEN 1500
1060 IF JK=6 THEN COLOR A14,A6:LOCATE 22,1:PRINT SPACE$(80):LOCATE 22,1:INPUT "Sur quel lecteur ou repectoire -> ",L$:IF L$="" THEN COLOR 7,0:LOCATE 22,1:PRINT SPACE$(80):GOTO 20010
1062 IF JK=6 THEN A$="DIR "+L$+"  >DISK.THL" :GOSUB 20035
1065 IF JK=6 THEN CLOSE:OPEN "DIRTHL.BAT" FOR OUTPUT AS #1:PRINT #1,"ECHO OFF":PRINT #1,A$
1067 IF JK=6 THEN SHELL "DIRTHL.BAT":GOTO 1600
1100 W=3:X=40:COLOR A9,A11:LOCATE 5,W:PRINT CHR$(219)+STRING$(X,223)+CHR$(219):JK=1
1105 LOCATE 6,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):LOCATE 7,W:PRINT CHR$(219)+STRING$(X,220)+CHR$(219):COLOR A1:A=0
1106 FOR I=AMB+3 TO AMB+4:AB$=LEFT$(WK$(I),46):AC$=RIGHT$(AB$,2)
1107 A=A+1:COLOR A9,A0:LOCATE 5+A,45:PRINT AC$
1108 NEXT I:AB$=LEFT$(WK$(AMB+5),46):AC$=RIGHT$(AB$,20):LOCATE 8,27:PRINT AC$
1110 COLOR A0,A11:LOCATE 6,W+1:INPUT " Nom -> ",NOM$:IF NOM$="" THEN 20010
1115 GOSUB 1120:GOTO 1200
1120 Y=10:W=33:X=20:COLOR A12,A7:LOCATE Y,W:PRINT CHR$(218)+STRING$(X,196)+CHR$(191):JK=1
1125 FOR I=0 TO 4:LOCATE Y+I+1,W:PRINT CHR$(179)+SPACE$(X)+CHR$(179):NEXT I:LOCATE Y+1+I,W:PRINT CHR$(192)+STRING$(X,196)+CHR$(217)
1130 LOCATE Y+1,W+2:COLOR A8:PRINT "Tapez sur Touche "
1133 LOCATE Y+2,W+2:PRINT "une Fois pres .. "
1135 LOCATE Y+4,W+1:PRINT "   Ou Tapez <Esc>  "
1140 COLOR A9,A0:LOCATE Y+7,W+1:PRINT STRING$(22,223):FOR I=1 TO 6:LOCATE Y+I,W+X+2:PRINT CHR$(219):NEXT I
1150 X$=INKEY$:IF X$="" THEN 1150
1155 IF X$=CHR$(27) THEN 20010
1160 RETURN
1200 OPEN NOM$ FOR OUTPUT AS #1
1210 FOR I=RFT TO LIG:PRINT #1,WK$(I):NEXT I
1220 CLOSE #1:GOTO 20010
1300 W=3:X=40:COLOR A8,A7:LOCATE 7,W:PRINT CHR$(219)+STRING$(X,223)+CHR$(219):JK=1
1305 LOCATE 8,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):LOCATE 9,W:PRINT CHR$(219)+STRING$(X,220)+CHR$(219):COLOR A1:A=0
1306 FOR I=AMB+5 TO AMB+6:AB$=LEFT$(WK$(I),46):AC$=RIGHT$(AB$,2):B=LEN(AC$):IF B=1 THEN AC$=AC$+" "
1307 A=A+1:COLOR A9,A0:LOCATE 7*A,45:PRINT AC$
1308 NEXT I:AB$=LEFT$(WK$(AMB+7),46):AC$=RIGHT$(AB$,20):LOCATE 10,27:PRINT AC$
1310 COLOR A0,A7:LOCATE 8,W+1:INPUT " Nom -> ",NOM$:IF NOM$="" THEN 20010
1315 GOSUB 1120
1320 ERASE WK$,VC$:DIM WK$(800),VC$(800)
1321 Y=13:W=20:X=50:COLOR A12,A7:LOCATE Y,W:PRINT CHR$(218)+STRING$(X,196)+CHR$(191):JK=1
1322 FOR I=0 TO 4:LOCATE Y+I+1,W:PRINT CHR$(179)+SPACE$(X)+CHR$(179):NEXT I:LOCATE Y+I,W:PRINT CHR$(192)+STRING$(X,196)+CHR$(217)
1323 LOCATE Y+1,W+2:COLOR A8:PRINT "Nombre d'Octect(s)
1324 LOCATE Y+2,W+2:PRINT "Nombre de Caractere(s) Totale
1325 LOCATE Y+3,W+2:PRINT "Nombre de Ligne(s)            "
1326 LOCATE Y+4,W+2:PRINT "Caractere(s) dans la ligne  "
1327 COLOR A9,A0:LOCATE Y+6,W+1:PRINT STRING$(X+2,223):FOR I=1 TO 5:LOCATE Y+I,W+X+2:PRINT CHR$(219):NEXT I
1330 CLOSE:COLOR A0,A7:OPEN NOM$ FOR INPUT AS #2:X=LOF(2):LOCATE 14,60:PRINT X
1340 FOR I=RFT TO 800
1345 LINE INPUT #2,WK$(I):BH=LEN(WK$(I)):A=BH+A:VC$(I)=WK$(I)
1346 LOCATE 15,60:PRINT A
1347 LOCATE 16,60:PRINT I
1348 LOCATE 17,60:PRINT BH
1350 NEXT I
1360 CLOSE : GOTO 20010
1400 W=3:X=40:COLOR A8,A11:LOCATE 7,W:PRINT CHR$(219)+STRING$(X,223)+CHR$(219):JK=1
1405 LOCATE 8,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):LOCATE 9,W:PRINT CHR$(219)+STRING$(X,220)+CHR$(219):COLOR A1
1410 LOCATE 8,W+1:INPUT " Nom -> ",NOM$:IF NOM$="" THEN 20010
1415 GOSUB 1120
1421 Y=13:W=20:X=50:COLOR A12,A7:LOCATE Y,W:PRINT CHR$(218)+STRING$(X,196)+CHR$(191):JK=1
1422 FOR I=0 TO 4:LOCATE Y+I+1,W:PRINT CHR$(179)+SPACE$(X)+CHR$(179):NEXT I:LOCATE Y+I,W:PRINT CHR$(192)+STRING$(X,196)+CHR$(217)
1423 LOCATE Y+1,W+2:COLOR A8:PRINT "Nombre d'Octect(s) dans Fusion
1424 LOCATE Y+2,W+2:PRINT "Nombre de Caractere(s) Totale
1425 LOCATE Y+3,W+2:PRINT "Nombre de Ligne(s)            "
1426 LOCATE Y+4,W+2:PRINT "Caractere(s) dans la ligne  "
1427 COLOR A9,A0:LOCATE Y+6,W+1:PRINT STRING$(X+2,223):FOR I=1 TO 5:LOCATE Y+I,W+X+2:PRINT CHR$(219):NEXT I
1430 CLOSE:COLOR A0,A7:OPEN NOM$ FOR INPUT AS #2:X=LOF(2):LOCATE 14,60:PRINT X
1440 FOR I=LIG TO 800
1445 LINE INPUT #2,WK$(I):BH=LEN(WK$(I)):A=BH+A:VC$(I)=WK$(I)
1446 LOCATE 15,60:PRINT A
1447 LOCATE 16,60:PRINT I
1448 LOCATE 17,60:PRINT BH
1450 NEXT I
1460 GOTO 20010
1500 COLOR A9,A0:CLS:PRINT "Fichier a recherche ":COLOR A11,A0
1510 LOCATE 4,4:INPUT "Sur quel lecteur ",L$:COLOR A11,A0
1520 LOCATE 6,4:INPUT "Et quel Fichier ",FL$:A$=L$+FL$:COLOR A12,A0
1530 FILES A$
1540 GOSUB 65000:GOTO 10001
1600 CLOSE:COLOR A10,A0:LOCATE 23,1:PRINT "Tapez Alt 1 pour FIN ,Alt 2 Pour Charger le fichier indiquer par la couleur":COLOR A9,A0:OF$="ON"
1610 FOR I=1 TO 800:DIK$(I)=WK$(I):NEXT I
1620 NNN$=NOM$:NOM$="DISK.THL":GOTO 1320
1640 CLOSE:COLOR A14,A0:LOCATE 23,1:PRINT "Taper Alt 1 pour FIN ,Alt 2 pour Charger le fichier indiquer par la couleur":COLOR A9,A0
1650 OF$="ON":BEEP:BEEP:GOTO 20010
1660 NM$=LEFT$(WK$(LIG),12):A$=LEFT$(NM$,8):B$=RIGHT$(NM$,3):NM$=L$+A$+"."+B$
1661 COLOR A12,A0:LOCATE 4,1:PRINT "Etes vous sur de chargäe le fichier ? O/N ->";NM$
1662 X$=INKEY$:IF X$="" THEN 1662
1664 IF X$="o" OR X$="O" THEN OF$="OFF":NOM$=NM$:LOCATE 23,1:PRINT SPACE$(75):GOTO 1320
1680 IF INKEY$="" THEN 1680
1700 GOSUB 20015:GOTO 10120
2000 '
3000 COLOR A8,A3:LOCATE 4,22:PRINT CHR$(219)+STRING$(19,223)+CHR$(219):JK=1
3005 FOR I=1 TO 10:LOCATE 4+I,22:PRINT CHR$(221)+SPACE$(19)+CHR$(222):NEXT I:LOCATE 15,22:PRINT CHR$(219)+STRING$(19,220)+CHR$(219)
3006 K$(1)=" Recherche un Mot  ":COLOR A9,A0
3008 K$(2)=" Remplacer un Mot  "
3010 K$(3)=" Restore Ligne     "
3012 K$(4)=" Restore Texte sec."
3014 K$(5)=" Copy de securite  "
3015 K$(6)=" En ligne GW-BASIC "
3016 K$(7)=" Tableau Ascii (1)…"
3017 K$(8)=" Tableau Ascii (2)⁄"
3018 K$(9)=" Tableau Ascii (3)÷"
3019 K$(10)=" Tableau Ascii (4)’"
3020 COLOR A0,A3:FOR I=0 TO 10:LOCATE 4+I,23:PRINT K$(I):NEXT I
3022 COLOR A15,A4:LOCATE 4+JK,23:PRINT K$(JK)
3025 X$=INKEY$:IF X$="" THEN 3025
3030 IF ASC(RIGHT$(X$,1))=72 THEN JK=JK-1:IF JK=0 THEN JK=10
3034 IF ASC(RIGHT$(X$,1))=80 THEN JK=JK+1:IF JK=11 THEN JK=1
3036 IF X$=CHR$(27) THEN 20010
3040 IF X$=CHR$(13) THEN 3060
3050 GOTO 3020
3060 IF JK=1 THEN 3100
3061 IF JK=2 THEN 17000
3062 IF JK=3 THEN WK$(LIG)=VC$(LIG):GOTO 20010
3063 IF JK=4 THEN FOR I=1 TO 800:WK$(I)=VC$(I):NEXT I:GOTO 20010
3064 IF JK=5 THEN FOR I=1 TO 800:VC$(I)=WK$(I):NEXT I:GOTO 20010
3065 IF JK=6 THEN A=0:FOR I=RFT TO LIG:A=A+10:WK$(I)=STR$(A)+" "+WK$(I):NEXT I:GOTO 20010
3066 IF JK=7 THEN ED1=201:ED0=205:ED2=187:ED6=186:ED7=186:ED4=200:ED3=188:ED10=205:GOTO 20010
3067 IF JK=8 THEN ED1=218:ED0=196:ED2=191:ED6=179:ED7=179:ED4=192:ED3=217:ED10=196:GOTO 20010
3068 IF JK=9 THEN ED1=214:ED0=196:ED2=183:ED6=186:ED7=186:ED4=211:ED3=189:ED10=196:GOTO 20010
3069 IF JK=10 THEN ED1=213:ED0=205:ED2=184:ED6=179:ED7=179:ED4=212:ED3=190:ED10=205:GOTO 20010
3100 W=3:X=40:COLOR A9,A0:LOCATE 7,W:PRINT CHR$(219)+STRING$(X,223)+CHR$(219):JK=1
3105 LOCATE 8,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):LOCATE 9,W:PRINT CHR$(219)+STRING$(X,220)+CHR$(219):COLOR A14
3110 LOCATE 8,W+1:INPUT " Mot a Chercher ",MOT$:IF MOT$="" THEN 20010
3120 FOR I=1 TO 19:LOCATE 3+I,1:PRINT SPACE$(80):NEXT I
3125 COLOR A6:LOCATE 4,1:PRINT "Recherche de ";:COLOR A3,A0:PRINT MOT$:I=1
3140 COLOR A7,A0:LOCATE 5,3:PRINT "Ligne n¯ ";I;"  "
3150 LOCATE 7,3:PRINT "Nombre de fois trouver ";AH;"  "
3160 GOTO 65100
5000 COLOR A12,A9:LOCATE 4,47:PRINT CHR$(219)+STRING$(19,223)+CHR$(219):JK=1
5005 FOR I=1 TO 3:LOCATE 4+I,47:PRINT CHR$(221)+SPACE$(19)+CHR$(222):NEXT I:LOCATE 8,47:PRINT CHR$(219)+STRING$(19,220)+CHR$(219)
5006 K$(1)=" Executions  *.BAT "
5008 K$(2)=" Save *.BAK        "
5010 K$(3)=" Save *.BAT        "
5020 COLOR A14,A9:FOR I=0 TO 3:LOCATE 4+I,48:PRINT K$(I):NEXT I
5022 COLOR A15,A4:LOCATE 4+JK,48:PRINT K$(JK):COLOR A3,A9
5024 LOCATE 6,62:PRINT BAK$:LOCATE 7,62:PRINT BAT$
5025 X$=INKEY$:IF X$="" THEN 5025
5030 IF ASC(RIGHT$(X$,1))=72 THEN JK=JK-1:IF JK=0 THEN JK=3
5034 IF ASC(RIGHT$(X$,1))=80 THEN JK=JK+1:IF JK=4 THEN JK=1
5036 IF X$=CHR$(27) THEN 20010
5038 '
5040 IF X$=CHR$(13) AND JK=2 THEN BAK$="ON"
5042 IF X$=CHR$(32) AND JK=2 THEN BAK$="OFF"
5046 IF X$=CHR$(13) AND JK=3 THEN BAT$="ON"
5048 IF X$=CHR$(32) AND JK=3 THEN BAT$="OFF"
5049 IF X$=CHR$(13) AND JK=1 THEN 5100
5050 GOTO 5020
5100 LOCATE 20,3:COLOR A14,A6:INPUT "Sur quel lecteur [A: , B: , C: ...] -> ",L$:IF L$="" THEN 20010
5102 COLOR A7,A0:CLS:PRINT "**  THOLL  **":PRINT:PRINT "Retour * EXIT *"
5110 IF BAK$="ON" AND NOT NOM$="" THEN NM$=NOM$+".BAK":OPEN NM$ FOR OUTPUT AS #1:FOR I=1 TO LIG:PRINT #1,WK$(I):NEXT I:CLOSE
5120 IF BAT$="ON" AND NOT NOM$="" THEN NM$=NOM$+".BAT":OPEN NM$ FOR OUTPUT AS #2:FOR I=1 TO LIG:PRINT #2,WK$(I):NEXT I:CLOSE
5130 SH$=NOM$+".BAT"
5135 COLOR 3,0:CLS
5140 SHELL SH$
5150 GOSUB 65000:GOTO 10001
5160 '
6000 '
7000 W=9:X=50:COLOR A8,A3:LOCATE 10,W:PRINT CHR$(219)+STRING$(X,223)+CHR$(219)
7005 FOR I=0 TO 4:LOCATE 11+I,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):NEXT I
7010 LOCATE 12,W:PRINT CHR$(221)+SPACE$(X)+CHR$(222):LOCATE 15,W:PRINT CHR$(219)+STRING$(X,220)+CHR$(219):COLOR A1:A=0
7020 LOCATE 11,12:COLOR A0,A3:INPUT "Fichier Source ",FS$:IF FS$="" THEN 20010
7030 LOCATE 12,12:INPUT "Fichier object ",FO$:IF FO$="" THEN 20010
7040 COLOR A0,A3:LOCATE 11,10:PRINT SPACE$(47):LOCATE 12,10:PRINT SPACE$(48)
7050 LOCATE 11,15:COLOR A12:PRINT "Tapez sur une touche ou <Esc> ":Z=0
7060 X$=INKEY$:IF X$="" THEN 7060
7080 IF X$=CHR$(27) THEN 20010
7090 CLOSE:COLOR A1:A=50
7100 OPEN FS$ FOR INPUT AS #1:LOCATE 11,15:PRINT SPACE$(34):X=LOF(1):LOCATE 13,12:PRINT "Nrb d'Octee(s) dans fichier Source ";X
7110 OPEN FO$ FOR OUTPUT AS #2:COLOR A0,A3
7111 PAS=X/10:
7120 Z=Z+1:LINE INPUT #1 ,A$
7125 LOCATE 12,17:PRINT "  Nbr de ligne(s)    ";Z
7130 PRINT #2,A$
7135 IF Z=A OR Z=1 THEN N$=N$+".":LOCATE 11,12:PRINT "Copie en cour ";N$:A=A+50
7137 X$=INKEY$:IF X$="" THEN 7120
7138 IF X$=CHR$(0)+CHR$(16) THEN 20010
7140 GOTO 7120
7555 IF INKEY$="" THEN 7555
7666 SCREEN 0,0,0:GOTO 10120
8000 COLOR A14,A6:LOCATE 4,1:PRINT SPACE$(80)
8001 LOCATE 4,6:PRINT "Etes-Vous sur de vouloir Quitter  <O / N>  "
8010 X$=INKEY$:IF X$="" THEN 8001
8020 IF X$="o" OR X$="O" THEN END
8030 IF X$="n" OR X$="N" THEN 20010
8040 FOR I=1 TO 300:LOCATE 4,60:COLOR A0,A6:PRINT " Pas Bonne Touche ":NEXT I:GOTO 8000
8100 GOSUB 8101:GOTO 8110
8101 FOR I=0 TO 18:LOCATE 4+I,1:PRINT SPACE$(80):NEXT I:RETURN
8110 COLOR A12,A0:LOCATE 4,10:PRINT "Tableau Code ASCII / Cadre ASCII / Caracteres speciaux "
8120 PRINT:COLOR A14:PRINT:PRINT STRING$(79,"∞"):
8125 PRINT "∞                      ∞                      ∞                               ∞
8130 PRINT "∞ 218  196  194  191   ∞  201  205  203  187  ∞              210              ∞
8132 PRINT "∞  ⁄    ƒ    ¬    ø    ∞   …    Õ    À    ª   ∞  215 ÷ ƒƒƒƒƒ  “  ƒƒƒƒƒƒ ∑ 183 ∞
8134 PRINT "∞                      ∞                      ∞  199 «   215  ◊    182  ∂     ∞
8136 PRINT "∞  ≈ 197      179 ≥    ∞   ∫ 186     206  Œ   ∞  211 ” ƒƒƒƒƒ  –  ƒƒƒƒƒƒ Ω 189 ∞
8138 PRINT "∞                      ∞                      ∞              208              ∞
8140 PRINT "∞  √ 195      180 ¥    ∞   Ã 204     185  π   ∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞
8142 PRINT "∞                      ∞                      ∞              209              ∞
8144 PRINT "∞  ¿     ¡        Ÿ    ∞   »              º   ∞  213 ’ ÕÕÕÕÕ  —  ÕÕÕÕÕÕ ∏ 184 ∞
8146 PRINT "∞ 192   193      217   ∞  200     202    188  ∞  198 ∆    216 ÿ     181 µ     ∞
8148 PRINT "∞                      ∞                      ∞  212 ‘ ÕÕÕÕÕ  œ  ÕÕÕÕÕÕ æ 190 ∞
8150 PRINT "∞T-S                   ∞                      ∞              207              ∞
8160 PRINT STRING$(79,"∞"):GOSUB 49000
8170 GOSUB 8101:A=0:B=2:COLOR 7
8180 FOR I=30 TO 255:A=A+1:IF I>64 AND I<91 THEN COLOR 6 ELSE COLOR 7
8185 '
8190 LOCATE A+4,B:PRINT CHR$(I);:COLOR A1:PRINT "";I
8195 IF A=18 THEN A=0:B=B+6
8200 NEXT I
8400 GOSUB 49000:GOTO 20010
9000 '
9010 COLOR A0,A7:LOCATE 6,30:PRINT CHR$(201)+STRING$(40,"Õ")+CHR$(187)
9020 FOR I=1 TO 8:LOCATE 6+I,30:PRINT CHR$(186)+SPACE$(40)+CHR$(186):NEXT I
9030 LOCATE 14,30:PRINT CHR$(200)+STRING$(40,"Õ")+CHR$(188)
9040 COLOR A4:LOCATE 7,32:PRINT "Le Fichier n'a pas ete ouvert en":LOCATE 8,32:PRINT "lecture [";:COLOR A1:PRINT NOM$;:COLOR A4:PRINT "]"
9045 FOR I=0 TO 4:LOCATE 9+I,31:PRINT SPACE$(36):NEXT I
9050 LOCATE 10,40:PRINT "(R)ecommencer l'appel ":LOCATE 12,40:PRINT "(A)nnuler l'appel "
9052 IF KJ=1 THEN COLOR A0,A7:LOCATE 9,35:PRINT CHR$(218)+STRING$(29,"ƒ")+CHR$(191)
9054 IF KJ=1 THEN LOCATE 10,35:PRINT CHR$(179):LOCATE 10,65:PRINT CHR$(179)
9056 IF KJ=1 THEN LOCATE 11,35:PRINT CHR$(192)+STRING$(29,"ƒ")+CHR$(217)
9060 '
9062 IF KJ=2 THEN COLOR A0,A7:LOCATE 11,35:PRINT CHR$(218)+STRING$(29,"ƒ")+CHR$(191)
9064 IF KJ=2 THEN LOCATE 12,35:PRINT CHR$(179):LOCATE 12,65:PRINT CHR$(179)
9066 IF KJ=2 THEN LOCATE 13,35:PRINT CHR$(192)+STRING$(29,"ƒ")+CHR$(217)
9072 X$=INKEY$:IF X$="" THEN 9072
9080 IF X$="r" OR X$="R" THEN KJ=1
9085 IF X$="A" OR X$="a" THEN KJ=2
9090 IF X$=CHR$(13) AND KJ=2 THEN 20010
9093 IF X$=CHR$(13) AND KJ=1 THEN 1315
9100 GOTO 9040
9200 SOUND 260,1:X=10:Y=10
9202 X2=H:Y2=V:EO=LIG:SYST$="OUI"
9204 B=LEN(WK$(LIG)):FFX=80-B:B=B+FFX:WK$(LIG)=WK$(LIG)+SPACE$(FFX)
9206 B=LEN(WK$(EO)):DJ$=LEFT$(WK$(EO),X2-1):T=B-X2:DK$=RIGHT$(WK$(EO),T):WK$(EO)=DJ$+CHR$(ED1)+DK$
9210 GOTO 20010
9500 IF NOT SYST$="OUI" THEN LOCATE 22,4:PRINT SPACE$(79):LOCATE 22,4:PRINT "Vous n'avez pas debutä le tableau (Debut avec Alt C) ":GOSUB 49000:LOCATE 22,1:PRINT SPACE$(80):GOTO 20010
9510 X4=H:Y4=V:EO4=LIG:X24=H
9520 B=LEN(WK$(EO4)):FFX=80-B:B=B+FFX:WK$(LIG)=WK$(LIG)+SPACE$(FFX)
9530 L$=LEFT$(WK$(EO),X2-1):X4=80-X4
9540 RIG$=RIGHT$(WK$(EO),X4):B=LEN(WK$(EO)):C=80-X4-X2-1
9550 WK$(EO)=L$+CHR$(ED1)+STRING$(C,ED0)+CHR$(ED2)+RIG$   'R$
9560 RIG$=RIGHT$(WK$(EO4),X4):L$=LEFT$(WK$(EO4),X2-1):B=LEN(WK$(EO4)):C=80-X4-X2-1
9570 IF C<0 THEN C=C+1:WK$(EO4)=L$+CHR$(ED4)+STRING$(C,ED10)+CHR$(ED10)+RIG$
9580 IF C>0 THEN WK$(EO4)=L$+CHR$(ED4)+STRING$(C,ED10)+CHR$(ED3)+RIG$
9590 FOR I=EO+1 TO EO4-1:B=LEN(WK$(I)):FFX=80-B:B=B+FFX:WK$(I)=WK$(I)+SPACE$(FFX)
9600 GT$=LEFT$(WK$(I),X2-1):T=B-X2:GK$=RIGHT$(WK$(I),T):WK$(I)=GT$+CHR$(ED6)+GK$:NEXT I
9610 FOR I=EO+1 TO EO4-1:B=LEN(WK$(I)):FFX=80-B:B=B+FFX:WK$(I)=WK$(I)+SPACE$(FFX)
9620 GT$=LEFT$(WK$(I),X24-1):T=B-X24:GK$=RIGHT$(WK$(I),T):WK$(I)=GT$+CHR$(ED7)+GK$:NEXT I
9700 GOTO 20010
10000 COLOR A7,A0:CLS:SCREEN 0,0,0:DIM WK$(800),DIK$(800),VC$(800):H=1:V=19:A$="":LIG=28:RFT=1
10001 COLOR A7,A0:CLS:SCREEN 0,0,0:H=1:V=19:A$="":LIG=28:RFT=1
10002 REM LOCATE 25,1:COLOR A9,A0:PRINT "F1 Echo f2 Goto f3 For f4 If f5 Pause f6 Rem f7 Shift f8 "+CHR$(34)+"%1"+CHR$(34)+" f9 Cls f10 Exist"
10003 FOR I=1 TO 30:WK$(I)=STR$(I):NEXT I
10010 COLOR A8,A0:LOCATE 1,1:FOR I=1 TO 2:PRINT STRING$(80,"€");:NEXT I:SOUND 1600,.2
10020 LOCATE 1,1:COLOR A2,A0:PRINT " Alt ";:COLOR A6,A0:PRINT "/";:COLOR A10,A0:PRINT " Esc ";:GOSUB 10022:GOTO 10040
10022 COLOR A14,A0:PRINT " W";:COLOR A12,A0:PRINT "rite  ";
10024 COLOR A14,A0:PRINT " F";:COLOR A12,A0:PRINT "ichier ";
10026 COLOR A14,A0:PRINT " T";:COLOR A12,A0:PRINT "exte ";
10030 COLOR A14,A0:PRINT " C";:COLOR A12,A0:PRINT "-Ascii ";
10032 COLOR A14,A0:PRINT " E";:COLOR A12,A0:PRINT "xecut ";
10034 COLOR A14,A0:PRINT " I";:COLOR A12,A0:PRINT "mprime ";
10036 COLOR A14,A0:PRINT " C";:COLOR A12,A0:PRINT "opier ";:RETURN
10040 COLOR A4,A0:PRINT " Alt ";:COLOR A11,A0:PRINT "Q";:COLOR A7,A0:PRINT CHR$(26)+" fin"
10041 '
10042 '
10043 COLOR A14,A0
10044 IF ONF$="" THEN ONF$="OFF"
10046 LOCATE 2,70:PRINT "Pos ";:COLOR A9,A0:PRINT ONF$:COLOR A8,A0:LOCATE 2,1:PRINT "Modif"
10050 GOSUB 10060:GOTO 10100
10060 COLOR A11,A0:LOCATE 2,14:PRINT " Line ";LIG
10061 LOCATE 2,27:PRINT " Col ";H
10066 RETURN
10100 LOCATE 3,1:COLOR A9,A0:PRINT STRING$(80,254):IF TYN$="ON" THEN TYN$="":NOM$=HO2$:GOTO 1321
10110 GOSUB 10060:IF OF$="ON" THEN GOSUB 20015
10120 LOCATE V+3,H,1,0,7
10130 '
10200 X$=INKEY$:IF X$="" THEN 10120
10201 '
10204 '
10205 GOSUB 10060:IF AZ$="ON" THEN COLOR A7:LOCATE 23,1:PRINT SPACE$(40):LOCATE 23,1:PRINT NOM$:COLOR A11
10210 IF ASC(RIGHT$(X$,1))=75 OR X$="4" THEN H=H-1:IF H=0 THEN H=1 : GOTO 10120 ELSE 10110
10220 IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN V=V-1:LIG=LIG-1:IF V=0 THEN V=1:IF LIG=0 THEN LIG=1
10221 IF ASC(RIGHT$(X$,1))=72 OR X$="8" THEN 20000
10230 IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN V=V+1:LIG=LIG+1:IF V=20 THEN V=19:IF LIG=801 THEN LIG=800:BEEP
10231 IF ASC(RIGHT$(X$,1))=80 OR X$="2" THEN 20000
10234 IF X$="7" THEN V=1:LIG=1:GOTO 20010
10240 IF ASC(RIGHT$(X$,1))=77 OR X$="6" THEN H=H+1:IF H=80 THEN H=79:GOTO 10110
10242 IF ASC(RIGHT$(X$,1))=81 AND NOT LIG>770 AND V<18 THEN LIG=LIG+18:GOTO 20010
10243 IF X$="*" THEN RTF=1:BEEP:LOCATE 23,1:COLOR A8,A7:PRINT "Ligne de Depart ";RFT;" est annulez ":SOUND 400,1:SOUND 500,1:SOUND 6600,1:
10244 IF X$=CHR$(0)+CHR$(16) THEN 8000
10245 IF X$="N" THEN AZ$="ON" ELSE AZ$="OFF"
10246 IF LIG>22 AND ASC(RIGHT$(X$,1))=73 OR X$="A" OR X$="a" OR X$="9" AND LIG>22 AND NOT LIG<22 THEN 20110
LIG=LIG-18:GOTO 20010
10247 IF X$=CHR$(7) THEN RTF=LIG:BEEP:LOCATE 23,1:COLOR A8,A7:PRINT "Ligne de Depart ";RFT:SOUND 400,1:SOUND 500,1:SOUND 6600,1
10248 IF X$=CHR$(13) THEN CC$="":GOTO 30000
10249 IF X$=CHR$(27) THEN 500
10250 IF X$=CHR$(1) AND OF$="ON" THEN FOR I=1 TO 800:WK$(I)=DIK$(I):NEXT I:OF$="OFF":LOCATE 23,1:PRINT SPACE$(78):GOTO 20010
10252 IF X$=CHR$(2) AND OF$="ON" THEN COLOR A8,A7:LOCATE 3+V,1:PRINT WK$(LIG):GOTO 1660
10255 IF X$=CHR$(0)+CHR$(23) THEN COLOR A10,A0:LOCATE 4,4:PRINT "** Patientez Ins **":DIM KL$(802):FOR Z=LIG TO 800:KL$(Z)=WK$(Z):NEXT Z:WK$(LIG+1)=SPACE$(70):FOR I=LIG+1 TO 799:WK$(I+1)=KL$(I):NEXT I:ERASE KL$:GOTO 20010
10260 IF X$=CHR$(0)+CHR$(32) THEN COLOR A10,A0:LOCATE 4,4:PRINT "** Patientez Del **":DIM KL$(802):FOR Z=LIG TO 800:KL$(Z)=WK$(Z):NEXT Z:FOR I=LIG TO 799:WK$(I)=KL$(I+1):NEXT I:ERASE KL$:GOTO 20010                				
10270 IF X$=CHR$(0)+CHR$(46) THEN 9200
10280 IF X$=CHR$(0)+CHR$(37) AND SYST$="OUI" THEN 9500
10284 IF X$=CHR$(127) THEN RUN
10298 IF X$=CHR$(14) THEN LPRINT CHR$(7):LPRINT "** THOLL - TSAKI **":LPRINT "Nom --> ";NOM$:LPRINT "Date -> ";DATE$;" : Time -> ";TIME$
10299 GOSUB 10060
10300 GOTO 10120
17000 LOCATE 4,3:COLOR A12,A3:PRINT CHR$(219)+STRING$(72,"ﬂ")+CHR$(219):KL=1
17010 FOR I=1 TO 10:LOCATE 4+I,3:PRINT CHR$(221)+SPACE$(72)+CHR$(222):NEXT I
17020 LOCATE 4+I,3:PRINT CHR$(219)+STRING$(72,"‹")+CHR$(219)
17030 LOCATE 5,6:COLOR A0:PRINT "Remplacer un mot par un autre ":LOCATE 6,9:COLOR A4:PRINT STRING$(29,"-")
17040 COLOR A0:LOCATE 8,11:PRINT "<O>  Mot a changer   <   >  Avec confirmation ":LOCATE 10,11:PRINT "<   > ******************  <   >  ****************      "
17050 X$=INKEY$:IF X$="" THEN 17050
17060 IF ASC(RIGHT$(X$,1))=75 THEN KL=KL-1:IF KL=0 THEN KL=4
17070 IF ASC(RIGHT$(X$,1))=77 THEN KL=KL+1:IF KL=5 THEN KL=1
17075 COLOR A0,A3:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17076 COLOR A0,A3:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">"
17077 COLOR A0,A3:LOCATE 10,11:PRINT "<":LOCATE 10,15:PRINT ">"
17078 COLOR A0,A3:LOCATE 10,37:PRINT "<":LOCATE 10,41:PRINT ">"
17080 IF KL=1 THEN COLOR A14:LOCATE 8,11:PRINT "<":LOCATE 8,13:PRINT ">"
17090 IF KL=2 THEN COLOR A14:LOCATE 8,32:PRINT "<":LOCATE 8,36:PRINT ">"
17100 IF KL=3 THEN COLOR A14:LOCATE 10,11:PRINT "<":LOCATE 10,15:PRINT ">"
17110 IF KL=4 THEN COLOR A14:LOCATE 10,37:PRINT "<":LOCATE 10,41:PRINT ">"
17199 COLOR A8,A11
17200 IF X$=CHR$(13) AND KL=1 THEN 17500
17210 IF X$=CHR$(13) AND KL=2 THEN IF ACV$="" OR ACV$="NON" THEN ACV$="OUI":LOCATE 8,33:PRINT ACV$ ELSE ACV$="NON":LOCATE 8,33:PRINT ACV$
17220 IF X$=CHR$(13) AND KL=3 THEN IF BCV$="" OR BCV$="NON" THEN BCV$="OUI":LOCATE 10 ,12:PRINT BCV$ ELSE BCV$="NON":LOCATE 10,12:PRINT BCV$
17300 IF X$=CHR$(27) THEN 20010
17400 GOTO 17050
17500 COLOR A1,A0:LOCATE 11,15:PRINT CHR$(219)+STRING$(40,223)+CHR$(219):LOCATE 12,15:PRINT CHR$(221)+SPACE$(40)+CHR$(222):LOCATE 13,15:PRINT CHR$(219)+STRING$(40,220)+CHR$(219)
17550 COLOR A6,A0:LOCATE 12,17:INPUT "Entrer le Mot --->",MOT$:IF MOT$="" THEN COLOR A3,A3:FOR I=0 TO 2:LOCATE 11+I,14:PRINT SPACE$(43):NEXT I:COLOR A0,A3:GOTO 17050
17560 LOCATE 12,16:PRINT SPACE$(40):LOCATE 12,17:INPUT " Par --> ",AAA$
17565 FOR I=1 TO 19:LOCATE 3+I,1:PRINT SPACE$(80):NEXT I
17570 COLOR A12,A0:LOCATE 5,1:PRINT STRING$(80,"˜"):COLOR A14,A0:LOCATE 4,2:PRINT " le Mot ";:COLOR A3:PRINT MOT$;:COLOR A14:PRINT " devient ";:COLOR A9,A0:PRINT AAA$
17580 COLOR A4,A0:LOCATE 21,1:PRINT STRING$(80,"˜"):COLOR A3:THO=0
17590 K1=LEN(WK$(THO)):K2=LEN(MOT$)
17600 FOR I=1 TO K1
17610 A$=LEFT$(WK$(THO),I):B$=RIGHT$(A$,K2)
17620 IF B$=MOT$ THEN GOSUB 18000
17630 NEXT I:COLOR A11,A0:LOCATE 2,14:PRINT " line ";THO
17640 THO=THO+1:IF THO=LIG THEN COLOR 7,0:LOCATE 22,1:PRINT SPACE$(80):LOCATE 22,1:COLOR A9,A11:PRINT "La recherche et le remplacement sont terminäs":GOSUB 49000:GOTO 20010
17650 GOTO 17590
17999 GOSUB 49000:END
18000 ZE=ZE+1:IF ZE=15 THEN ZE=1
18010 BCBG=LEN(MOT$):IF BCBG=1 THEN CCCC=0 ELSE CCCC=1
18017 MGTS=LEN(MOT$):IF MGTS=1 THEN W1=0:W2=0
18018 IF NOT MGTS=1 THEN W1=1:W2=1
18020 TY=LEN(WK$(THO)):YKY=I-K2-CCCC:IF YKY>=1 THEN TP$=LEFT$(A$,YKY+W1):SP=TY-(A2+I)+2:TM$=RIGHT$(WK$(THO),SP) ' +1 A Enlever COL 70
18023 IF I=K2 THEN TP$=LEFT$(A$,0):SP=TY-K2:TM$=RIGHT$(WK$(THO),SP)
18025 LOCATE ZE+6,1:PRINT SPACE$(80)
18030 LOCATE ZE+6,1:COLOR A7,A0:PRINT TP$;:COLOR A9,A3:PRINT MOT$;:COLOR A7,A0:PRINT TM$
18100 IF ACV$="OUI" THEN LOCATE 4,46:PRINT SPACE$(30):LOCATE 4,46::COLOR A14,A0:PRINT "*** ";:COLOR A7:PRINT "A remplacer ";:COLOR A11:PRINT "O";:COLOR A12:PRINT "/";:COLOR  A9:PRINT "N";:COLOR A14:PRINT " ***":GOTO 18400
18110 IF ACV$="NON" THEN WK$(THO)=TP$+AAA$+TM$:RETURN
18200 END
18400 X$=INKEY$:IF X$="" THEN 18400
18410 IF X$="o" OR X$="O" THEN WK$(THO)=TP$+AAA$+TM$:RETURN
18415 IF X$="n" OR X$="N" THEN LOCATE 4,46:PRINT SPACE$(30):RETURN
18417 IF X$=CHR$(27) THEN 20010
18420 SOUND 1600,.1:GOTO 18400
20000 '
20001 IF V=1 THEN FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(1):LOCATE 4+I,1,0:PRINT  WK$(LIG+I):NEXT I
20002 IF V=19 THEN FOR I=0 TO 18:LOCATE 22-I,1,0:PRINT SPACE$(1):LOCATE 22-I,1,0:PRINT WK$(LIG-I):NEXT I
20004 GOTO 10110
20010 A=0:PRINT LIG,V,A:COLOR A11,A0:A=LIG:FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(1):LOCATE 4+I,1,0:
'PRINT WK$(A+I-1):
NEXT I:GOTO 10110
20015 A=0:COLOR A11,A0:A=LIG-V:FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT WK$(A+I+1):NEXT I:LOCATE V+3,1:COLOR A8,A14:PRINT WK$(LIG):RETURN
20035 COLOR A9,A0:FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(80):NEXT I:LOCATE 4,1:RETURN
20100 FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(80):LOCATE 4+I,1,0:PRINT WK$(LIG+I):NEXT I:LIG=LIG+V:GOSUB 10060:GOTO 10110
20110 BEEP:FOR I=0 TO 18:LOCATE 22-I,1,0:PRINT SPACE$(80):LOCATE 22-I,1,0:PRINT WK$(LIG-I):NEXT I:LIG=LIG-V:V=1:GOSUB 10060:GOTO 10110
20120 FOR I=0 TO 18:LOCATE 4+I,1,0:PRINT SPACE$(80):LOCATE 4+I,1,0:PRINT WK$(LIG+I):NEXT I:LIG=LIG+V-1:GOSUB 10060:GOTO 10110
30000 CC$=WK$(LIG):COLOR A9,A0:LOCATE V+3,1,1,5,7:PRINT CC$:B=LEN(CC$):COLOR A9,A11:LOCATE 2,40:PRINT "Long ";B:COLOR A12,A4:LOCATE 2,1:PRINT "Modif":H2=H
30100 X$=INKEY$:IF X$="" THEN 30100
30101 COLOR A7,A0:B=LEN(CC$):COLOR A9,A11:LOCATE 2,40:PRINT "Long ";B
30102 SOUND 100,.01:AR$=LEFT$(CC$,H2+1):R$=RIGHT$(AR$,1)
30105 IF X$=CHR$(13) AND V<19 AND LIG<799 THEN COLOR A11,A0:WK$(LIG)=CC$:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT WK$(LIG):LIG=LIG+1:V=V+1:X$=CHR$(27):GOTO 30150
30110 IF X$=CHR$(13) AND V=19 AND LIG<799 THEN WK$(LIG)=CC$:LIG=LIG+1:GOSUB 50000:GOTO 20010
30111 IF X$=CHR$(9) THEN CC$="  "+CC$:GOTO 30100
30120 IF ASC(LEFT$(X$,1))=0 AND ASC(RIGHT$(X$,1))=77 AND H2<B AND H2<80 THEN AR$=LEFT$(CC$,H2+1):R$=RIGHT$(AR$,1):H2=H2+1:COLOR A9,A0:LOCATE V+3,1:PRINT CC$:LOCATE V+3,H2:COLOR A16,A7 :PRINT R$:GOTO 30100
30140 IF ASC(LEFT$(X$,1))=0 AND ASC(RIGHT$(X$,1))=75 AND H2>1 THEN AR$=LEFT$(CC$,H2-1):R$=RIGHT$(AR$,1):H2=H2-1:COLOR A9,A0:LOCATE V+3,1:PRINT CC$:LOCATE V+3,H2:COLOR A16,A7 :PRINT R$:GOTO 30100
30141 IF ASC(LEFT$(X$,1))=0 AND ASC(RIGHT$(X$,1))=71 THEN H2=1:GOTO 30100
30142 IF ASC(LEFT$(X$,1))=0 AND ASC(RIGHT$(X$,1))=83 AND H2<B THEN BB=LEN(CC$):A1=BB-H2-1:A1$=LEFT$(CC$,H2):A2$=RIGHT$(CC$,BB-H2):AE=LEN(A2$):A2$=RIGHT$(A2$,AE-1):CC$=A1$+A2$:GOSUB 50100:GOTO 30100
30144 IF ASC(LEFT$(X$,1))=0 AND ASC(RIGHT$(X$,1))=82 THEN BB=LEN(CC$):A1=BB-H2-1:A1$=LEFT$(CC$,H2):A2$=RIGHT$(CC$,BB-H2):AE=LEN(A2$):A2$=" "+A2$:CC$=A1$+A2$
30145 IF H2=0 THEN 30100
30150 IF X$=CHR$(27) THEN COLOR A11,A0:LOCATE V+3,1,1,0,7:PRINT WK$(LIG):LOCATE 2,1:COLOR A8,A0:PRINT "Modif":LOCATE 2,40:PRINT STRING$(9,219):COLOR A11,A0:GOTO 10120
30151 BG=LEN(CC$):IF BG<=H2 THEN CC$=CC$+SPACE$(H2-BG)
30152 IF NOT H2<79 THEN SOUND 1600,1:GOTO 30100
30153 MID$(CC$,H2,1)=X$  :  H2=H2+1:GOSUB 50100
30155 BB=LEN(CC$):IF H2>=BB THEN CC$=CC$+" "
30190 LOCATE V+3,H2:COLOR A16,A7:PRINT R$
30205 BB=LEN(CC$):IF H2>=BB THEN CC$=CC$+" "
31199 GOTO 30100
40000 ON ERROR GOTO 48000
40010 COLOR 3:PRINT "Pararmetres THOLL"
40015 PAR$=COMMAND$:CLOSE
40020 B=LEN(PAR$)
40030 A$=LEFT$(PAR$,2)
40050 IF A$="/P" OR A$="/p" THEN PRINT:PRINT "les differents Parametres":PRINT "/W Copie un fichier texte Pas a Pas  , de  Disk a disk "
40053 IF A$="/p" OR A$="/P" THEN PRINT "/M Copie un fichier texte en entier dans la memoire puis de la memoire sur disk"
40055 IF A$="/P" OR A$="/p" THEN PRINT "/P Affiche ces Parametres   /C  FICHIER.EXT ":PRINT "Fichier de configuration THCONFIG. ,  Couleur COULEUR.THL"
40060 IF A$="/P" OR A$="/p" THEN PRINT "/T FICHIER.EXT   , Charge un fichier dans la matrice de travail de THOLL"
40065 IF A$="/T" OR A$="/t" OR A$="T/" OR X$="t/" THEN NOM$=RIGHT$(PAR$,B-3):TYN$="ON":HO2$=NOM$:   ON ERROR GOTO 0   :  ON ERROR GOTO 60000  :  GOTO 10000
40070 IF A$="/W" OR A$="/w" THEN PRINT:PRINT " Fichier a copier ":GOSUB 49000:GOTO 43000
40080 IF A$="/M" OR A$="/m" THEN PRINT:PRINT " Copie Rapide d'un Fichier ":GOSUB 49000:GOTO 41100
41000 PRINT :PRINT:PRINT "Parametre(s) non Conforme aux Normes de l'execution ( /P )"
41010 PRINT:PRINT "S‰RG‰ TSAKI  THOLL ver 1.00 (c) 1991":GOSUB 49000:END
41100 DIM CM$(1000):PRINT "Tholl ne peut pas Copier un fichier de plus de 1000 lignes ":COLOR 3:PRINT
41110 INPUT "Fichier Source -> ",C$:IF C$="" THEN END
41120 INPUT "Fichier Object -> ",O$:IF O$="" THEN O$=C$
41125 COLOR 14:PRINT STRING$(80,"-"):COLOR 12
41130 PRINT :PRINT "Tapez sur une touche .....":GOSUB 49000
41140 OPEN C$ FOR INPUT AS #1
41155 FOR I=1 TO 2000:LINE INPUT #1,CM$(I):NEXT I
41157 SOUND 1600,1:PRINT "inserer diskette pour l'enregistrement de ";O$
41159 GOSUB 49000
41160 OPEN O$ FOR OUTPUT AS #2
41165 FOR T=1 TO I:PRINT #2,CM$(T):NEXT T
41170 COLOR 12:PRINT "Fin de la COPIE RAPIDE ":END
43000 CLS
43005 INPUT "Fichier [1]  -   SOURCE  - > ",F1$
43010 INPUT "Fichier [2]  -   OBJECT  - > ",F2$
43030 PRINT:PRINT " Tapez sur une Touche pour la copie <Esc> pour retour au DOS"
43040 X$=INKEY$:IF X$="" THEN 43040
43050 IF X$=CHR$(27) THEN PRINT:PRINT:END
43060 OPEN F1$ FOR INPUT AS #1:X=LOF(1):AZ=15
43070 OPEN F2$ FOR OUTPUT AS #2:L=0:NB=0
43080 PRINT "Nbr d'Octet(s) ";X:
43085 LINE INPUT #1,A$:PRINT #2,A$:L=L+1:NB=LEN(A$)
43090 LOCATE 10,4:PRINT " Nbr de Ligne ";L:LOCATE 11,4:PRINT " Nbr de Caractere(s) ";NB
43095 LOCATE 15,1:PRINT " COPIER ";N$:IF AZ=L THEN N$=N$+".":AZ=AZ+15
43100 GOTO 43085
48000 GOSUB 65020:SOUND 100,3:COLOR 3,1:LOCATE 20,3:PRINT "Formation de l'erreur au cours du travail ";ERL;"   ERR->  ";ERR
48005 IF ERL=-24381 THEN RESUME 41157
48010 GOSUB 65020:IF R$="" THEN R$="ERREUR NON DEFINIE / ou fin du travaille en cour          "
48020 COLOR 12,4:LOCATE 20,1:PRINT "LOCALISATION DE L'ERREUR ":LOCATE 20,1:COLOR 11,1:PRINT R$:GOSUB 49000:END
49000 IF INKEY$="" THEN 49000 ELSE SOUND 1600,.1:RETURN
49999 GOSUB 65000:END
50000 COLOR A11,A0:LOCATE V+3,1,1,0,7:PRINT WK$(LIG):LOCATE 2,1:COLOR A8,A0:PRINT "Modif":LOCATE 2,40:PRINT STRING$(9,219):COLOR A11,A0:RETURN
50100 COLOR A9,A0:LOCATE V+3,1:PRINT SPACE$(80):LOCATE V+3,1:PRINT CC$:RETURN
60000 CLOSE : COLOR A15,A4:LOCATE 22,4:IF ERL=35 THEN GOSUB 40:RESUME 45
60001 IF ERL=45 THEN XX=8:YY=9:RESUME 50
60002 IF ERL=10000 THEN RESUME 10001
60003 IF ERL=1200 THEN LOCATE 22,1:PRINT "Le fichier n'a pas ete ouvert ":GOSUB 65000:RESUME 10120
60005 IF ERL=1330 THEN RESUME 9010
60010 IF ERL=1345 THEN PRINT "Fin du fichier / OU / ERREUR ":GOSUB 65000:RESUME 20010
60011 IF ERL=10298 THEN BEEP:RESUME 10299
60015 IF ERL=1430 THEN COLOR A8,A7:LOCATE 22,4:PRINT "Fichier de Fusion ";NOM$;" n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
60016 IF ERL=7100 THEN PRINT "Le fichier SOURCE ";FS$;" n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
60017 IF ERL=7110 THEN PRINT "Le fichier OBJECT ";FO$;" n'a pas ete ouvert ":GOSUB 65000:RESUME 20010
60018 IF ERL=7120 AND NOT ERR=62 THEN PRINT "Impossible de lire le fichier SOURCE ";FS$:GOSUB 65000:RESUME 20010
60019 IF ERL=7130 THEN PRINT "Impossible d'ecrire le fichier OBJECT ";FO$:GOSUB 65000:RESUME 20010
60020 IF ERL=1445 THEN COLOR A8,A7:PRINT "Fin du fichier de Fusion / OU / ERREUR ":GOSUB 65000:RESUME 20010
60021 IF ERL=7120 AND ERR=62 THEN PRINT "La Copie est Terminäe ":GOSUB 65000:RESUME 20010
60022 IF ERL=1620 THEN COLOR A15,A6:PRINT "Impossible de lire le fichier DISK.THL":GOSUB 65000:RESUME 20010
60023 IF ERL=-25496 THEN PRINT "ERREUR DE PARAMETRAGE sur  /C...":END
60024 IF ERL=5110 THEN PRINT "ERREUR Dans   Save *.BAK   ":RESUME 5120
60025 IF ERL=5120 THEN LOCATE 22,4:PRINT "ERREUR Dans    Save  *.BAT":RESUME 5140
60026 IF ERL=5140 THEN LOCATE 22,4:PRINT "ERREUR SYSTEM                    ";ERL;"  ";ERR:GOSUB 65000:GOTO 20010
60030 IF ERL=1630 THEN RESUME 1640
60031 IF ERL=42105 THEN PRINT "Fichier Introuvable ";NO$:CLOSE:END
60035 IF ERL=1065 THEN LOCATE 22,4:COLOR A8,A7:PRINT "FICHIER DISKTHL.BAT n'a pas ete creer <Esc> Aide ":GOSUB 65000:FOR I=1 TO 400:WK$(I)=DIK$(I):NEXT I:RESUME 20010
60037 IF ERL=1067 THEN PRINT "IMPOSSIBLE d'executer SHELL ou COMMAND.COM Non Trouvez <Esc> aide ":GOSUB 65000:GOTO 20010
60040 IF ERL=42110 THEN PRINT "Impossible d'ecrire le fichier ";N2$
60041 IF ERL=43060 OR ERL=43070 OR ERL=43085 THEN COLOR A11,A1:PRINT "Erreur Survenue pendant la copie ....    	       [Esc]":GOSUB 65000:END
60045 IF ERL=18020 THEN PRINT "IMPOSSIBLE ERREUR 18020":GOSUB 65000 :RESUME 20010
60051 IF ERL=1530 THEN COLOR A15,A4:LOCATE 22,4:PRINT "Vous n'avez pas selectionnee de Lecteur ou ERREUR":GOSUB 65000:RESUME 10000
60052 IF ERL=880 THEN PRINT "Le fichier n'a pas ete trouver pour l'impression ":GOSUB 65000:GOTO 20010
60053 IF ERL=890 THEN PRINT "Vous avez entrer un chiffre trop grand dans DEBUT/FIN / Fin de fichier ":GOSUB 65000:RESUME 20010
60054 IF ERL>65165 AND ERL<65100 THEN COLOR A15,A4:LOCATE 22,5:PRINT "Erreur survenue pendant la recherche":GOSUB 65000:RESUME 10000
60055 IF ERL=910 THEN PRINT "Le fichier est finie / ou Erreur ":GOSUB 65000:RESUME 20010
60057 IF ERL=920 THEN PRINT "**** ERREUR sur L'IMPRIMANTE ***** ":BEEP:GOSUB 65000:RESUME 20010
60060 IF ERL=-376 THEN LOCATE 4,4:PRINT "ERREUR Interne":PRINT ERL:RESUME 10000
60080 LOCATE 2,2:PRINT "ERREURE EXTERNE ";ERL;"   ERR ";ERR
61060 GOSUB 40:COLOR A11,A0:B1=3
61070 LOCATE 5,20:PRINT CHR$(219)+STRING$(40,223)+CHR$(219):FOR I=1 TO B1:LOCATE 5+I,20:PRINT CHR$(221)+SPACE$(40)+CHR$(222)+"  ":NEXT I:LOCATE 5+I,20:PRINT CHR$(219)+STRING$(40,220)+CHR$(219)+"  ":LOCATE I+5+1,24:PRINT SPACE$(40)
61080 COLOR A10:LOCATE 7,25:PRINT "THOLL ver 1.00 [ 2em gänäration ]":PRINT "LIG ";LIG:GOSUB 65020:GOSUB 49000
61095 END
65000 X$=INKEY$:IF X$="" THEN 65000
65010 IF X$=CHR$(27) THEN 65020
65011 RETURN
65020 R$="":IF ERR=61 THEN R$="DISKETTE PLEIN , PLUS DE PLACE"
65022 IF ERR=70 THEN R$="Impossible d'ecrire sur le disque qui est protegee en ecriture"
65024 IF ERR=25 THEN R$="Erreur sur unitä , Un peripherique ämet un signal d'erreur"
65026 IF ERR=27 THEN R$="Pas de papier dans l'imprimante ou imprimante hors tension"
65028 IF ERR=53 THEN R$="Un fichier est introuvable sur dique ou diskette"
65030 IF ERR=57 THEN R$="Erreur provenant du materiel au moment d'une commande sur unite"
65032 IF ERR=64 THEN R$="Utilisation d'un caracteres errones dans l'ecriture d'un nom"
65034 IF ERR=62 THEN R$="Donnee epuiser dans le fichier lu ,EOF, Le fichier est finie "
65036 IF ERR=68 THEN R$="Unitä non disponible"
65040 IF ERR=71 THEN R$="Peripherique non pret ou diskette protegee"
65042 IF ERR=72 THEN R$="Erreur sur la diskette ou le disque dur"
65044 IF ERR=75 THEN R$="Erreur lors de l'acces a un fichier avec OPEN"
65048 IF ERR=7 THEN R$="MANQUE DE PLACE MEMOIRE COMMANDE IMPOSSIBLE"
65099 COLOR A14,A0:LOCATE 22,1:PRINT R$:GOSUB 49000:RETURN
65100 I=-1
65110 K=LEN(MOT$):I=I+1:PP=LEN(WK$(I)):IF I=LIG THEN 20010
65115 PP=LEN(WK$(I)):FOR P=1 TO PP
65120 FF$=LEFT$(WK$(I),P):FF2$=RIGHT$(FF$,K)
65123 IO=I:PO=P
65125 IF FF2$=MOT$ THEN 65150
65130 NEXT P
65135 X$=INKEY$:IF X$="" THEN 65110
65140 IF X$=CHR$(27) THEN GOSUB 65000:GOTO 20010
65145 GOTO 65110
65150 A=A+1:B=LEN(WK$(I)):GF=LEN(FF$):GF=GF-K
65155 PIP$=LEFT$(WK$(I),GF):SP=B-K-GF:MARGO$=RIGHT$(WK$(I),SP)
65160 LOCATE 5+A,1:COLOR A7,A0:PRINT PIP$;:COLOR A8,A9:PRINT MOT$;:COLOR A7,A0:PRINT MARGO$:SOUND 1600,.1:I=IO:P=PO:FF2$=""
65163 IF A=15 THEN A=1:GOSUB 49000:FOR FI=1 TO 15:LOCATE 5+FI,1:PRINT SPACE$(80):NEXT FI
65165 GOTO 65125
