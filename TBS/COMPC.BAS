6680 A=6:B=5:X1=50:X3=14:GOSUB 6000
COLOR A12,A4:LOCATE 6,10:PRINT " Compr‚ssion et D‚compr‚ssion "
COLOR A0,A3
LOCATE 13,11:PRINT "  ÚÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÂÄÄÄÄÄ¿"
LOCATE 15,11:PRINT "  ÀÄÄÄÄÁÄÄÄÄÁÄÄÄÄÁÄÄÄÄÁÄÄÄÄÁÄÄÄÄÄÙ"
COLOR A4,A3
LOCATE 16,11:PRINT "  0%    25%     50%     75%    100%"
COLOR A0,A3:MA=0
FOR U=DDBK TO FDBK:MA=MA+LEN(WK$(U,PG)):NEXT U
COLOR 0,3:LOCATE 7,8:PRINT "Taille Texte     > ";:COLOR 3,0:PRINT USING " ##.### ko ";MA/1024
N=0:FOR I=DDBK TO FDBK:M=LEN(WK$(I,PG))
IF M=0 THEN 6800
FOR T=1 TO 50

$INCLUDE "COMPACT.BAS"

IF COMPRES$="OUI" THEN IF INSTR(WK$(I,PG),b$)=0 THEN 6799
IF NOT COMPRES$="OUI" THEN IF INSTR(WK$(I,PG),C$)=0 THEN 6799
LN=LEN (WK$(I,PG))
LNB=LEN(B$):LNC=LEN(C$)
IF COMPRES$="OUI" THEN FOR U=DDBK TO FDBK:N=N+LEN(WK$(U,PG)):NEXT U
IF COMPRES$="OUI" THEN COLOR 0,3:LOCATE 8,8:PRINT "Taille actuelle  > ";:COLOR 3,0:PRINT USING " ##.### ko ";((N)/1024)
IF COMPRES$="OUI" THEN COLOR 0,3:LOCATE 9,8:PRINT "Gain actuelle    > ";:COLOR 3,0:PRINT USING " ##.### ko ";(((MA-N))/1024):N=0
6720 LN=LEN(WK$(I,PG))
FOR MARGO=1 TO LN:DEBUT$=LEFT$(WK$(I,PG),MARGO)
IF COMPRES$="OUI" THEN MOT$=RIGHT$(DEBUT$,LNB)
IF COMPRES$="OUI" THEN IF MOT$=B$ THEN Y1$=LEFT$(DEBUT$,MARGO-LNB)+C$+RIGHT$(WK$(I,PG),LN-MARGO):WK$(I,PG)=Y1$:GOTO 6720
IF COMPRES$="NON" THEN MOT$=RIGHT$(DEBUT$,LNC)
IF COMPRES$="NON" THEN IF MOT$=C$ THEN X1$=LEFT$(DEBUT$,MARGO-LNC)+B$+RIGHT$(WK$(I,PG),LN-MARGO):WK$(I,PG)=X1$:GOTO 6720
NEXT MARGO
6799 COLOR 0,3:LOCATE 11,8:PRINT "Ligne en Cour  > ";:COLOR 12,3:PRINT " ";I;" "

TTT=INT(((T*30)/100)*2)
T$=STRING$(TTT,"Û"):COLOR 0,3:LOCATE 14,8:PRINT " ÀÄ> ³";:COLOR 4,0:PRINT T$
NEXT T
COLOR 0,3:LOCATE 14,8:PRINT " % > ³                                "

6800 NEXT I
GOTO 20010
